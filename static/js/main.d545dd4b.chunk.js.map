{"version":3,"sources":["muse/MuseConfig.ts","muse/Border.tsx","muse/Fraction.ts","muse/Selector.ts","muse/MuseNote.tsx","muse/MuseBar.tsx","muse/MuseTrack.tsx","muse/MuseLine.tsx","muse/MusePage.tsx","muse/MuseNotation.tsx","muse/Muse.tsx","App.tsx","serviceWorker.ts","index.tsx"],"names":["MuseConfig","noteHeight","noteWidth","noteFontSize","noteFontFamily","sigFontSize","trackGap","lineGap","pointGap","tailPointGap","pointRound","pageE","pageWidth","pageMarginHorizontal","pageMarginVertical","infoTitleFontSize","infoSubtitleFontSize","infoGap","infoFontSize","pageIndexFontSize","textFontFamily","showBorder","Border","w","h","x","y","clazz","show","color","className","transform","width","height","stroke","strokeWidth","fill","OuterBorder","Fraction","u","d","pos","search","this","parseInt","substr","a","b","t","n","gcd","f","r","simplify","Selector","subnote","note","document","addEventListener","ev","console","log","key","setNum","reducePoint","reduceLine","reduceTailPoint","setSelect","removeSubNote","getIndex","addSubNote","s","instance","SubNote","index","config","selection","isSelect","l","p","observable","Note","o","bar","idx","subNotes","push","length","selectSubNote","filter","it","decode","dxx","forEach","Math","pow","ny","i","py","mb","notesY","dx","notesMaxHeight","notesX","notesMaxMarginBottom","undefined","ns","ts","split","charCodeAt","charAt","tg","computed","MuseSubNote","observer","props","onClick","subNote","fontFamily","fontSize","S","F","DS","DF","N","React","Component","MuseNote","selectNote","marginBottom","map","pointsY","pointGroup","tailPointsX","tailPoint","Bar","track","barsWidth","notes","barsX","time","notesTime","reduce","plus","init","space","notesWidthSum","unit","divide","notesTimeSum","toNumber","notesWidth","multiply","max","preHeight","preMarginBottom","e","code","BarLine","useObserver","x1","y1","x2","y2","BaseLine","baselineGroup","MuseBar","Track","line","bars","tracksY","timeSum","barsTime","barsNotesWidth","preNotesMaxHeight","preNotesMaxMarginBottom","MuseTrack","Line","page","tracks","linesY","LineHead","MuseLine","Page","notation","marginTop","mt","g","info","author","lines","sum","linesHeight","gap","PageIndex","textAnchor","toString","MusePage","marginLeft","marginRight","NotationInfo","Notation","pages","title","subtitle","speed","rhythmic","C","MuseNotationInfo","y3","rythimic","MuseNotation","margin","Muse","JSON","parse","data","App","state","error","isLoaded","fetch","then","res","text","result","setState","Boolean","window","location","hostname","match","ReactDOM","render","StrictMode","getElementById","navigator","serviceWorker","ready","registration","unregister","catch","message"],"mappings":"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","file":"static/js/main.d545dd4b.chunk.js","sourcesContent":["export default class MuseConfig {\n  noteHeight = 22;\n  noteWidth = 11;\n  noteFontSize = 22;\n  noteFontFamily = \"serif\";\n  sigFontSize = 14;\n\n  trackGap = 10;\n\n  lineGap = 40;\n\n  pointGap = 5;\n  tailPointGap = 8;\n  pointRound = 1.5;\n\n  pageE = 1.414;\n  pageWidth = 1000;\n  pageMarginHorizontal = 100;\n  pageMarginVertical = 110;\n\n  infoTitleFontSize = 34;\n  infoSubtitleFontSize = 22;\n  infoGap = 7;\n  infoFontSize = 20;\n\n  pageIndexFontSize = 20;\n\n  textFontFamily = \"serif\";\n\n  showBorder = false;\n}\n","import React from \"react\";\n\ninterface BorderProps {\n  w: number;\n  h: number;\n  x: number;\n  y: number;\n  clazz: string;\n  show?: boolean;\n  color?: string;\n}\n\nexport const Border: React.FC<BorderProps> = ({\n  w,\n  h,\n  x,\n  y,\n  clazz,\n  show = false,\n  color = \"blue\",\n}: BorderProps) => {\n  if (show) {\n    return (\n      <rect\n        className={clazz + \"__border\"}\n        transform={\"translate(\" + x + \",\" + y + \")\"}\n        width={w}\n        height={h}\n        stroke={color}\n        strokeWidth=\"0.4\"\n        fill=\"none\"\n      />\n    );\n  } else {\n    return <></>;\n  }\n};\n\ninterface OuterBorderProps {\n  w: number;\n  h: number;\n  clazz: string;\n  show?: boolean;\n  color?: string;\n}\n\nexport const OuterBorder: React.FC<OuterBorderProps> = ({\n  w,\n  h,\n  clazz,\n  show = false,\n  color = \"gray\",\n}: OuterBorderProps) => {\n  if (show) {\n    return (\n      <rect\n        className={clazz + \"__outer-border\"}\n        transform={\"translate(0,0)\"}\n        width={w}\n        height={h}\n        stroke={color}\n        strokeWidth=\"0.4\"\n        fill=\"none\"\n      />\n    );\n  } else {\n    return <></>;\n  }\n};\n","export default class Fraction {\n  u: number = 0;\n  d: number = 1;\n  parse(x: string): Fraction {\n    let pos = x.search(\"/\");\n    if (pos !== -1) {\n      this.u = parseInt(x.substr(0, pos));\n      this.d = parseInt(x.substr(pos + 1));\n    } else {\n      this.u = parseInt(x);\n    }\n    return this;\n  }\n  init(u: number, d: number): Fraction {\n    this.u = u;\n    this.d = d;\n    return this;\n  }\n  gcd(a: number, b: number): number {\n    while (b !== 0) {\n      let t = b;\n      b = a % b;\n      a = t;\n    }\n    return a;\n  }\n  simplify(): Fraction {\n    let n: number;\n    while ((n = this.gcd(this.u, this.d)) > 1 || n < -1) {\n      this.u /= n;\n      this.d /= n;\n    }\n    return this;\n  }\n  plus(f: Fraction): Fraction {\n    let r = new Fraction();\n    r.u = this.u * f.d + this.d * f.u;\n    r.d = this.d * f.d;\n    return r.simplify();\n  }\n  minus(f: Fraction): Fraction {\n    let r = new Fraction();\n    r.u = this.u * f.d - this.d * f.u;\n    r.d = this.d * f.d;\n    return r.simplify();\n  }\n  multiply(f: Fraction): Fraction {\n    let r = new Fraction();\n    r.u = this.u * f.u;\n    r.d = this.d * f.d;\n    return r.simplify();\n  }\n  divide(f: Fraction): Fraction {\n    let r = new Fraction();\n    r.u = this.u * f.d;\n    r.d = this.d * f.u;\n    return r.simplify();\n  }\n  toNumber(): number {\n    return this.u / this.d;\n  }\n  toString(): string {\n    if (this.d === 1) {\n      return `${this.u}`\n    } else {\n      return `${this.u}/${this.d}`\n    }\n  }\n}\n","export interface SelectionNote {\n  setSelect: (i: boolean) => void;\n  reduceLine: (l: number) => void;\n  reduceTailPoint: (p: number) => void;\n  addSubNote: (n: string) => void;\n  removeSubNote: (index: number) => void;\n}\n\nexport interface SelectionSubNote {\n  setSelect: (i: boolean) => void;\n  setNum: (n: string) => void;\n  reducePoint: (h: number) => void;\n  reduceLine: (l: number) => void;\n  reduceTailPoint: (p: number) => void;\n  getIndex: () => number;\n}\n\nclass Selector {\n  subnote: SelectionSubNote | null = null;\n  note: SelectionNote | null = null;\n  static instance = new Selector();\n  private constructor() {\n    document.addEventListener(\"keydown\", (ev) => {\n      console.log(ev);\n      if (this.subnote !== null) {\n        if ((ev.key >= \"0\" && ev.key <= \"9\") || ev.key === \"-\") {\n          this.subnote.setNum(ev.key);\n        } else if (ev.key === \"r\") {\n          this.subnote.reducePoint(1);\n        } else if (ev.key === \"f\") {\n          this.subnote.reducePoint(-1);\n        } else if (ev.key === \"q\") {\n          this.subnote.reduceLine(-1);\n        } else if (ev.key === \"a\") {\n          this.subnote.reduceLine(1);\n        } else if (ev.key === \"s\") {\n          this.subnote.reduceTailPoint(-1);\n        } else if (ev.key === \"d\") {\n          this.subnote.reduceTailPoint(1);\n        } else if (ev.key === \"Enter\") {\n          this.subnote.setSelect(false);\n          this.subnote = null;\n          this.note?.setSelect(true);\n        } else if (ev.key === \"Backspace\") {\n          this.note?.removeSubNote(this.subnote.getIndex());\n          this.note?.setSelect(true);\n          this.subnote.setSelect(false);\n          this.subnote = null;\n        }\n      } else if (this.note !== null) {\n        if (ev.key === \"q\") {\n          this.note.reduceLine(-1);\n        } else if (ev.key === \"a\") {\n          this.note.reduceLine(1);\n        } else if (ev.key === \"s\") {\n          this.note.reduceTailPoint(-1);\n        } else if (ev.key === \"d\") {\n          this.note.reduceTailPoint(1);\n        } else if (ev.key === \" \") {\n          this.note.addSubNote(\"0\");\n        } else if (ev.key === \"ArowUp\") {\n        } else if (ev.key === \"ArrowDown\") {\n        }\n      }\n    });\n  }\n  selectNote(s: SelectionNote) {\n    this.note?.setSelect(false);\n    this.note = s;\n    if (this.subnote === null) this.note.setSelect(true);\n  }\n  selectSubNote(s: SelectionSubNote) {\n    this.subnote?.setSelect(false);\n    this.note?.setSelect(false);\n    this.subnote = s;\n    this.subnote.setSelect(true);\n  }\n}\n\nexport default Selector;\n","import React from \"react\";\nimport { Border, OuterBorder } from \"./Border\";\nimport MuseConfig from \"./MuseConfig\";\nimport Codec from \"./Codec\";\nimport Fraction from \"./Fraction\";\nimport { computed, observable } from \"mobx\";\nimport { observer } from \"mobx-react\";\nimport Selector, { SelectionNote, SelectionSubNote } from \"./Selector\";\nimport { Bar } from \"./MuseBar\";\n\nexport interface INote {\n  n: string;\n}\n\nclass SubNote {\n  @observable isSelect = false;\n  readonly note: Note;\n  readonly index: number;\n  config: MuseConfig;\n  @observable x: string = \"\";\n  @observable n: string = \"\";\n  @observable t: number = 0;\n  selection: SelectionSubNote = {\n    setSelect: (s: boolean) => {\n      this.isSelect = s;\n    },\n    setNum: (n: string) => {\n      this.n = n;\n    },\n    reducePoint: (h: number) => {\n      this.t += h;\n    },\n    reduceLine: (l: number) => {\n      this.note.l += l;\n      if (this.note.l < 0) {\n        this.note.l = 0;\n      }\n    },\n    reduceTailPoint: (p: number) => {\n      this.note.p += p;\n      if (this.note.p < 0) {\n        this.note.p = 0;\n      }\n    },\n    getIndex: () => {\n      return this.index;\n    },\n  };\n  constructor(\n    x: string,\n    n: string,\n    t: number,\n    note: Note,\n    index: number,\n    config: MuseConfig\n  ) {\n    this.x = x;\n    this.n = n;\n    this.t = t;\n    this.note = note;\n    this.index = index;\n    this.config = config;\n  }\n}\n\nexport class Note implements Codec {\n  readonly config: MuseConfig;\n  @observable index: number;\n  @observable bar: Bar;\n  @observable subNotes: SubNote[] = [];\n  @observable l: number = 0;\n  @observable p: number = 0;\n  @observable d: number = 0;\n  @computed get dx(): number {\n    let dxx = false;\n    this.subNotes.forEach((it) => {\n      if (it.x !== \"\") {\n        dxx = true;\n      }\n    });\n    return dxx ? this.config.sigFontSize / 2 : 0;\n  }\n  @computed get time(): Fraction {\n    let r = new Fraction();\n    r.u = 1;\n    r.d *= Math.pow(2, this.l);\n    r.d *= this.d;\n    r.d *= Math.pow(2, this.p); //3/2 7/4 15/8\n    r.u *= Math.pow(2, this.p + 1) - 1;\n    return r.simplify();\n  }\n  @computed get notesY(): number[] {\n    let r: number[] = [];\n    let ny = 0;\n    this.subNotes.forEach((it, idx) => {\n      if (it.t < 0) {\n        if (idx !== 0) {\n          let i = -it.t;\n          for (; i > 0; --i) {\n            let x = this.config.pointGap;\n            ny += x;\n          }\n        }\n      }\n      r.push(ny);\n      let h = this.config.noteHeight;\n      ny += h;\n      if (it.t > 0) {\n        let i = it.t;\n        for (; i > 0; --i) {\n          let x = this.config.pointGap;\n          ny += x;\n        }\n      }\n    });\n    return r;\n  }\n  @computed get pointsY(): number[] {\n    let r: number[] = [];\n    let py = 0;\n    let ny = 0;\n    let mb = 0;\n    mb += this.l * this.config.pointGap;\n    this.subNotes.forEach((it, idx) => {\n      if (it.t < 0) {\n        if (idx === 0) {\n          let i = -it.t;\n          for (; i > 0; --i) {\n            let x = this.config.pointGap;\n            mb += x / 2;\n            r.push(-mb);\n            mb += x / 2;\n          }\n        }\n        if (idx !== 0) {\n          let i = -it.t;\n          for (; i > 0; --i) {\n            let x = this.config.pointGap;\n            py += x / 2;\n            r.push(py);\n            py += x / 2;\n            ny += x;\n          }\n        }\n      }\n      this.notesY.push(ny);\n      let h = this.config.noteHeight;\n      ny += h;\n      py += h;\n      if (it.t > 0) {\n        let i = it.t;\n        for (; i > 0; --i) {\n          let x = this.config.pointGap;\n          py += x / 2;\n          r.push(py);\n          py += x / 2;\n          ny += x;\n        }\n      }\n    });\n    return r;\n  }\n  @computed get tailPointsX(): number[] {\n    let r: number[] = [];\n    for (let i = 0; i < this.p; ++i) {\n      r.push(\n        this.dx + this.config.noteWidth + (i + 1 / 2) * this.config.tailPointGap\n      );\n    }\n    return r;\n  }\n  @computed get width(): number {\n    return this.dx + this.config.noteWidth + this.p * this.config.tailPointGap;\n  }\n  @computed get preHeight(): number {\n    let h = 0;\n    this.subNotes.forEach((it, idx) => {\n      if (it.t < 0) {\n        if (idx !== 0) {\n          let i = -it.t;\n          for (; i > 0; --i) {\n            let x = this.config.pointGap;\n            h += x;\n          }\n        }\n      }\n      h += this.config.noteHeight;\n      if (it.t > 0) {\n        let i = it.t;\n        for (; i > 0; --i) {\n          let x = this.config.pointGap;\n          h += x;\n        }\n      }\n    });\n    return h;\n  }\n  @computed get height(): number {\n    return this.bar.notesMaxHeight;\n  }\n  @computed get x(): number {\n    return this.bar.notesX[this.index];\n  }\n  @computed get preMarginBottom(): number {\n    let mb = 0;\n    mb += this.l * this.config.pointGap;\n    this.subNotes.forEach((it, idx) => {\n      if (it.t < 0) {\n        if (idx === 0) {\n          let i = -it.t;\n          for (; i > 0; --i) {\n            let x = this.config.pointGap;\n            mb += x;\n          }\n        }\n      }\n    });\n    return mb;\n  }\n  @computed get marginBottom(): number {\n    return this.bar.notesMaxMarginBottom;\n  }\n  @observable isSelect: boolean = false;\n  constructor(o: INote, bar: Bar, idx: number) {\n    this.config = bar.config;\n    this.bar = bar;\n    this.index = idx;\n    this.decode(o);\n  }\n  selection: SelectionNote = {\n    setSelect: (s: boolean) => {\n      this.isSelect = s;\n    },\n    reduceLine: (l: number) => {\n      this.l += l;\n      if (this.l < 0) {\n        this.l = 0;\n      }\n    },\n    reduceTailPoint: (p: number) => {\n      this.p += p;\n      if (this.p < 0) {\n        this.p = 0;\n      }\n    },\n    addSubNote: (n: string) => {\n      this.subNotes.push(\n        new SubNote(\"\", n, 0, this, this.subNotes.length, this.config)\n      );\n      Selector.instance.selectSubNote(\n        this.subNotes[this.subNotes.length - 1].selection\n      );\n    },\n    removeSubNote: (index: number) => {\n      this.subNotes = this.subNotes.filter((it) => it.index !== index);\n    },\n  };\n  decode(o: INote): void {\n    if (o.n !== undefined) {\n      let n: string = o.n;\n      let pos = n.search(\"@\");\n      let ns = \"\";\n      let ts = \"\";\n      if (pos === -1) {\n        ns = n;\n        ts = \"0|0\";\n      } else {\n        ns = n.substr(0, pos);\n        ts = n.substr(pos + 1);\n      }\n      let ng = ns.split(\"|\");\n      ng.forEach((it, idx) => {\n        for (let i = 0; i < it.length; ++i) {\n          if (\n            (it.charCodeAt(i) <= 57 && it.charCodeAt(i) >= 48) ||\n            it.charCodeAt(i) === 45\n          ) {\n            let x = it.substr(0, i);\n            let n = it.charAt(i);\n            let t = it.substr(i + 1).length;\n            if (t !== 0 && it.charAt(i + 1) === \"-\") {\n              t = -t;\n            }\n            this.subNotes.push(new SubNote(x, n, t, this, idx, this.config));\n            break;\n          }\n        }\n      });\n      let tg = ts.split(\"|\");\n      if (tg.length === 3) {\n        this.l = parseInt(tg[0]);\n        this.p = parseInt(tg[1]);\n        this.d = parseInt(tg[2]);\n      } else if (tg.length === 2) {\n        this.l = parseInt(tg[0]);\n        this.p = parseInt(tg[1]);\n        this.d = 1;\n      } else if (tg.length === 1) {\n        this.l = parseInt(tg[0]);\n        this.p = 0;\n        this.d = 1;\n      } else {\n        this.l = 0;\n        this.p = 0;\n        this.d = 1;\n      }\n    }\n  }\n  code(): INote {\n    let ns: string = \"\";\n    this.subNotes.forEach((it, idx) => {\n      let t = \"\";\n      if (it.t > 0) {\n        for (let i = 0; i < it.t; ++i) {\n          t += \"+\";\n        }\n      } else {\n        for (let i = 0; i < -it.t; ++i) {\n          t += \"-\";\n        }\n      }\n      if (idx + 1 >= this.subNotes.length) {\n        ns += `${it.x}${it.n}${t}`;\n      } else {\n        ns += `${it.x}${it.n}${t}|`;\n      }\n    });\n    let n = `${ns}@${this.l}|${this.p}`;\n    return { n };\n  }\n}\n\nfunction castX(x: string) {\n  let m: Record<string, string> = {\n    S: \"#\",\n    F: \"b\",\n    DS: \"x\",\n    DF: \"d\",\n    N: \"n\",\n  };\n  return m[x] || \"\";\n}\n\nfunction pointGroup(note: Note, clazz: string) {\n  return (\n    <g className={clazz + \"__group-point\"}>\n      {note.pointsY.map((it, idx) => (\n        <circle\n          key={idx}\n          r={note.config.pointRound}\n          fill=\"black\"\n          transform={\n            \"translate(\" +\n            (note.dx + note.config.noteWidth / 2) +\n            \",\" +\n            (note.height - it + note.config.pointGap / 2) +\n            \")\"\n          }\n        />\n      ))}\n    </g>\n  );\n}\n\nfunction tailPoint(note: Note, clazz: string) {\n  return (\n    <g className={clazz + \"__tail-point\"}>\n      {note.tailPointsX.map((it, idx) => (\n        <circle\n          key={idx}\n          r={note.config.pointRound}\n          fill=\"black\"\n          transform={\n            \"translate(\" +\n            it +\n            \",\" +\n            (note.height - note.config.noteHeight / 3) +\n            \")\"\n          }\n        />\n      ))}\n    </g>\n  );\n}\n\ninterface MuseSubNoteProps {\n  dx: number;\n  y: number;\n  w: number;\n  h: number;\n  subNote: SubNote;\n}\n\n@observer\nclass MuseSubNote extends React.Component<MuseSubNoteProps, {}> {\n  render() {\n    return (\n      <g\n        className={\"muse-note__subnote\"}\n        transform={\"translate(\" + 0 + \",\" + this.props.y + \")\"}\n        width={this.props.w}\n        height={this.props.h}\n        onClick={() => {\n          Selector.instance.selectSubNote(this.props.subNote.selection);\n        }}\n      >\n        <text\n          fontFamily={this.props.subNote.config.noteFontFamily}\n          fontSize={this.props.subNote.config.noteFontSize}\n          transform={\"translate(\" + this.props.dx + \",\" + 0 + \")\"}\n        >\n          {this.props.subNote.n}\n        </text>\n        <text\n          fontFamily={this.props.subNote.config.noteFontFamily}\n          fontSize={this.props.subNote.config.sigFontSize}\n          transform={\n            \"translate(\" +\n            0 +\n            \",\" +\n            (this.props.subNote.config.sigFontSize -\n              this.props.subNote.config.noteHeight) +\n            \")\"\n          }\n        >\n          {castX(this.props.subNote.x)}\n        </text>\n        <Border\n          x={0}\n          y={-this.props.h}\n          w={this.props.w}\n          h={this.props.subNote.config.noteFontSize}\n          clazz={\"muse-note__subnote\"}\n          show={this.props.subNote.isSelect}\n        />\n      </g>\n    );\n  }\n}\n\n@observer\nclass MuseNote extends React.Component<{ note: Note }, {}> {\n  render() {\n    let clazz = \"muse-note\";\n    return (\n      <g\n        className={clazz}\n        transform={\"translate(\" + this.props.note.x + \",\" + 0 + \")\"}\n        width={this.props.note.width}\n        height={this.props.note.height}\n        onClick={() => {\n          Selector.instance.selectNote(this.props.note.selection);\n        }}\n      >\n        <OuterBorder\n          w={this.props.note.width}\n          h={this.props.note.height + this.props.note.marginBottom}\n          clazz={clazz}\n          show={this.props.note.isSelect}\n          color={\"blue\"}\n        />\n        {this.props.note.subNotes.map((it, idx) => (\n          <MuseSubNote\n            key={idx}\n            dx={this.props.note.dx}\n            y={this.props.note.height - this.props.note.notesY[idx]}\n            w={this.props.note.width}\n            h={22}\n            subNote={it}\n          />\n        ))}\n        {pointGroup(this.props.note, clazz)}\n        {tailPoint(this.props.note, clazz)}\n      </g>\n    );\n  }\n}\n\nexport default MuseNote;\n","import React from \"react\";\nimport MuseConfig from \"./MuseConfig\";\nimport MuseNote, { INote, Note } from \"./MuseNote\";\nimport { Border } from \"./Border\";\nimport Codec from \"./Codec\";\nimport { computed, observable } from \"mobx\";\nimport { observer, useObserver } from \"mobx-react\";\nimport Fraction from \"./Fraction\";\nimport { Track } from \"./MuseTrack\";\n\ninterface Baseline {\n  y: number;\n  s: number;\n  e: number;\n}\n\nexport interface IBar {\n  notes: INote[];\n}\n\nexport class Bar implements Codec {\n  readonly config: MuseConfig;\n  readonly index: number;\n  @observable track: Track;\n  @observable notes: Note[] = [];\n  @computed get width(): number {\n    return this.track.barsWidth[this.index];\n  }\n  @computed get height(): number {\n    let h = 0;\n    this.notes.forEach((it) => {\n      let u = it.height + it.marginBottom;\n      h = u > h ? u : h;\n    });\n    return h;\n  }\n  @computed get x(): number {\n    return this.track.barsX[this.index];\n  }\n  @computed get y(): number {\n    return 0;\n  }\n  @computed get notesTime(): Fraction[] {\n    return this.notes.map((it) => it.time);\n  }\n  @computed get notesTimeSum(): Fraction {\n    return this.notesTime\n      .reduce((a, b) => a.plus(b), new Fraction())\n      .plus(new Fraction().init(1, 1));\n  }\n  @computed get notesWidth(): number[] {\n    return this.notes.map((it) => it.width);\n  }\n  @computed get notesX(): number[] {\n    let space = this.width - this.notesWidthSum;\n    let unit = new Fraction().init(space, 1).divide(this.notesTimeSum);\n    let x = unit.toNumber();\n    return this.notesWidth.map((it, idx) => {\n      let r = x;\n      x += it + this.notesTime[idx].multiply(unit).toNumber();\n      return r;\n    });\n  }\n  @computed get preNotesMaxHeight(): number {\n    return Math.max(...this.notes.map((it) => it.preHeight));\n  }\n  @computed get notesMaxHeight(): number {\n    return this.track.notesMaxHeight;\n  }\n  @computed get preNotesMaxMarginBottom(): number {\n    return Math.max(...this.notes.map((it) => it.preMarginBottom));\n  }\n  @computed get notesMaxMarginBottom(): number {\n    return this.track.notesMaxMarginBottom;\n  }\n  @computed get baselineGroup(): Baseline[] {\n    let r: {\n      y: number;\n      s: number;\n      e: number;\n    }[] = [];\n    for (let i = 0; ; ++i) {\n      let x = 0;\n      let s = 0;\n      let e = -1;\n      this.notes.forEach((it, idx) => {\n        if (it.l > i) {\n          e = idx;\n          x++;\n        } else {\n          if (s <= e) r.push({ y: i, s: s, e: e });\n          s = idx + 1;\n          e = idx;\n        }\n      });\n      if (s <= e) r.push({ y: i, s: s, e: e });\n      if (x === 0) {\n        break;\n      }\n    }\n    return r;\n  }\n  @computed get notesWidthSum(): number {\n    let w = 0;\n    this.notes.forEach((it) => (w += it.width));\n    return w;\n  }\n  constructor(o: IBar, index: number, track: Track, config: MuseConfig) {\n    this.index = index;\n    this.track = track;\n    this.config = config;\n    this.decode(o);\n  }\n  decode(o: IBar): void {\n    if (o.notes !== undefined) {\n      o.notes.forEach((it: INote, idx) => {\n        this.notes.push(new Note(it, this, idx));\n      });\n    }\n  }\n  code(): IBar {\n    let notes: INote[] = this.notes.map((it) => it.code());\n    return { notes };\n  }\n}\n\nconst BarLine: React.FC<{ w: number; h: number; clazz: string }> = (props: {\n  w: number;\n  h: number;\n  clazz: string;\n}) => {\n  let [width, height] = useObserver(() => {\n    return [props.w, props.h];\n  });\n  return (\n    <line\n      className={props.clazz + \"__bar-line\"}\n      x1={width}\n      y1={0}\n      x2={width}\n      y2={height}\n      strokeWidth={1}\n      stroke=\"black\"\n    />\n  );\n};\n\nconst BaseLine: React.FC<{ bar: Bar; clazz: string }> = ({\n  bar,\n  clazz,\n}: {\n  bar: Bar;\n  clazz: string;\n}) => {\n  let [baselineGroup, notes] = useObserver(() => {\n    return [bar.baselineGroup, bar.notes];\n  });\n  return (\n    <g className={clazz + \"__base-line\"}>\n      {baselineGroup.map((it, idx) => (\n        <line\n          key={idx}\n          x1={notes[it.s].x}\n          y1={notes[it.s].height + (it.y + 1) * bar.config.pointGap}\n          x2={notes[it.e].x + bar.notes[it.e].width}\n          y2={notes[it.s].height + (it.y + 1) * bar.config.pointGap}\n          stroke={\"black\"}\n          strokeWidth={1}\n        />\n      ))}\n    </g>\n  );\n};\n\n@observer\nclass MuseBar extends React.Component<{ bar: Bar }, {}> {\n  render() {\n    let notes = this.props.bar.notes;\n    let clazz = \"muse-bar\";\n    return (\n      <g\n        className={clazz}\n        transform={\n          \"translate(\" + this.props.bar.x + \",\" + this.props.bar.y + \")\"\n        }\n        width={this.props.bar.width}\n        height={this.props.bar.height}\n      >\n        <Border\n          w={this.props.bar.width}\n          h={this.props.bar.height}\n          x={0}\n          y={0}\n          clazz={clazz}\n          show={this.props.bar.config.showBorder}\n        />\n        <BarLine\n          w={this.props.bar.width}\n          h={this.props.bar.height}\n          clazz={clazz}\n        />\n        {notes.map((it, idx) => (\n          <MuseNote key={idx} note={it} />\n        ))}\n        <BaseLine bar={this.props.bar} clazz={clazz} />\n      </g>\n    );\n  }\n}\n\nexport default MuseBar;\n","import React from \"react\";\nimport MuseConfig from \"./MuseConfig\";\nimport MuseBar, { Bar, IBar } from \"./MuseBar\";\nimport { Border } from \"./Border\";\nimport Codec from \"./Codec\";\nimport { computed, observable } from \"mobx\";\nimport { Line } from \"./MuseLine\";\nimport Fraction from \"./Fraction\";\nimport { observer } from \"mobx-react\";\n\nexport interface ITrack {\n  bars: IBar[];\n}\n\nexport class Track implements Codec {\n  readonly config: MuseConfig;\n  readonly index: number;\n  readonly line: Line;\n  @observable bars: Bar[] = [];\n  @computed get width(): number {\n    return this.line.width;\n  }\n  @computed get height(): number {\n    let h = 0;\n    this.bars.forEach((it) => {\n      h = it.height > h ? it.height : h;\n    });\n    return h;\n  }\n  @computed get x(): number {\n    return 0;\n  }\n  @computed get y(): number {\n    return this.line.tracksY[this.index];\n  }\n  @computed get barsTime(): Fraction[] {\n    return this.bars.map((it) => it.notesTimeSum);\n  }\n  @computed get barsWidth(): number[] {\n    let timeSum = this.barsTime.reduce((a, b) => a.plus(b), new Fraction());\n    let space = this.width - this.notesWidthSum;\n    let unit = new Fraction().init(space, 1).divide(timeSum);\n    return this.barsNotesWidth.map((it, idx) => {\n      return it + this.barsTime[idx].multiply(unit).toNumber();\n    });\n  }\n  @computed get barsX(): number[] {\n    let x = 0;\n    return this.barsWidth.map((it) => {\n      let r = x;\n      x += it;\n      return r;\n    });\n  }\n  @computed get notesMaxHeight(): number {\n    return Math.max(...this.bars.map((it) => it.preNotesMaxHeight));\n  }\n  @computed get notesMaxMarginBottom(): number {\n    return Math.max(...this.bars.map((it) => it.preNotesMaxMarginBottom));\n  }\n  @computed get notesWidthSum(): number {\n    return this.barsNotesWidth.reduce((a, b) => a + b, 0);\n  }\n  @computed get barsNotesWidth(): number[] {\n    return this.bars.map((it) => it.notesWidthSum);\n  }\n  constructor(o: ITrack, index: number, line: Line, config: MuseConfig) {\n    this.index = index;\n    this.line = line;\n    this.config = config;\n    this.decode(o);\n  }\n  decode(o: ITrack): void {\n    if (o.bars !== undefined) {\n      o.bars.forEach((it: any, idx) => {\n        this.bars.push(new Bar(it, idx, this, this.config));\n      });\n    }\n  }\n  code(): ITrack {\n    let bars: IBar[] = this.bars.map((it) => it.code());\n    return { bars };\n  }\n}\n\n@observer\nclass MuseTrack extends React.Component<{ track: Track }> {\n  render() {\n    let clazz = \"muse-track\";\n    return (\n      <g\n        className={clazz}\n        transform={\n          \"translate(\" + this.props.track.x + \",\" + this.props.track.y + \")\"\n        }\n        width={this.props.track.width}\n        height={this.props.track.height}\n      >\n        <Border\n          w={this.props.track.width}\n          h={this.props.track.height}\n          x={0}\n          y={0}\n          clazz={clazz}\n          show={this.props.track.config.showBorder}\n        />\n        {this.props.track.bars.map((it, idx) => (\n          <MuseBar key={idx} bar={it} />\n        ))}\n      </g>\n    );\n  }\n}\n\nexport default MuseTrack;\n","import React from \"react\";\nimport MuseConfig from \"./MuseConfig\";\nimport MuseTrack, { ITrack, Track } from \"./MuseTrack\";\nimport { Border } from \"./Border\";\nimport Codec from \"./Codec\";\nimport { computed, observable } from \"mobx\";\nimport { observer } from \"mobx-react\";\nimport { Page } from \"./MusePage\";\n\nexport interface ILine {\n  tracks: ITrack[];\n}\n\nexport class Line implements Codec {\n  readonly page: Page;\n  readonly index: number;\n  readonly config: MuseConfig;\n  @observable tracks: Track[] = [];\n  @computed get width() {\n    return this.page.width;\n  }\n  @computed get height() {\n    let h = 0;\n    this.tracks.forEach((it) => {\n      h += it.height + this.config.trackGap;\n    });\n    h -= this.config.trackGap;\n    return h;\n  }\n  @computed get x() {\n    return this.page.x;\n  }\n  @computed get y() {\n    return this.page.linesY[this.index];\n  }\n  @computed get tracksY(): number[] {\n    let y = 0;\n    return this.tracks.map((it) => {\n      let r = y;\n      y += it.height + this.config.trackGap;\n      return r;\n    });\n  }\n  constructor(o: ILine, index: number, page: Page, config: MuseConfig) {\n    this.page = page;\n    this.index = index;\n    this.config = config;\n    this.decode(o);\n  }\n  decode(o: ILine): void {\n    if (o.tracks !== undefined) {\n      o.tracks.forEach((it: ITrack, idx) => {\n        this.tracks.push(new Track(it, idx, this, this.config));\n      });\n    }\n  }\n  code(): ILine {\n    let tracks: ITrack[] = this.tracks.map((it) => it.code());\n    return { tracks };\n  }\n}\n\nconst LineHead: React.FC<{ height: number; clazz: string }> = ({\n  height,\n  clazz,\n}: {\n  height: number;\n  clazz: string;\n}) => {\n  return (\n    <g className={clazz + \"__line-head\"}>\n      <line x1={0} y1={0} x2={0} y2={height} strokeWidth={1} stroke=\"black\" />\n    </g>\n  );\n};\n\n@observer\nclass MuseLine extends React.Component<{ line: Line }> {\n  render() {\n    let clazz = \"muse-line\";\n    return (\n      <g\n        className={clazz}\n        transform={\n          \"translate(\" + this.props.line.x + \",\" + this.props.line.y + \")\"\n        }\n        width={this.props.line.width}\n        height={this.props.line.height}\n      >\n        <Border\n          w={this.props.line.width}\n          h={this.props.line.height}\n          x={0}\n          y={0}\n          clazz={clazz}\n          show={this.props.line.config.showBorder}\n        />\n        <LineHead height={this.props.line.height} clazz={clazz} />\n        {this.props.line.tracks.map((it, idx) => (\n          <MuseTrack key={idx} track={it} />\n        ))}\n      </g>\n    );\n  }\n}\n\nexport default MuseLine;\n","import React from \"react\";\nimport MuseConfig from \"./MuseConfig\";\nimport MuseLine, { ILine, Line } from \"./MuseLine\";\nimport { Border, OuterBorder } from \"./Border\";\nimport Codec from \"./Codec\";\nimport { computed, observable } from \"mobx\";\nimport { Notation } from \"./MuseNotation\";\nimport { observer } from \"mobx-react\";\n\nexport interface IPage {\n  lines: ILine[];\n}\n\nexport class Page implements Codec {\n  readonly notation: Notation;\n  readonly config: MuseConfig;\n  readonly index: number;\n  @observable lines: Line[] = [];\n  @computed get width() {\n    return this.config.pageWidth - this.config.pageMarginHorizontal * 2;\n  }\n  @computed get height() {\n    return (\n      this.config.pageWidth * this.config.pageE -\n      this.config.pageMarginVertical * 2\n    );\n  }\n  @computed get x() {\n    return this.config.pageMarginHorizontal;\n  }\n  @computed get y() {\n    return this.marginTop + this.index * this.height;\n  }\n  @computed get marginTop() {\n    let mt = 0;\n    if (this.index === 0) {\n      mt += this.config.pageMarginVertical;\n      let g = this.config.infoGap;\n      mt += this.config.infoTitleFontSize + g;\n      mt += this.config.infoSubtitleFontSize + g;\n      if (this.notation.info.author.length > 2) {\n        mt += this.notation.info.author.length * (this.config.infoFontSize + g);\n      } else {\n        mt += 2 * (this.config.infoFontSize + g);\n      }\n    } else {\n      mt = this.config.pageMarginVertical;\n    }\n    return mt;\n  }\n  @computed get marginBottom() {\n    return this.config.pageMarginVertical;\n  }\n  @computed get marginLeft() {\n    return this.config.pageMarginHorizontal;\n  }\n  @computed get marginRight() {\n    return this.config.pageMarginHorizontal;\n  }\n  @computed get linesHeight(): number[] {\n    return this.lines.map((it) => it.height);\n  }\n  @computed get linesY() {\n    let y = this.marginTop;\n    let sum = this.linesHeight.reduce((a, b) => a + b, 0);\n    let gap = (this.height - sum) / (this.lines.length - 1);\n    return this.linesHeight.map((it) => {\n      let r = y;\n      y += it + gap;\n      return r;\n    });\n  }\n  constructor(o: IPage, index: number, notation: Notation, config: MuseConfig) {\n    this.index = index;\n    this.notation = notation;\n    this.config = config;\n    this.decode(o);\n  }\n  decode(o: IPage): void {\n    if (o.lines !== undefined) {\n      o.lines.forEach((it: ILine, idx) => {\n        this.lines.push(new Line(it, idx, this, this.config));\n      });\n    }\n  }\n  code(): IPage {\n    let lines: ILine[] = this.lines.map((it) => it.code());\n    return { lines };\n  }\n}\n\ninterface PageIndexProps {\n  index: number;\n  x: number;\n  y: number;\n  clazz: string;\n  config: MuseConfig;\n}\n\nconst PageIndex: React.FC<PageIndexProps> = ({\n  index,\n  x,\n  y,\n  clazz,\n  config,\n}: PageIndexProps) => {\n  return (\n    <g\n      className={clazz + \"__page-index\"}\n      transform={\"translate(\" + x + \",\" + y + \")\"}\n    >\n      <text\n        textAnchor={\"middle\"}\n        fontFamily={config.textFontFamily}\n        fontSize={config.pageIndexFontSize}\n      >\n        {(index + 1).toString()}\n      </text>\n    </g>\n  );\n};\n\n@observer\nclass MusePage extends React.Component<{ page: Page }> {\n  render() {\n    let clazz = \"muse-page\";\n    return (\n      <g\n        className={clazz}\n        transform={\n          \"translate(\" +\n          (this.props.page.x - this.props.page.marginLeft) +\n          \",\" +\n          (this.props.page.y - this.props.page.marginTop) +\n          \")\"\n        }\n        width={\n          this.props.page.width +\n          this.props.page.marginLeft +\n          this.props.page.marginRight\n        }\n        height={\n          this.props.page.height +\n          this.props.page.marginTop +\n          this.props.page.marginBottom\n        }\n      >\n        <Border\n          w={this.props.page.width}\n          h={this.props.page.height}\n          x={this.props.page.x}\n          y={this.props.page.y}\n          clazz={clazz}\n          show={this.props.page.config.showBorder}\n        />\n        <OuterBorder\n          w={\n            this.props.page.width +\n            this.props.page.marginLeft +\n            this.props.page.marginLeft\n          }\n          h={\n            this.props.page.height +\n            this.props.page.marginTop +\n            this.props.page.marginBottom\n          }\n          clazz={clazz}\n          show={true}\n        />\n        <PageIndex\n          index={this.props.page.index}\n          x={this.props.page.marginLeft + this.props.page.width / 2}\n          y={\n            this.props.page.marginTop +\n            this.props.page.height +\n            this.props.page.marginBottom / 2\n          }\n          clazz={clazz}\n          config={this.props.page.config}\n        />\n        {this.props.page.lines.map((it, idx) => (\n          <MuseLine key={idx} line={it} />\n        ))}\n      </g>\n    );\n  }\n}\n\nexport default MusePage;\n","import React from \"react\";\nimport MuseConfig from \"./MuseConfig\";\nimport MusePage, { IPage, Page } from \"./MusePage\";\nimport { Border } from \"./Border\";\nimport Codec from \"./Codec\";\nimport { computed, observable } from \"mobx\";\nimport { observer } from \"mobx-react\";\n\nexport class NotationInfo {\n  @observable title: string = \"\";\n  @observable subtitle: string = \"\";\n  @observable author: string[] = [];\n  @observable speed: string = \"\";\n  @observable rhythmic: string = \"\";\n  @observable C: string = \"\";\n}\n\nexport interface INotation {\n  title: string;\n  subtitle: string;\n  author: string;\n  rhythmic: string;\n  speed: string;\n  C: string;\n  pages: IPage[];\n}\n\nexport class Notation implements Codec {\n  readonly config: MuseConfig;\n  @observable pages: Page[] = [];\n  @observable info: NotationInfo = new NotationInfo();\n  @computed get height() {\n    let h = 0;\n    this.pages.forEach(\n      (it) => (h += it.height + it.marginTop + it.marginBottom)\n    );\n    return h;\n  }\n  @computed get width() {\n    return this.config.pageWidth;\n  }\n  constructor(o: INotation, config: MuseConfig) {\n    this.config = config;\n    this.decode(o);\n  }\n  decode(o: INotation): void {\n    if (o.pages !== undefined) {\n      o.pages.forEach((it: IPage, idx) => {\n        this.pages.push(new Page(it, idx, this, this.config));\n      });\n    }\n    if (o.title !== undefined) {\n      this.info.title = o.title;\n    }\n    if (o.subtitle !== undefined) {\n      this.info.subtitle = o.subtitle;\n    }\n    if (o.author !== undefined) {\n      this.info.author = o.author.toString().split(\"|\");\n    }\n    if (o.speed !== undefined) {\n      this.info.speed = o.speed;\n    }\n    if (o.rhythmic) {\n      this.info.rhythmic = o.rhythmic;\n    }\n    if (o.C) {\n      this.info.C = o.C;\n    }\n  }\n  code(): INotation {\n    let pages: IPage[] = this.pages.map((it) => it.code());\n    let author: string = \"\";\n    this.info.author.forEach((it, idx) => {\n      if (idx === this.info.author.length - 1) {\n        author += it;\n      } else {\n        author += it + \"|\";\n      }\n    });\n    return {\n      title: this.info.title,\n      subtitle: this.info.subtitle,\n      author: author,\n      rhythmic: this.info.rhythmic,\n      speed: this.info.speed,\n      C: this.info.C,\n      pages,\n    };\n  }\n}\n\ninterface MuseNotationInfoProps {\n  info: NotationInfo;\n  config: MuseConfig;\n  clazz: string;\n}\n\nconst MuseNotationInfo: React.FC<MuseNotationInfoProps> = ({\n  info,\n  config,\n  clazz,\n}: MuseNotationInfoProps) => {\n  let y = 0;\n  y += config.pageMarginVertical;\n  let title = (\n    <text\n      className={clazz + \"__info-title\"}\n      fontFamily={config.textFontFamily}\n      width={config.pageWidth}\n      textAnchor={\"middle\"}\n      fontSize={config.infoTitleFontSize}\n      transform={\"translate(\" + config.pageWidth / 2 + \",\" + y + \")\"}\n    >\n      {info.title}\n    </text>\n  );\n  y += config.infoTitleFontSize + config.infoGap;\n  let subtitle = (\n    <text\n      className={clazz + \"__info-subtitle\"}\n      fontFamily={config.textFontFamily}\n      width={config.pageWidth}\n      textAnchor={\"middle\"}\n      fontSize={config.infoSubtitleFontSize}\n      transform={\"translate(\" + config.pageWidth / 2 + \",\" + y + \")\"}\n    >\n      {info.subtitle}\n    </text>\n  );\n  let y1 = y;\n  let x = info.author.length;\n  let author = (\n    <g className={clazz + \"__info-author\"}>\n      {info.author.map((it, idx) => {\n        y1 += config.infoFontSize + config.infoGap;\n        if (idx < x - 2) {\n          y += config.infoFontSize + config.infoGap;\n        }\n        return (\n          <text\n            key={idx}\n            fontFamily={config.textFontFamily}\n            width={config.pageWidth}\n            fontSize={config.infoFontSize}\n            textAnchor={\"end\"}\n            x={0}\n            transform={\n              \"translate(\" +\n              (config.pageWidth - config.pageMarginHorizontal) +\n              \",\" +\n              y1 +\n              \")\"\n            }\n          >\n            {it}\n          </text>\n        );\n      })}\n    </g>\n  );\n  let y2 = y + (config.infoGap + config.infoSubtitleFontSize);\n  let y3 = y2 + (config.infoGap + config.infoFontSize);\n  let rythimic = (\n    <g className={clazz + \"__info-rythmic\"} width={config.pageWidth}>\n      <text\n        fontFamily={config.textFontFamily}\n        width={config.pageWidth}\n        fontSize={config.infoFontSize}\n        transform={\"translate(\" + config.pageMarginHorizontal + \",\" + y2 + \")\"}\n      >\n        {info.speed}\n      </text>\n      <text\n        fontFamily={config.textFontFamily}\n        width={config.pageWidth}\n        fontSize={config.infoFontSize}\n        transform={\"translate(\" + config.pageMarginHorizontal + \",\" + y3 + \")\"}\n      >\n        {`1=${info.C} ${info.rhythmic}`}\n      </text>\n    </g>\n  );\n  return (\n    <g className={clazz + \"__info\"} width={config.pageWidth}>\n      {title}\n      {subtitle}\n      {author}\n      {rythimic}\n    </g>\n  );\n};\n\n@observer\nclass MuseNotation extends React.Component<{ notation: Notation }, {}> {\n  render() {\n    let margin = 10;\n    let clazz = \"muse-notation\";\n    return (\n      <svg\n        className=\"muse\"\n        width={this.props.notation.width + margin * 2}\n        height={this.props.notation.height + margin * 2}\n      >\n        <g\n          className={clazz}\n          transform={\"translate(\" + margin + \",\" + margin + \")\"}\n          width={this.props.notation.width}\n          height={this.props.notation.height}\n        >\n          <MuseNotationInfo\n            info={this.props.notation.info}\n            config={this.props.notation.config}\n            clazz={clazz}\n          />\n          <Border\n            w={this.props.notation.width}\n            h={this.props.notation.height}\n            x={0}\n            y={0}\n            clazz={clazz}\n          />\n          {this.props.notation.pages.map((it, idx) => (\n            <MusePage key={idx} page={it} />\n          ))}\n        </g>\n      </svg>\n    );\n  }\n}\n\nexport default MuseNotation;\n","import React from \"react\";\nimport MuseConfig from \"./MuseConfig\";\nimport MuseNotation, { INotation, Notation } from \"./MuseNotation\";\n\nfunction Muse(props: { data: string; config?: MuseConfig }) {\n  let n: INotation = JSON.parse(props.data);\n  let notation = new Notation(\n    n,\n    props.config ? props.config : new MuseConfig()\n  );\n  return (\n    <div>\n      <MuseNotation notation={notation} />\n      <button\n        onClick={() => {\n          console.log(notation.code());\n        }}\n      >\n        log\n      </button>\n    </div>\n  );\n}\n\nexport default Muse;\n","import React from \"react\";\nimport \"./App.css\";\nimport Muse from \"./muse/Muse\";\n\nclass App extends React.Component<\n  {},\n  {\n    error: any | null;\n    isLoaded: boolean;\n    data: string;\n  }\n> {\n  constructor(props: {}) {\n    super(props);\n    this.state = {\n      error: null,\n      isLoaded: false,\n      data: \"\",\n    };\n  }\n\n  componentDidMount() {\n    let url = \"https://cdn.jsdelivr.net/gh/shizuku/muse-react/test/data/b.json\";\n    // let url = \"http://localhost:8888/b.json\";\n    fetch(url)\n      .then((res) => res.text())\n      .then(\n        (result) => {\n          this.setState({\n            isLoaded: true,\n            data: result,\n          });\n        },\n        (error) => {\n          this.setState({\n            isLoaded: true,\n            error: error,\n          });\n        }\n      );\n  }\n\n  render() {\n    return (\n      <div className=\"app\">\n        <h1>Example</h1>\n        {this.state.isLoaded ? (\n          this.state.error ? (\n            \"error\"\n          ) : (\n            <Muse data={this.state.data} />\n          )\n        ) : (\n          \"loading...\"\n        )}\n      </div>\n    );\n  }\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}