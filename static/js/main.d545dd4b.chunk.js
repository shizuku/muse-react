(this["webpackJsonpmuse-react"]=this["webpackJsonpmuse-react"]||[]).push([[0],{21:function(t,e,i){t.exports=i(29)},26:function(t,e,i){},27:function(t,e,i){},29:function(t,e,i){"use strict";i.r(e);var o=i(0),n=i.n(o),r=i(18),a=i.n(r),s=(i(26),i(5)),p=i(3),c=i(7),h=i(6),u=(i(27),function t(){Object(s.a)(this,t),this.noteHeight=22,this.noteWidth=11,this.noteFontSize=22,this.noteFontFamily="serif",this.sigFontSize=14,this.trackGap=10,this.lineGap=40,this.pointGap=5,this.tailPointGap=8,this.pointRound=1.5,this.pageE=1.414,this.pageWidth=1e3,this.pageMarginHorizontal=100,this.pageMarginVertical=110,this.infoTitleFontSize=34,this.infoSubtitleFontSize=22,this.infoGap=7,this.infoFontSize=20,this.pageIndexFontSize=20,this.textFontFamily="serif",this.showBorder=!1}),l=i(4),f=i(2),g=(i(9),i(10)),b=i(15),y=function(t){var e=t.w,i=t.h,o=t.x,r=t.y,a=t.clazz,s=t.show,p=void 0!==s&&s,c=t.color,h=void 0===c?"blue":c;return p?n.a.createElement("rect",{className:a+"__border",transform:"translate("+o+","+r+")",width:e,height:i,stroke:h,strokeWidth:"0.4",fill:"none"}):n.a.createElement(n.a.Fragment,null)},d=function(t){var e=t.w,i=t.h,o=t.clazz,r=t.show,a=void 0!==r&&r,s=t.color,p=void 0===s?"gray":s;return a?n.a.createElement("rect",{className:o+"__outer-border",transform:"translate(0,0)",width:e,height:i,stroke:p,strokeWidth:"0.4",fill:"none"}):n.a.createElement(n.a.Fragment,null)},m=function(){function t(){Object(s.a)(this,t),this.u=0,this.d=1}return Object(p.a)(t,[{key:"parse",value:function(t){var e=t.search("/");return-1!==e?(this.u=parseInt(t.substr(0,e)),this.d=parseInt(t.substr(e+1))):this.u=parseInt(t),this}},{key:"init",value:function(t,e){return this.u=t,this.d=e,this}},{key:"gcd",value:function(t,e){for(;0!==e;){var i=e;e=t%e,t=i}return t}},{key:"simplify",value:function(){for(var t;(t=this.gcd(this.u,this.d))>1||t<-1;)this.u/=t,this.d/=t;return this}},{key:"plus",value:function(e){var i=new t;return i.u=this.u*e.d+this.d*e.u,i.d=this.d*e.d,i.simplify()}},{key:"minus",value:function(e){var i=new t;return i.u=this.u*e.d-this.d*e.u,i.d=this.d*e.d,i.simplify()}},{key:"multiply",value:function(e){var i=new t;return i.u=this.u*e.u,i.d=this.d*e.d,i.simplify()}},{key:"divide",value:function(e){var i=new t;return i.u=this.u*e.d,i.d=this.d*e.u,i.simplify()}},{key:"toNumber",value:function(){return this.u/this.d}},{key:"toString",value:function(){return 1===this.d?"".concat(this.u):"".concat(this.u,"/").concat(this.d)}}]),t}(),O=i(1),j=i(8),w=function(){function t(){var e=this;Object(s.a)(this,t),this.subnote=null,this.note=null,document.addEventListener("keydown",(function(t){if(console.log(t),null!==e.subnote){if(t.key>="0"&&t.key<="9"||"-"===t.key)e.subnote.setNum(t.key);else if("r"===t.key)e.subnote.reducePoint(1);else if("f"===t.key)e.subnote.reducePoint(-1);else if("q"===t.key)e.subnote.reduceLine(-1);else if("a"===t.key)e.subnote.reduceLine(1);else if("s"===t.key)e.subnote.reduceTailPoint(-1);else if("d"===t.key)e.subnote.reduceTailPoint(1);else if("Enter"===t.key){var i;e.subnote.setSelect(!1),e.subnote=null,null===(i=e.note)||void 0===i||i.setSelect(!0)}else if("Backspace"===t.key){var o,n;null===(o=e.note)||void 0===o||o.removeSubNote(e.subnote.getIndex()),null===(n=e.note)||void 0===n||n.setSelect(!0),e.subnote.setSelect(!1),e.subnote=null}}else null!==e.note&&("q"===t.key?e.note.reduceLine(-1):"a"===t.key?e.note.reduceLine(1):"s"===t.key?e.note.reduceTailPoint(-1):"d"===t.key?e.note.reduceTailPoint(1):" "===t.key?e.note.addSubNote("0"):"ArowUp"===t.key||t.key)}))}return Object(p.a)(t,[{key:"selectNote",value:function(t){var e;null===(e=this.note)||void 0===e||e.setSelect(!1),this.note=t,null===this.subnote&&this.note.setSelect(!0)}},{key:"selectSubNote",value:function(t){var e,i;null===(e=this.subnote)||void 0===e||e.setSelect(!1),null===(i=this.note)||void 0===i||i.setSelect(!1),this.subnote=t,this.subnote.setSelect(!0)}}]),t}();w.instance=new w;var v,k,x,z,S,E,N,P,M,F,D,W,B,H,T,G=w,_=(v=function t(e,i,o,n,r,a){var p=this;Object(s.a)(this,t),Object(l.a)(this,"isSelect",k,this),this.note=void 0,this.index=void 0,this.config=void 0,Object(l.a)(this,"x",x,this),Object(l.a)(this,"n",z,this),Object(l.a)(this,"t",S,this),this.selection={setSelect:function(t){p.isSelect=t},setNum:function(t){p.n=t},reducePoint:function(t){p.t+=t},reduceLine:function(t){p.note.l+=t,p.note.l<0&&(p.note.l=0)},reduceTailPoint:function(t){p.note.p+=t,p.note.p<0&&(p.note.p=0)},getIndex:function(){return p.index}},this.x=e,this.n=i,this.t=o,this.note=n,this.index=r,this.config=a},k=Object(f.a)(v.prototype,"isSelect",[O.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),x=Object(f.a)(v.prototype,"x",[O.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),z=Object(f.a)(v.prototype,"n",[O.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),S=Object(f.a)(v.prototype,"t",[O.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),v),C=(E=function(){function t(e,i,o){var n=this;Object(s.a)(this,t),this.config=void 0,Object(l.a)(this,"index",N,this),Object(l.a)(this,"bar",P,this),Object(l.a)(this,"subNotes",M,this),Object(l.a)(this,"l",F,this),Object(l.a)(this,"p",D,this),Object(l.a)(this,"d",W,this),Object(l.a)(this,"isSelect",B,this),this.selection={setSelect:function(t){n.isSelect=t},reduceLine:function(t){n.l+=t,n.l<0&&(n.l=0)},reduceTailPoint:function(t){n.p+=t,n.p<0&&(n.p=0)},addSubNote:function(t){n.subNotes.push(new _("",t,0,n,n.subNotes.length,n.config)),G.instance.selectSubNote(n.subNotes[n.subNotes.length-1].selection)},removeSubNote:function(t){n.subNotes=n.subNotes.filter((function(e){return e.index!==t}))}},this.config=i.config,this.bar=i,this.index=o,this.decode(e)}return Object(p.a)(t,[{key:"dx",get:function(){var t=!1;return this.subNotes.forEach((function(e){""!==e.x&&(t=!0)})),t?this.config.sigFontSize/2:0}},{key:"time",get:function(){var t=new m;return t.u=1,t.d*=Math.pow(2,this.l),t.d*=this.d,t.d*=Math.pow(2,this.p),t.u*=Math.pow(2,this.p+1)-1,t.simplify()}},{key:"notesY",get:function(){var t=this,e=[],i=0;return this.subNotes.forEach((function(o,n){if(o.t<0&&0!==n)for(var r=-o.t;r>0;--r){var a=t.config.pointGap;i+=a}e.push(i);var s=t.config.noteHeight;if(i+=s,o.t>0)for(var p=o.t;p>0;--p){var c=t.config.pointGap;i+=c}})),e}},{key:"pointsY",get:function(){var t=this,e=[],i=0,o=0,n=0;return n+=this.l*this.config.pointGap,this.subNotes.forEach((function(r,a){if(r.t<0){if(0===a)for(var s=-r.t;s>0;--s){var p=t.config.pointGap;n+=p/2,e.push(-n),n+=p/2}if(0!==a)for(var c=-r.t;c>0;--c){var h=t.config.pointGap;i+=h/2,e.push(i),i+=h/2,o+=h}}t.notesY.push(o);var u=t.config.noteHeight;if(o+=u,i+=u,r.t>0)for(var l=r.t;l>0;--l){var f=t.config.pointGap;i+=f/2,e.push(i),i+=f/2,o+=f}})),e}},{key:"tailPointsX",get:function(){for(var t=[],e=0;e<this.p;++e)t.push(this.dx+this.config.noteWidth+(e+.5)*this.config.tailPointGap);return t}},{key:"width",get:function(){return this.dx+this.config.noteWidth+this.p*this.config.tailPointGap}},{key:"preHeight",get:function(){var t=this,e=0;return this.subNotes.forEach((function(i,o){if(i.t<0&&0!==o)for(var n=-i.t;n>0;--n){var r=t.config.pointGap;e+=r}if(e+=t.config.noteHeight,i.t>0)for(var a=i.t;a>0;--a){var s=t.config.pointGap;e+=s}})),e}},{key:"height",get:function(){return this.bar.notesMaxHeight}},{key:"x",get:function(){return this.bar.notesX[this.index]}},{key:"preMarginBottom",get:function(){var t=this,e=0;return e+=this.l*this.config.pointGap,this.subNotes.forEach((function(i,o){if(i.t<0&&0===o)for(var n=-i.t;n>0;--n){var r=t.config.pointGap;e+=r}})),e}},{key:"marginBottom",get:function(){return this.bar.notesMaxMarginBottom}}]),Object(p.a)(t,[{key:"decode",value:function(t){var e=this;if(void 0!==t.n){var i=t.n,o=i.search("@"),n="",r="";-1===o?(n=i,r="0|0"):(n=i.substr(0,o),r=i.substr(o+1)),n.split("|").forEach((function(t,i){for(var o=0;o<t.length;++o)if(t.charCodeAt(o)<=57&&t.charCodeAt(o)>=48||45===t.charCodeAt(o)){var n=t.substr(0,o),r=t.charAt(o),a=t.substr(o+1).length;0!==a&&"-"===t.charAt(o+1)&&(a=-a),e.subNotes.push(new _(n,r,a,e,i,e.config));break}}));var a=r.split("|");3===a.length?(this.l=parseInt(a[0]),this.p=parseInt(a[1]),this.d=parseInt(a[2])):2===a.length?(this.l=parseInt(a[0]),this.p=parseInt(a[1]),this.d=1):1===a.length?(this.l=parseInt(a[0]),this.p=0,this.d=1):(this.l=0,this.p=0,this.d=1)}}},{key:"code",value:function(){var t=this,e="";return this.subNotes.forEach((function(i,o){var n="";if(i.t>0)for(var r=0;r<i.t;++r)n+="+";else for(var a=0;a<-i.t;++a)n+="-";o+1>=t.subNotes.length?e+="".concat(i.x).concat(i.n).concat(n):e+="".concat(i.x).concat(i.n).concat(n,"|")})),{n:"".concat(e,"@").concat(this.l,"|").concat(this.p)}}}]),t}(),N=Object(f.a)(E.prototype,"index",[O.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),P=Object(f.a)(E.prototype,"bar",[O.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),M=Object(f.a)(E.prototype,"subNotes",[O.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),F=Object(f.a)(E.prototype,"l",[O.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),D=Object(f.a)(E.prototype,"p",[O.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),W=Object(f.a)(E.prototype,"d",[O.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Object(f.a)(E.prototype,"dx",[O.f],Object.getOwnPropertyDescriptor(E.prototype,"dx"),E.prototype),Object(f.a)(E.prototype,"time",[O.f],Object.getOwnPropertyDescriptor(E.prototype,"time"),E.prototype),Object(f.a)(E.prototype,"notesY",[O.f],Object.getOwnPropertyDescriptor(E.prototype,"notesY"),E.prototype),Object(f.a)(E.prototype,"pointsY",[O.f],Object.getOwnPropertyDescriptor(E.prototype,"pointsY"),E.prototype),Object(f.a)(E.prototype,"tailPointsX",[O.f],Object.getOwnPropertyDescriptor(E.prototype,"tailPointsX"),E.prototype),Object(f.a)(E.prototype,"width",[O.f],Object.getOwnPropertyDescriptor(E.prototype,"width"),E.prototype),Object(f.a)(E.prototype,"preHeight",[O.f],Object.getOwnPropertyDescriptor(E.prototype,"preHeight"),E.prototype),Object(f.a)(E.prototype,"height",[O.f],Object.getOwnPropertyDescriptor(E.prototype,"height"),E.prototype),Object(f.a)(E.prototype,"x",[O.f],Object.getOwnPropertyDescriptor(E.prototype,"x"),E.prototype),Object(f.a)(E.prototype,"preMarginBottom",[O.f],Object.getOwnPropertyDescriptor(E.prototype,"preMarginBottom"),E.prototype),Object(f.a)(E.prototype,"marginBottom",[O.f],Object.getOwnPropertyDescriptor(E.prototype,"marginBottom"),E.prototype),B=Object(f.a)(E.prototype,"isSelect",[O.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),E);var L,Y,I,X,A,R,V,J,q,U,$,K,Q,Z,tt,et,it,ot,nt,rt,at,st,pt,ct,ht=Object(j.a)(H=function(t){Object(c.a)(i,t);var e=Object(h.a)(i);function i(){return Object(s.a)(this,i),e.apply(this,arguments)}return Object(p.a)(i,[{key:"render",value:function(){var t=this;return n.a.createElement("g",{className:"muse-note__subnote",transform:"translate(0,"+this.props.y+")",width:this.props.w,height:this.props.h,onClick:function(){G.instance.selectSubNote(t.props.subNote.selection)}},n.a.createElement("text",{fontFamily:this.props.subNote.config.noteFontFamily,fontSize:this.props.subNote.config.noteFontSize,transform:"translate("+this.props.dx+",0)"},this.props.subNote.n),n.a.createElement("text",{fontFamily:this.props.subNote.config.noteFontFamily,fontSize:this.props.subNote.config.sigFontSize,transform:"translate(0,"+(this.props.subNote.config.sigFontSize-this.props.subNote.config.noteHeight)+")"},{S:"#",F:"b",DS:"x",DF:"d",N:"n"}[this.props.subNote.x]||""),n.a.createElement(y,{x:0,y:-this.props.h,w:this.props.w,h:this.props.subNote.config.noteFontSize,clazz:"muse-note__subnote",show:this.props.subNote.isSelect}))}}]),i}(n.a.Component))||H,ut=Object(j.a)(T=function(t){Object(c.a)(i,t);var e=Object(h.a)(i);function i(){return Object(s.a)(this,i),e.apply(this,arguments)}return Object(p.a)(i,[{key:"render",value:function(){var t=this,e="muse-note";return n.a.createElement("g",{className:e,transform:"translate("+this.props.note.x+",0)",width:this.props.note.width,height:this.props.note.height,onClick:function(){G.instance.selectNote(t.props.note.selection)}},n.a.createElement(d,{w:this.props.note.width,h:this.props.note.height+this.props.note.marginBottom,clazz:e,show:this.props.note.isSelect,color:"blue"}),this.props.note.subNotes.map((function(e,i){return n.a.createElement(ht,{key:i,dx:t.props.note.dx,y:t.props.note.height-t.props.note.notesY[i],w:t.props.note.width,h:22,subNote:e})})),function(t,e){return n.a.createElement("g",{className:e+"__group-point"},t.pointsY.map((function(e,i){return n.a.createElement("circle",{key:i,r:t.config.pointRound,fill:"black",transform:"translate("+(t.dx+t.config.noteWidth/2)+","+(t.height-e+t.config.pointGap/2)+")"})})))}(this.props.note,e),function(t,e){return n.a.createElement("g",{className:e+"__tail-point"},t.tailPointsX.map((function(e,i){return n.a.createElement("circle",{key:i,r:t.config.pointRound,fill:"black",transform:"translate("+e+","+(t.height-t.config.noteHeight/3)+")"})})))}(this.props.note,e))}}]),i}(n.a.Component))||T,lt=i(14),ft=(L=function(){function t(e,i,o,n){Object(s.a)(this,t),this.config=void 0,this.index=void 0,Object(l.a)(this,"track",Y,this),Object(l.a)(this,"notes",I,this),this.index=i,this.track=o,this.config=n,this.decode(e)}return Object(p.a)(t,[{key:"width",get:function(){return this.track.barsWidth[this.index]}},{key:"height",get:function(){var t=0;return this.notes.forEach((function(e){var i=e.height+e.marginBottom;t=i>t?i:t})),t}},{key:"x",get:function(){return this.track.barsX[this.index]}},{key:"y",get:function(){return 0}},{key:"notesTime",get:function(){return this.notes.map((function(t){return t.time}))}},{key:"notesTimeSum",get:function(){return this.notesTime.reduce((function(t,e){return t.plus(e)}),new m).plus((new m).init(1,1))}},{key:"notesWidth",get:function(){return this.notes.map((function(t){return t.width}))}},{key:"notesX",get:function(){var t=this,e=this.width-this.notesWidthSum,i=(new m).init(e,1).divide(this.notesTimeSum),o=i.toNumber();return this.notesWidth.map((function(e,n){var r=o;return o+=e+t.notesTime[n].multiply(i).toNumber(),r}))}},{key:"preNotesMaxHeight",get:function(){return Math.max.apply(Math,Object(g.a)(this.notes.map((function(t){return t.preHeight}))))}},{key:"notesMaxHeight",get:function(){return this.track.notesMaxHeight}},{key:"preNotesMaxMarginBottom",get:function(){return Math.max.apply(Math,Object(g.a)(this.notes.map((function(t){return t.preMarginBottom}))))}},{key:"notesMaxMarginBottom",get:function(){return this.track.notesMaxMarginBottom}},{key:"baselineGroup",get:function(){for(var t=this,e=[],i=function(i){var o=0,n=0,r=-1;if(t.notes.forEach((function(t,a){t.l>i?(r=a,o++):(n<=r&&e.push({y:i,s:n,e:r}),n=a+1,r=a)})),n<=r&&e.push({y:i,s:n,e:r}),0===o)return"break"},o=0;;++o){if("break"===i(o))break}return e}},{key:"notesWidthSum",get:function(){var t=0;return this.notes.forEach((function(e){return t+=e.width})),t}}]),Object(p.a)(t,[{key:"decode",value:function(t){var e=this;void 0!==t.notes&&t.notes.forEach((function(t,i){e.notes.push(new C(t,e,i))}))}},{key:"code",value:function(){return{notes:this.notes.map((function(t){return t.code()}))}}}]),t}(),Y=Object(f.a)(L.prototype,"track",[O.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),I=Object(f.a)(L.prototype,"notes",[O.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Object(f.a)(L.prototype,"width",[O.f],Object.getOwnPropertyDescriptor(L.prototype,"width"),L.prototype),Object(f.a)(L.prototype,"height",[O.f],Object.getOwnPropertyDescriptor(L.prototype,"height"),L.prototype),Object(f.a)(L.prototype,"x",[O.f],Object.getOwnPropertyDescriptor(L.prototype,"x"),L.prototype),Object(f.a)(L.prototype,"y",[O.f],Object.getOwnPropertyDescriptor(L.prototype,"y"),L.prototype),Object(f.a)(L.prototype,"notesTime",[O.f],Object.getOwnPropertyDescriptor(L.prototype,"notesTime"),L.prototype),Object(f.a)(L.prototype,"notesTimeSum",[O.f],Object.getOwnPropertyDescriptor(L.prototype,"notesTimeSum"),L.prototype),Object(f.a)(L.prototype,"notesWidth",[O.f],Object.getOwnPropertyDescriptor(L.prototype,"notesWidth"),L.prototype),Object(f.a)(L.prototype,"notesX",[O.f],Object.getOwnPropertyDescriptor(L.prototype,"notesX"),L.prototype),Object(f.a)(L.prototype,"preNotesMaxHeight",[O.f],Object.getOwnPropertyDescriptor(L.prototype,"preNotesMaxHeight"),L.prototype),Object(f.a)(L.prototype,"notesMaxHeight",[O.f],Object.getOwnPropertyDescriptor(L.prototype,"notesMaxHeight"),L.prototype),Object(f.a)(L.prototype,"preNotesMaxMarginBottom",[O.f],Object.getOwnPropertyDescriptor(L.prototype,"preNotesMaxMarginBottom"),L.prototype),Object(f.a)(L.prototype,"notesMaxMarginBottom",[O.f],Object.getOwnPropertyDescriptor(L.prototype,"notesMaxMarginBottom"),L.prototype),Object(f.a)(L.prototype,"baselineGroup",[O.f],Object.getOwnPropertyDescriptor(L.prototype,"baselineGroup"),L.prototype),Object(f.a)(L.prototype,"notesWidthSum",[O.f],Object.getOwnPropertyDescriptor(L.prototype,"notesWidthSum"),L.prototype),L),gt=function(t){var e=Object(lt.a)((function(){return[t.w,t.h]})),i=Object(b.a)(e,2),o=i[0],r=i[1];return n.a.createElement("line",{className:t.clazz+"__bar-line",x1:o,y1:0,x2:o,y2:r,strokeWidth:1,stroke:"black"})},bt=function(t){var e=t.bar,i=t.clazz,o=Object(lt.a)((function(){return[e.baselineGroup,e.notes]})),r=Object(b.a)(o,2),a=r[0],s=r[1];return n.a.createElement("g",{className:i+"__base-line"},a.map((function(t,i){return n.a.createElement("line",{key:i,x1:s[t.s].x,y1:s[t.s].height+(t.y+1)*e.config.pointGap,x2:s[t.e].x+e.notes[t.e].width,y2:s[t.s].height+(t.y+1)*e.config.pointGap,stroke:"black",strokeWidth:1})})))},yt=Object(j.a)(X=function(t){Object(c.a)(i,t);var e=Object(h.a)(i);function i(){return Object(s.a)(this,i),e.apply(this,arguments)}return Object(p.a)(i,[{key:"render",value:function(){var t=this.props.bar.notes,e="muse-bar";return n.a.createElement("g",{className:e,transform:"translate("+this.props.bar.x+","+this.props.bar.y+")",width:this.props.bar.width,height:this.props.bar.height},n.a.createElement(y,{w:this.props.bar.width,h:this.props.bar.height,x:0,y:0,clazz:e,show:this.props.bar.config.showBorder}),n.a.createElement(gt,{w:this.props.bar.width,h:this.props.bar.height,clazz:e}),t.map((function(t,e){return n.a.createElement(ut,{key:e,note:t})})),n.a.createElement(bt,{bar:this.props.bar,clazz:e}))}}]),i}(n.a.Component))||X,dt=(A=function(){function t(e,i,o,n){Object(s.a)(this,t),this.config=void 0,this.index=void 0,this.line=void 0,Object(l.a)(this,"bars",R,this),this.index=i,this.line=o,this.config=n,this.decode(e)}return Object(p.a)(t,[{key:"width",get:function(){return this.line.width}},{key:"height",get:function(){var t=0;return this.bars.forEach((function(e){t=e.height>t?e.height:t})),t}},{key:"x",get:function(){return 0}},{key:"y",get:function(){return this.line.tracksY[this.index]}},{key:"barsTime",get:function(){return this.bars.map((function(t){return t.notesTimeSum}))}},{key:"barsWidth",get:function(){var t=this,e=this.barsTime.reduce((function(t,e){return t.plus(e)}),new m),i=this.width-this.notesWidthSum,o=(new m).init(i,1).divide(e);return this.barsNotesWidth.map((function(e,i){return e+t.barsTime[i].multiply(o).toNumber()}))}},{key:"barsX",get:function(){var t=0;return this.barsWidth.map((function(e){var i=t;return t+=e,i}))}},{key:"notesMaxHeight",get:function(){return Math.max.apply(Math,Object(g.a)(this.bars.map((function(t){return t.preNotesMaxHeight}))))}},{key:"notesMaxMarginBottom",get:function(){return Math.max.apply(Math,Object(g.a)(this.bars.map((function(t){return t.preNotesMaxMarginBottom}))))}},{key:"notesWidthSum",get:function(){return this.barsNotesWidth.reduce((function(t,e){return t+e}),0)}},{key:"barsNotesWidth",get:function(){return this.bars.map((function(t){return t.notesWidthSum}))}}]),Object(p.a)(t,[{key:"decode",value:function(t){var e=this;void 0!==t.bars&&t.bars.forEach((function(t,i){e.bars.push(new ft(t,i,e,e.config))}))}},{key:"code",value:function(){return{bars:this.bars.map((function(t){return t.code()}))}}}]),t}(),R=Object(f.a)(A.prototype,"bars",[O.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Object(f.a)(A.prototype,"width",[O.f],Object.getOwnPropertyDescriptor(A.prototype,"width"),A.prototype),Object(f.a)(A.prototype,"height",[O.f],Object.getOwnPropertyDescriptor(A.prototype,"height"),A.prototype),Object(f.a)(A.prototype,"x",[O.f],Object.getOwnPropertyDescriptor(A.prototype,"x"),A.prototype),Object(f.a)(A.prototype,"y",[O.f],Object.getOwnPropertyDescriptor(A.prototype,"y"),A.prototype),Object(f.a)(A.prototype,"barsTime",[O.f],Object.getOwnPropertyDescriptor(A.prototype,"barsTime"),A.prototype),Object(f.a)(A.prototype,"barsWidth",[O.f],Object.getOwnPropertyDescriptor(A.prototype,"barsWidth"),A.prototype),Object(f.a)(A.prototype,"barsX",[O.f],Object.getOwnPropertyDescriptor(A.prototype,"barsX"),A.prototype),Object(f.a)(A.prototype,"notesMaxHeight",[O.f],Object.getOwnPropertyDescriptor(A.prototype,"notesMaxHeight"),A.prototype),Object(f.a)(A.prototype,"notesMaxMarginBottom",[O.f],Object.getOwnPropertyDescriptor(A.prototype,"notesMaxMarginBottom"),A.prototype),Object(f.a)(A.prototype,"notesWidthSum",[O.f],Object.getOwnPropertyDescriptor(A.prototype,"notesWidthSum"),A.prototype),Object(f.a)(A.prototype,"barsNotesWidth",[O.f],Object.getOwnPropertyDescriptor(A.prototype,"barsNotesWidth"),A.prototype),A),mt=Object(j.a)(V=function(t){Object(c.a)(i,t);var e=Object(h.a)(i);function i(){return Object(s.a)(this,i),e.apply(this,arguments)}return Object(p.a)(i,[{key:"render",value:function(){return n.a.createElement("g",{className:"muse-track",transform:"translate("+this.props.track.x+","+this.props.track.y+")",width:this.props.track.width,height:this.props.track.height},n.a.createElement(y,{w:this.props.track.width,h:this.props.track.height,x:0,y:0,clazz:"muse-track",show:this.props.track.config.showBorder}),this.props.track.bars.map((function(t,e){return n.a.createElement(yt,{key:e,bar:t})})))}}]),i}(n.a.Component))||V,Ot=(J=function(){function t(e,i,o,n){Object(s.a)(this,t),this.page=void 0,this.index=void 0,this.config=void 0,Object(l.a)(this,"tracks",q,this),this.page=o,this.index=i,this.config=n,this.decode(e)}return Object(p.a)(t,[{key:"width",get:function(){return this.page.width}},{key:"height",get:function(){var t=this,e=0;return this.tracks.forEach((function(i){e+=i.height+t.config.trackGap})),e-=this.config.trackGap}},{key:"x",get:function(){return this.page.x}},{key:"y",get:function(){return this.page.linesY[this.index]}},{key:"tracksY",get:function(){var t=this,e=0;return this.tracks.map((function(i){var o=e;return e+=i.height+t.config.trackGap,o}))}}]),Object(p.a)(t,[{key:"decode",value:function(t){var e=this;void 0!==t.tracks&&t.tracks.forEach((function(t,i){e.tracks.push(new dt(t,i,e,e.config))}))}},{key:"code",value:function(){return{tracks:this.tracks.map((function(t){return t.code()}))}}}]),t}(),q=Object(f.a)(J.prototype,"tracks",[O.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Object(f.a)(J.prototype,"width",[O.f],Object.getOwnPropertyDescriptor(J.prototype,"width"),J.prototype),Object(f.a)(J.prototype,"height",[O.f],Object.getOwnPropertyDescriptor(J.prototype,"height"),J.prototype),Object(f.a)(J.prototype,"x",[O.f],Object.getOwnPropertyDescriptor(J.prototype,"x"),J.prototype),Object(f.a)(J.prototype,"y",[O.f],Object.getOwnPropertyDescriptor(J.prototype,"y"),J.prototype),Object(f.a)(J.prototype,"tracksY",[O.f],Object.getOwnPropertyDescriptor(J.prototype,"tracksY"),J.prototype),J),jt=function(t){var e=t.height,i=t.clazz;return n.a.createElement("g",{className:i+"__line-head"},n.a.createElement("line",{x1:0,y1:0,x2:0,y2:e,strokeWidth:1,stroke:"black"}))},wt=Object(j.a)(U=function(t){Object(c.a)(i,t);var e=Object(h.a)(i);function i(){return Object(s.a)(this,i),e.apply(this,arguments)}return Object(p.a)(i,[{key:"render",value:function(){return n.a.createElement("g",{className:"muse-line",transform:"translate("+this.props.line.x+","+this.props.line.y+")",width:this.props.line.width,height:this.props.line.height},n.a.createElement(y,{w:this.props.line.width,h:this.props.line.height,x:0,y:0,clazz:"muse-line",show:this.props.line.config.showBorder}),n.a.createElement(jt,{height:this.props.line.height,clazz:"muse-line"}),this.props.line.tracks.map((function(t,e){return n.a.createElement(mt,{key:e,track:t})})))}}]),i}(n.a.Component))||U,vt=($=function(){function t(e,i,o,n){Object(s.a)(this,t),this.notation=void 0,this.config=void 0,this.index=void 0,Object(l.a)(this,"lines",K,this),this.index=i,this.notation=o,this.config=n,this.decode(e)}return Object(p.a)(t,[{key:"width",get:function(){return this.config.pageWidth-2*this.config.pageMarginHorizontal}},{key:"height",get:function(){return this.config.pageWidth*this.config.pageE-2*this.config.pageMarginVertical}},{key:"x",get:function(){return this.config.pageMarginHorizontal}},{key:"y",get:function(){return this.marginTop+this.index*this.height}},{key:"marginTop",get:function(){var t=0;if(0===this.index){t+=this.config.pageMarginVertical;var e=this.config.infoGap;t+=this.config.infoTitleFontSize+e,t+=this.config.infoSubtitleFontSize+e,this.notation.info.author.length>2?t+=this.notation.info.author.length*(this.config.infoFontSize+e):t+=2*(this.config.infoFontSize+e)}else t=this.config.pageMarginVertical;return t}},{key:"marginBottom",get:function(){return this.config.pageMarginVertical}},{key:"marginLeft",get:function(){return this.config.pageMarginHorizontal}},{key:"marginRight",get:function(){return this.config.pageMarginHorizontal}},{key:"linesHeight",get:function(){return this.lines.map((function(t){return t.height}))}},{key:"linesY",get:function(){var t=this.marginTop,e=this.linesHeight.reduce((function(t,e){return t+e}),0),i=(this.height-e)/(this.lines.length-1);return this.linesHeight.map((function(e){var o=t;return t+=e+i,o}))}}]),Object(p.a)(t,[{key:"decode",value:function(t){var e=this;void 0!==t.lines&&t.lines.forEach((function(t,i){e.lines.push(new Ot(t,i,e,e.config))}))}},{key:"code",value:function(){return{lines:this.lines.map((function(t){return t.code()}))}}}]),t}(),K=Object(f.a)($.prototype,"lines",[O.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Object(f.a)($.prototype,"width",[O.f],Object.getOwnPropertyDescriptor($.prototype,"width"),$.prototype),Object(f.a)($.prototype,"height",[O.f],Object.getOwnPropertyDescriptor($.prototype,"height"),$.prototype),Object(f.a)($.prototype,"x",[O.f],Object.getOwnPropertyDescriptor($.prototype,"x"),$.prototype),Object(f.a)($.prototype,"y",[O.f],Object.getOwnPropertyDescriptor($.prototype,"y"),$.prototype),Object(f.a)($.prototype,"marginTop",[O.f],Object.getOwnPropertyDescriptor($.prototype,"marginTop"),$.prototype),Object(f.a)($.prototype,"marginBottom",[O.f],Object.getOwnPropertyDescriptor($.prototype,"marginBottom"),$.prototype),Object(f.a)($.prototype,"marginLeft",[O.f],Object.getOwnPropertyDescriptor($.prototype,"marginLeft"),$.prototype),Object(f.a)($.prototype,"marginRight",[O.f],Object.getOwnPropertyDescriptor($.prototype,"marginRight"),$.prototype),Object(f.a)($.prototype,"linesHeight",[O.f],Object.getOwnPropertyDescriptor($.prototype,"linesHeight"),$.prototype),Object(f.a)($.prototype,"linesY",[O.f],Object.getOwnPropertyDescriptor($.prototype,"linesY"),$.prototype),$),kt=function(t){var e=t.index,i=t.x,o=t.y,r=t.clazz,a=t.config;return n.a.createElement("g",{className:r+"__page-index",transform:"translate("+i+","+o+")"},n.a.createElement("text",{textAnchor:"middle",fontFamily:a.textFontFamily,fontSize:a.pageIndexFontSize},(e+1).toString()))},xt=Object(j.a)(Q=function(t){Object(c.a)(i,t);var e=Object(h.a)(i);function i(){return Object(s.a)(this,i),e.apply(this,arguments)}return Object(p.a)(i,[{key:"render",value:function(){var t="muse-page";return n.a.createElement("g",{className:t,transform:"translate("+(this.props.page.x-this.props.page.marginLeft)+","+(this.props.page.y-this.props.page.marginTop)+")",width:this.props.page.width+this.props.page.marginLeft+this.props.page.marginRight,height:this.props.page.height+this.props.page.marginTop+this.props.page.marginBottom},n.a.createElement(y,{w:this.props.page.width,h:this.props.page.height,x:this.props.page.x,y:this.props.page.y,clazz:t,show:this.props.page.config.showBorder}),n.a.createElement(d,{w:this.props.page.width+this.props.page.marginLeft+this.props.page.marginLeft,h:this.props.page.height+this.props.page.marginTop+this.props.page.marginBottom,clazz:t,show:!0}),n.a.createElement(kt,{index:this.props.page.index,x:this.props.page.marginLeft+this.props.page.width/2,y:this.props.page.marginTop+this.props.page.height+this.props.page.marginBottom/2,clazz:t,config:this.props.page.config}),this.props.page.lines.map((function(t,e){return n.a.createElement(wt,{key:e,line:t})})))}}]),i}(n.a.Component))||Q,zt=(Z=function t(){Object(s.a)(this,t),Object(l.a)(this,"title",tt,this),Object(l.a)(this,"subtitle",et,this),Object(l.a)(this,"author",it,this),Object(l.a)(this,"speed",ot,this),Object(l.a)(this,"rhythmic",nt,this),Object(l.a)(this,"C",rt,this)},tt=Object(f.a)(Z.prototype,"title",[O.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),et=Object(f.a)(Z.prototype,"subtitle",[O.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),it=Object(f.a)(Z.prototype,"author",[O.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),ot=Object(f.a)(Z.prototype,"speed",[O.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),nt=Object(f.a)(Z.prototype,"rhythmic",[O.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),rt=Object(f.a)(Z.prototype,"C",[O.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),Z),St=(at=function(){function t(e,i){Object(s.a)(this,t),this.config=void 0,Object(l.a)(this,"pages",st,this),Object(l.a)(this,"info",pt,this),this.config=i,this.decode(e)}return Object(p.a)(t,[{key:"height",get:function(){var t=0;return this.pages.forEach((function(e){return t+=e.height+e.marginTop+e.marginBottom})),t}},{key:"width",get:function(){return this.config.pageWidth}}]),Object(p.a)(t,[{key:"decode",value:function(t){var e=this;void 0!==t.pages&&t.pages.forEach((function(t,i){e.pages.push(new vt(t,i,e,e.config))})),void 0!==t.title&&(this.info.title=t.title),void 0!==t.subtitle&&(this.info.subtitle=t.subtitle),void 0!==t.author&&(this.info.author=t.author.toString().split("|")),void 0!==t.speed&&(this.info.speed=t.speed),t.rhythmic&&(this.info.rhythmic=t.rhythmic),t.C&&(this.info.C=t.C)}},{key:"code",value:function(){var t=this,e=this.pages.map((function(t){return t.code()})),i="";return this.info.author.forEach((function(e,o){o===t.info.author.length-1?i+=e:i+=e+"|"})),{title:this.info.title,subtitle:this.info.subtitle,author:i,rhythmic:this.info.rhythmic,speed:this.info.speed,C:this.info.C,pages:e}}}]),t}(),st=Object(f.a)(at.prototype,"pages",[O.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),pt=Object(f.a)(at.prototype,"info",[O.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new zt}}),Object(f.a)(at.prototype,"height",[O.f],Object.getOwnPropertyDescriptor(at.prototype,"height"),at.prototype),Object(f.a)(at.prototype,"width",[O.f],Object.getOwnPropertyDescriptor(at.prototype,"width"),at.prototype),at),Et=function(t){var e=t.info,i=t.config,o=t.clazz,r=0;r+=i.pageMarginVertical;var a=n.a.createElement("text",{className:o+"__info-title",fontFamily:i.textFontFamily,width:i.pageWidth,textAnchor:"middle",fontSize:i.infoTitleFontSize,transform:"translate("+i.pageWidth/2+","+r+")"},e.title);r+=i.infoTitleFontSize+i.infoGap;var s=n.a.createElement("text",{className:o+"__info-subtitle",fontFamily:i.textFontFamily,width:i.pageWidth,textAnchor:"middle",fontSize:i.infoSubtitleFontSize,transform:"translate("+i.pageWidth/2+","+r+")"},e.subtitle),p=r,c=e.author.length,h=n.a.createElement("g",{className:o+"__info-author"},e.author.map((function(t,e){return p+=i.infoFontSize+i.infoGap,e<c-2&&(r+=i.infoFontSize+i.infoGap),n.a.createElement("text",{key:e,fontFamily:i.textFontFamily,width:i.pageWidth,fontSize:i.infoFontSize,textAnchor:"end",x:0,transform:"translate("+(i.pageWidth-i.pageMarginHorizontal)+","+p+")"},t)}))),u=r+(i.infoGap+i.infoSubtitleFontSize),l=u+(i.infoGap+i.infoFontSize),f=n.a.createElement("g",{className:o+"__info-rythmic",width:i.pageWidth},n.a.createElement("text",{fontFamily:i.textFontFamily,width:i.pageWidth,fontSize:i.infoFontSize,transform:"translate("+i.pageMarginHorizontal+","+u+")"},e.speed),n.a.createElement("text",{fontFamily:i.textFontFamily,width:i.pageWidth,fontSize:i.infoFontSize,transform:"translate("+i.pageMarginHorizontal+","+l+")"},"1=".concat(e.C," ").concat(e.rhythmic)));return n.a.createElement("g",{className:o+"__info",width:i.pageWidth},a,s,h,f)},Nt=Object(j.a)(ct=function(t){Object(c.a)(i,t);var e=Object(h.a)(i);function i(){return Object(s.a)(this,i),e.apply(this,arguments)}return Object(p.a)(i,[{key:"render",value:function(){var t="muse-notation";return n.a.createElement("svg",{className:"muse",width:this.props.notation.width+20,height:this.props.notation.height+20},n.a.createElement("g",{className:t,transform:"translate(10,10)",width:this.props.notation.width,height:this.props.notation.height},n.a.createElement(Et,{info:this.props.notation.info,config:this.props.notation.config,clazz:t}),n.a.createElement(y,{w:this.props.notation.width,h:this.props.notation.height,x:0,y:0,clazz:t}),this.props.notation.pages.map((function(t,e){return n.a.createElement(xt,{key:e,page:t})}))))}}]),i}(n.a.Component))||ct;var Pt=function(t){var e=JSON.parse(t.data),i=new St(e,t.config?t.config:new u);return n.a.createElement("div",null,n.a.createElement(Nt,{notation:i}),n.a.createElement("button",{onClick:function(){console.log(i.code())}},"log"))},Mt=function(t){Object(c.a)(i,t);var e=Object(h.a)(i);function i(t){var o;return Object(s.a)(this,i),(o=e.call(this,t)).state={error:null,isLoaded:!1,data:""},o}return Object(p.a)(i,[{key:"componentDidMount",value:function(){var t=this;fetch("https://cdn.jsdelivr.net/gh/shizuku/muse-react/test/data/b.json").then((function(t){return t.text()})).then((function(e){t.setState({isLoaded:!0,data:e})}),(function(e){t.setState({isLoaded:!0,error:e})}))}},{key:"render",value:function(){return n.a.createElement("div",{className:"app"},n.a.createElement("h1",null,"Example"),this.state.isLoaded?this.state.error?"error":n.a.createElement(Pt,{data:this.state.data}):"loading...")}}]),i}(n.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a.a.render(n.a.createElement(n.a.StrictMode,null,n.a.createElement(Mt,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()})).catch((function(t){console.error(t.message)}))}},[[21,1,2]]]);
//# sourceMappingURL=main.d545dd4b.chunk.js.map