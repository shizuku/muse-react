{"version":3,"sources":["muse/MuseConfig.ts","muse/Dimens.ts","muse/Border.tsx","muse/MuseNote.tsx","muse/MuseBar.tsx","muse/MuseTrack.tsx","muse/MuseLine.tsx","muse/MusePage.tsx","muse/MuseNotation.tsx","muse/Selector.ts","muse/Muse.tsx","App.tsx","serviceWorker.ts","index.tsx"],"names":["MuseConfig","noteHeight","noteWidth","noteFontSize","noteFontFamily","sigFontSize","trackGap","lineGap","pointGap","tailPointGap","pointRound","pageE","notationWidth","pageMarginHorizontal","pageMarginVertical","infoTitleFontSize","infoSubtitleFontSize","infoGap","infoFontSize","pageIndexFontSize","textFontFamily","Dimens","x","y","width","height","marginTop","marginBottom","marginLeft","marginRight","this","marginHorizontal","marginVertical","d","border","clazz","show","color","ifShow","className","transform","stroke","strokeWidth","fill","outerBorder","Note","o","config","noteGroup","l","p","dx","time","notesY","pointsY","tailPointsX","dimens","isSelect","decode","undefined","n","pos","search","ns","ts","substr","split","forEach","it","i","length","charCodeAt","charAt","t","push","tg","parseInt","toString","ny","mb","py","idx","h","MuseNote","props","useState","note","setNote","useEffect","selector","fetchNote","cursor","state","unFetchNote","onClick","map","key","fontFamily","fontSize","S","F","DS","DF","N","r","pointGroup","tailPoint","Bar","notes","unitNum","notesX","baselineGroup","generateBaseline","Math","pow","q","code","s","e","MuseBar","bar","setBar","fetchBar","unFetchBar","x1","y1","x2","y2","barLine","baseLine","Track","bars","MuseTrack","track","setTrack","fetchTrack","unFetchTrack","Line","tracks","MuseLine","line","setLine","fetchLine","unFetchLine","lineHead","Page","lines","index","MusePage","page","setPage","fetchPage","unFetchPage","textAnchor","pageIndex","Notation","json","pages","title","subtitle","author","speed","rhythmic","C","JSON","parse","MuseNotation","notation","setNotation","fetchNotation","unFetchNotation","margin","y3","rythimic","notationInfo","Selector","data","tree","handler","pageIdx","lineIdx","trackIdx","barIdx","Error","Muse","hm","vm","w","notationH","linesHeight","lineYSpace","lineHeight","trackY","barsW","barUnitSum","reduce","trackHeight","maxNoteHeight","maxNoteMarginBottom","barX","notesWidth","settle","noteMarginBootom","lineYUnit","init","App","error","isLoaded","fetch","url","then","res","text","result","setState","React","Component","Boolean","window","location","hostname","match","ReactDOM","render","StrictMode","document","getElementById","navigator","serviceWorker","ready","registration","unregister","catch","console","message"],"mappings":"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","file":"static/js/main.6c83149a.chunk.js","sourcesContent":["export default class MuseConfig {\n  noteHeight = 22;\n  noteWidth = 11;\n  noteFontSize = 22;\n  noteFontFamily = \"serif\";\n  sigFontSize = 14;\n\n  trackGap = 10;\n\n  lineGap = 20;\n\n  pointGap = 5;\n  tailPointGap = 8;\n  pointRound = 1.5;\n\n  pageE = 1.414;\n  notationWidth = 1000;\n  pageMarginHorizontal = 100;\n  pageMarginVertical = 110;\n\n  infoTitleFontSize = 34;\n  infoSubtitleFontSize = 22;\n  infoGap = 7;\n  infoFontSize = 20;\n\n  pageIndexFontSize = 20;\n\n  textFontFamily = \"serif\";\n}\n","export default class Dimens {\n  x: number;\n  y: number;\n  width: number;\n  height: number;\n  marginTop: number;\n  marginBottom: number;\n  marginLeft: number;\n  marginRight: number;\n  constructor() {\n    this.x = 0;\n    this.y = 0;\n    this.width = 0;\n    this.height = 0;\n    this.marginBottom = 0;\n    this.marginTop = 0;\n    this.marginLeft = 0;\n    this.marginRight = 0;\n  }\n  init(\n    x: number,\n    y: number,\n    width: number,\n    height: number,\n    marginHorizontal: number,\n    marginVertical: number\n  ) {\n    this.x = x;\n    this.y = y;\n    this.width = width;\n    this.height = height;\n    this.marginBottom = marginVertical;\n    this.marginTop = marginVertical;\n    this.marginLeft = marginHorizontal;\n    this.marginRight = marginHorizontal;\n  }\n  copyFrom(d: Dimens) {\n    this.x = d.x;\n    this.y = d.y;\n    this.width = d.width;\n    this.height = d.height;\n    this.marginBottom = d.marginBottom;\n    this.marginTop = d.marginTop;\n    this.marginLeft = d.marginLeft;\n    this.marginRight = d.marginRight;\n  }\n}\n","import React from \"react\";\nimport Dimens from \"./Dimens\";\n\nexport function border(\n  d: Dimens,\n  clazz: string,\n  show: boolean = false,\n  color: string = \"blue\"\n) {\n  let ifShow = false;\n  if (show || ifShow) {\n    return (\n      <rect\n        className={clazz + \"__border\"}\n        transform={\"translate(\" + d.marginLeft + \",\" + d.marginTop + \")\"}\n        width={d.width}\n        height={d.height}\n        stroke={color}\n        strokeWidth=\"0.4\"\n        fill=\"none\"\n      />\n    );\n  } else {\n    return <></>;\n  }\n}\n\nexport function outerBorder(\n  d: Dimens,\n  clazz: string,\n  show: boolean = false,\n  color: string = \"gray\"\n) {\n  if (show) {\n    return (\n      <rect\n        className={clazz + \"__outer-border\"}\n        transform={\"translate(0,0)\"}\n        width={d.width + d.marginLeft + d.marginRight}\n        height={d.height + d.marginTop + d.marginBottom}\n        stroke={color}\n        strokeWidth=\"0.4\"\n        fill=\"none\"\n      />\n    );\n  } else {\n    return <></>;\n  }\n}\n","import React, { useEffect, useState } from \"react\";\nimport Dimens from \"./Dimens\";\nimport { outerBorder } from \"./Border\";\nimport MuseConfig from \"./MuseConfig\";\nimport Selector from \"./Selector\";\nimport Codec from \"./Codec\";\nimport Fraction from \"./Fraction\";\n\nexport class Note implements Codec {\n  config: MuseConfig;\n  noteGroup: {\n    x: string;\n    n: string;\n    t: number;\n  }[] = [];\n  l: number = 0;\n  p: number = 0;\n  d: number = 0;\n  dx: number = 0;\n  time: Fraction | null = null;\n  notesY: number[] = [];\n  pointsY: number[] = [];\n  tailPointsX: number[] = [];\n  dimens: Dimens = new Dimens();\n  isSelect: boolean = false;\n  constructor(o: any, config: MuseConfig) {\n    this.config = config;\n    this.decode(o);\n  }\n  decode(o: any): void {\n    if (o.n !== undefined) {\n      let n: string = o.n;\n      let pos = n.search(\"@\");\n      let ns = \"\";\n      let ts = \"\";\n      if (pos === -1) {\n        ns = n;\n        ts = \"0|0\";\n      } else {\n        ns = n.substr(0, pos);\n        ts = n.substr(pos + 1);\n      }\n      let ng = ns.split(\"|\");\n      ng.forEach((it) => {\n        for (let i = 0; i < it.length; ++i) {\n          if (\n            (it.charCodeAt(i) <= 57 && it.charCodeAt(i) >= 48) ||\n            it.charCodeAt(i) === 45\n          ) {\n            let x = it.substr(0, i);\n            let n = it.charAt(i);\n            let t = it.substr(i + 1).length;\n            if (t !== 0 && it.charAt(i + 1) === \"-\") {\n              t = -t;\n            }\n            this.noteGroup.push({ x, n, t });\n            if (x !== \"\") {\n              this.dx = this.config.sigFontSize / 2;\n            }\n            break;\n          }\n        }\n      });\n      let tg = ts.split(\"|\");\n      if (tg.length === 3) {\n        this.l = parseInt(tg[0]);\n        this.p = parseInt(tg[1]);\n        this.d = parseInt(tg[2]);\n      } else if (tg.length === 2) {\n        this.l = parseInt(tg[0]);\n        this.p = parseInt(tg[1]);\n        this.d = 1;\n      } else if (tg.length === 1) {\n        this.l = parseInt(tg[0]);\n        this.p = 0;\n        this.d = 1;\n      } else {\n        this.l = 0;\n        this.p = 0;\n        this.d = 1;\n      }\n    }\n    if (o.dimens !== undefined) {\n      this.dimens = o.dimens;\n    }\n  }\n  code(): any {\n    let o: any = {};\n    o.n = \"@\" + this.time?.toString();\n    return o;\n  }\n  settle() {\n    let width =\n      this.dx + this.config.noteWidth + this.p * this.config.tailPointGap;\n    let ny = 0;\n    let mb = 0;\n    mb += this.l * this.config.pointGap;\n    let py = 0;\n    this.noteGroup.forEach((it, idx) => {\n      if (it.t < 0) {\n        if (idx === 0) {\n          let i = -it.t;\n          for (; i > 0; --i) {\n            let x = this.config.pointGap;\n            mb += x / 2;\n            this.pointsY.push(-mb);\n            mb += x / 2;\n          }\n        }\n        if (idx !== 0) {\n          let i = -it.t;\n          for (; i > 0; --i) {\n            let x = this.config.pointGap;\n            py += x / 2;\n            this.pointsY.push(py);\n            py += x / 2;\n            ny += x;\n          }\n        }\n      }\n      this.notesY.push(ny);\n      let h = this.config.noteHeight;\n      ny += h;\n      py += h;\n      if (it.t > 0) {\n        let i = it.t;\n        for (; i > 0; --i) {\n          let x = this.config.pointGap;\n          py += x / 2;\n          this.pointsY.push(py);\n          py += x / 2;\n          ny += x;\n        }\n      }\n    });\n    for (let i = 0; i < this.p; ++i) {\n      this.tailPointsX.push(\n        this.dx + this.config.noteWidth + (i + 1 / 2) * this.config.tailPointGap\n      );\n    }\n    this.dimens.width = width;\n    this.dimens.height = ny;\n    this.dimens.marginBottom = mb;\n  }\n}\n\nfunction castX(x: string) {\n  let m: Record<string, string> = {\n    S: \"#\",\n    F: \"b\",\n    DS: \"x\",\n    DF: \"d\",\n    N: \"n\",\n  };\n  return m[x] || \"\";\n}\n\nfunction noteGroup(note: Note, clazz: string) {\n  return (\n    <g className={clazz + \"__group-note\"}>\n      {note.noteGroup.map((it, idx) => {\n        return (\n          <g\n            className={clazz + \"__note-one\"}\n            key={idx}\n            width={note.dimens.width}\n            height={note.notesY[idx]}\n            transform={\n              \"translate(\" +\n              0 +\n              \",\" +\n              (note.dimens.height - note.notesY[idx]) +\n              \")\"\n            }\n          >\n            <text\n              fontFamily={note.config.noteFontFamily}\n              fontSize={note.config.noteFontSize}\n              transform={\"translate(\" + note.dx + \",\" + 0 + \")\"}\n            >\n              {it.n}\n            </text>\n            <text\n              fontFamily={note.config.noteFontFamily}\n              fontSize={note.config.sigFontSize}\n              transform={\n                \"translate(\" +\n                0 +\n                \",\" +\n                (note.config.sigFontSize - note.config.noteHeight) +\n                \")\"\n              }\n            >\n              {castX(it.x)}\n            </text>\n          </g>\n        );\n      })}\n    </g>\n  );\n}\n\nfunction pointGroup(note: Note, clazz: string) {\n  return (\n    <g className={clazz + \"__group-point\"}>\n      {note.pointsY.map((it, idx) => (\n        <circle\n          key={idx}\n          r={note.config.pointRound}\n          fill=\"black\"\n          transform={\n            \"translate(\" +\n            (note.dx + note.config.noteWidth / 2) +\n            \",\" +\n            (note.dimens.height - it + note.config.pointGap / 2) +\n            \")\"\n          }\n        />\n      ))}\n    </g>\n  );\n}\n\nfunction tailPoint(note: Note, clazz: string) {\n  return (\n    <g className={clazz + \"__tail-point\"}>\n      {note.tailPointsX.map((it, idx) => (\n        <circle\n          key={idx}\n          r={note.config.pointRound}\n          fill=\"black\"\n          transform={\n            \"translate(\" +\n            it +\n            \",\" +\n            (note.dimens.height - note.config.noteHeight / 3) +\n            \")\"\n          }\n        />\n      ))}\n    </g>\n  );\n}\n\nfunction MuseNote(props: { cursor: number[]; selector: Selector }) {\n  let [note, setNote] = useState<Note | null>(null);\n  useEffect(() => {\n    function handleState(state: { note: Note }) {\n      setNote(state.note);\n    }\n    props.selector.fetchNote(props.cursor, handleState);\n    return () => props.selector.unFetchNote(props.cursor);\n  });\n  if (note) {\n    let d = note.dimens;\n    let clazz = \"muse-note\";\n    return (\n      <g\n        className={clazz}\n        transform={\n          \"translate(\" + (d.x - d.marginLeft) + \",\" + (d.y - d.marginTop) + \")\"\n        }\n        width={d.width + d.marginLeft + d.marginRight}\n        height={d.height + d.marginTop + d.marginBottom}\n        onClick={() => {}}\n      >\n        {outerBorder(d, clazz, note.isSelect, \"blue\")}\n        {noteGroup(note, clazz)}\n        {pointGroup(note, clazz)}\n        {tailPoint(note, clazz)}\n      </g>\n    );\n  } else {\n    return <></>;\n  }\n}\n\nexport default MuseNote;\n","import React, { useEffect, useState } from \"react\";\nimport MuseConfig from \"./MuseConfig\";\nimport Dimens from \"./Dimens\";\nimport MuseNote, { Note } from \"./MuseNote\";\nimport { border } from \"./Border\";\nimport Selector from \"./Selector\";\nimport Codec from \"./Codec\";\n\nexport class Bar implements Codec {\n  config: MuseConfig;\n  notes: Note[] = [];\n  dimens: Dimens = new Dimens();\n  unitNum: number = 0;\n  notesX: number[] = [];\n  baselineGroup: {\n    y: number;\n    s: number;\n    e: number;\n  }[] = [];\n  constructor(o: any, config: MuseConfig) {\n    this.config = config;\n    this.decode(o);\n  }\n  decode(o: any): void {\n    if (o.notes !== undefined) {\n      o.notes.forEach((it: any) => {\n        this.notes.push(new Note(it, this.config));\n      });\n      this.generateBaseline();\n      this.notesX.push(1);\n      this.notes.forEach((note, idx) => {\n        let x = 0;\n        if (this.notes[idx + 1] === undefined) {\n          x += 1;\n        } else if (\n          this.notes[idx + 1] !== undefined &&\n          this.notes[idx + 1].l < note.l\n        ) {\n          x += Math.pow(2, -this.notes[idx + 1].l);\n        } else {\n          x += Math.pow(2, -note.l);\n        }\n        let q = 1;\n        for (let i = 1; i <= note.p; ++i) {\n          q += Math.pow(2, -i);\n        }\n        x *= q;\n        this.notesX.push(x);\n        this.unitNum += x;\n      });\n    }\n    if (o.dimens !== undefined) {\n      this.dimens = o.dimens;\n    }\n  }\n  code(): any {\n    let o: any = {};\n    o.notes = [];\n    this.notes.forEach((it) => o.notes.push(it.code()));\n    return o;\n  }\n  generateBaseline() {\n    for (let i = 0; ; ++i) {\n      let x = 0;\n      let s = 0;\n      let e = -1;\n      this.notes.forEach((it, idx) => {\n        if (it.l > i) {\n          e = idx;\n          x++;\n        } else {\n          if (s <= e) this.baselineGroup.push({ y: i, s: s, e: e });\n          s = idx + 1;\n          e = idx;\n        }\n      });\n      if (s <= e) this.baselineGroup.push({ y: i, s: s, e: e });\n      if (x === 0) {\n        break;\n      }\n    }\n  }\n}\n\nfunction barLine(d: Dimens, clazz: string) {\n  return (\n    <line\n      className={clazz + \"__bar-line\"}\n      x1={d.marginLeft + d.width + d.marginRight}\n      y1={0}\n      x2={d.marginLeft + d.width + d.marginRight}\n      y2={d.height}\n      strokeWidth={1}\n      stroke=\"black\"\n    />\n  );\n}\n\nfunction baseLine(bar: Bar, clazz: string) {\n  return (\n    <g className={clazz + \"__base-line\"}>\n      {bar.baselineGroup.map((it, idx) => (\n        <line\n          key={idx}\n          x1={bar.notes[it.s].dimens.x}\n          y1={bar.notes[it.s].dimens.height + (it.y + 1) * bar.config.pointGap}\n          x2={bar.notes[it.e].dimens.x + bar.notes[it.e].dimens.width}\n          y2={bar.notes[it.s].dimens.height + (it.y + 1) * bar.config.pointGap}\n          stroke={\"black\"}\n          strokeWidth={1}\n        />\n      ))}\n    </g>\n  );\n}\n\nfunction MuseBar(props: { cursor: number[]; selector: Selector }) {\n  let [bar, setBar] = useState<Bar | null>(null);\n  useEffect(() => {\n    function handleState(state: { bar: Bar }) {\n      setBar(state.bar);\n    }\n    props.selector.fetchBar(props.cursor, handleState);\n    return () => props.selector.unFetchBar(props.cursor);\n  });\n  if (bar) {\n    let d = bar.dimens;\n    let clazz = \"muse-bar\";\n    return (\n      <g\n        className={clazz}\n        transform={\n          \"translate(\" + (d.x - d.marginLeft) + \",\" + (d.y - d.marginTop) + \")\"\n        }\n        width={d.width + d.marginLeft + d.marginRight}\n        height={d.height + d.marginTop + d.marginBottom}\n      >\n        {border(d, clazz)}\n        {barLine(d, clazz)}\n        {baseLine(bar, clazz)}\n        {bar.notes.map((it, idx) => (\n          <MuseNote\n            key={idx}\n            cursor={[...props.cursor, idx]}\n            selector={props.selector}\n          />\n        ))}\n      </g>\n    );\n  } else {\n    return <></>;\n  }\n}\n\nexport default MuseBar;\n","import React, { useEffect, useState } from \"react\";\nimport Dimens from \"./Dimens\";\nimport MuseConfig from \"./MuseConfig\";\nimport MuseBar, { Bar } from \"./MuseBar\";\nimport { border } from \"./Border\";\nimport Selector from \"./Selector\";\nimport Codec from \"./Codec\";\n\nexport class Track implements Codec {\n  config: MuseConfig;\n  bars: Bar[] = [];\n  dimens: Dimens = new Dimens();\n  constructor(o: any, config: MuseConfig) {\n    this.config = config;\n    this.decode(o);\n  }\n  decode(o: any): void {\n    if (o.bars !== undefined) {\n      o.bars.forEach((it: any) => {\n        this.bars.push(new Bar(it, this.config));\n      });\n    }\n    if (o.dimens !== undefined) {\n      this.dimens = o.dimens;\n    }\n  }\n  code(): any {\n    let o: any = {};\n    o.bars = [];\n    this.bars.forEach((it) => o.bars.push(it.code()));\n    return o;\n  }\n}\n\nfunction MuseTrack(props: { cursor: number[]; selector: Selector }) {\n  let [track, setTrack] = useState<Track | null>(null);\n  useEffect(() => {\n    function handleState(state: { track: Track }) {\n      setTrack(state.track);\n    }\n    props.selector.fetchTrack(props.cursor, handleState);\n    return () => props.selector.unFetchTrack(props.cursor);\n  });\n  if (track) {\n    let d = track.dimens;\n    let clazz = \"muse-track\";\n    return (\n      <g\n        className={clazz}\n        transform={\n          \"translate(\" + (d.x - d.marginLeft) + \",\" + (d.y - d.marginTop) + \")\"\n        }\n        width={d.width + d.marginLeft + d.marginRight}\n        height={d.height + d.marginTop + d.marginBottom}\n      >\n        {border(d, clazz)}\n        {track.bars.map((it, idx) => (\n          <MuseBar\n            key={idx}\n            cursor={[...props.cursor, idx]}\n            selector={props.selector}\n          />\n        ))}\n      </g>\n    );\n  } else {\n    return <></>;\n  }\n}\n\nexport default MuseTrack;\n","import React, { useEffect, useState } from \"react\";\nimport Dimens from \"./Dimens\";\nimport MuseConfig from \"./MuseConfig\";\nimport MuseTrack, { Track } from \"./MuseTrack\";\nimport { border } from \"./Border\";\nimport Selector from \"./Selector\";\nimport Codec from \"./Codec\";\n\nexport class Line implements Codec {\n  config: MuseConfig;\n  tracks: Track[] = [];\n  dimens: Dimens = new Dimens();\n  constructor(o: any, config: MuseConfig) {\n    this.config = config;\n    this.decode(o);\n  }\n  decode(o: any): void {\n    if (o.tracks !== undefined) {\n      o.tracks.forEach((it: any) => {\n        this.tracks.push(new Track(it, this.config));\n      });\n    }\n    if (o.dimens !== undefined) {\n      this.dimens = o.dimens;\n    }\n  }\n  code() {\n    let o: any = {};\n    o.tracks = [];\n    this.tracks.forEach((it) => o.tracks.push(it.code()));\n    return o;\n  }\n}\n\nfunction lineHead(d: Dimens, clazz: string) {\n  return (\n    <g className={clazz + \"__line-head\"}>\n      <line x1={0} y1={0} x2={0} y2={d.height} strokeWidth={1} stroke=\"black\" />\n    </g>\n  );\n}\n\nfunction MuseLine(props: { cursor: number[]; selector: Selector }) {\n  let [line, setLine] = useState<Line | null>(null);\n  useEffect(() => {\n    function handleState(state: { line: Line }) {\n      setLine(state.line);\n    }\n    props.selector.fetchLine(props.cursor, handleState);\n    return () => props.selector.unFetchLine(props.cursor);\n  });\n  if (line) {\n    let d = line.dimens;\n    let clazz = \"muse-line\";\n    return (\n      <g\n        className={clazz}\n        transform={\n          \"translate(\" + (d.x - d.marginLeft) + \",\" + (d.y - d.marginTop) + \")\"\n        }\n        width={d.width + d.marginLeft + d.marginRight}\n        height={d.height + d.marginTop + d.marginBottom}\n      >\n        {border(d, clazz)}\n        {lineHead(d, clazz)}\n        {line.tracks.map((it, idx) => (\n          <MuseTrack\n            key={idx}\n            cursor={[...props.cursor, idx]}\n            selector={props.selector}\n          />\n        ))}\n      </g>\n    );\n  } else {\n    return <></>;\n  }\n}\n\nexport default MuseLine;\n","import React, { useEffect, useState } from \"react\";\nimport MuseConfig from \"./MuseConfig\";\nimport Dimens from \"./Dimens\";\nimport MuseLine, { Line } from \"./MuseLine\";\nimport { border, outerBorder } from \"./Border\";\nimport Selector from \"./Selector\";\nimport Codec from \"./Codec\";\n\nexport class Page implements Codec {\n  config: MuseConfig;\n  lines: Line[] = [];\n  dimens: Dimens = new Dimens();\n  index: number = 0;\n  constructor(o: any, config: MuseConfig) {\n    this.config = config;\n    this.decode(o);\n  }\n  decode(o: any): void {\n    if (o.lines !== undefined) {\n      o.lines.forEach((it: any) => {\n        this.lines.push(new Line(it, this.config));\n      });\n    }\n    if (o.dimens !== undefined) {\n      this.dimens = o.dimens;\n    }\n  }\n  code() {\n    let o: any = {};\n    o.lines = [];\n    this.lines.forEach((it) => o.lines.push(it.code()));\n    return o;\n  }\n}\n\nfunction pageIndex(idx: number, d: Dimens, clazz: string, config: MuseConfig) {\n  return (\n    <g\n      className={clazz + \"__page-index\"}\n      transform={\n        \"translate(\" +\n        (d.marginLeft + d.width / 2) +\n        \",\" +\n        (d.marginTop + d.height + d.marginBottom / 2) +\n        \")\"\n      }\n    >\n      <text\n        textAnchor={\"middle\"}\n        fontFamily={config.textFontFamily}\n        fontSize={config.pageIndexFontSize}\n      >\n        {idx.toString()}\n      </text>\n    </g>\n  );\n}\n\nfunction MusePage(props: {cursor: number[]; selector: Selector }) {\n  let [page, setPage] = useState<Page | null>(null);\n  useEffect(() => {\n    function handleState(state: { page: Page }) {\n      setPage(state.page);\n    }\n    props.selector.fetchPage(props.cursor, handleState);\n    return () => props.selector.unFetchPage(props.cursor);\n  });\n  if (page) {\n    let d = page.dimens;\n    let clazz = \"muse-page\";\n    return (\n      <g\n        className={clazz}\n        transform={\n          \"translate(\" + (d.x - d.marginLeft) + \",\" + (d.y - d.marginTop) + \")\"\n        }\n        width={d.width + d.marginLeft + d.marginRight}\n        height={d.height + d.marginTop + d.marginBottom}\n      >\n        {border(d, clazz)}\n        {outerBorder(d, clazz, true)}\n        {pageIndex(page.index, d, clazz, page.config)}\n        {page.lines.map((it, idx) => (\n          <MuseLine\n            key={idx}\n            cursor={[...props.cursor, idx]}\n            selector={props.selector}\n          />\n        ))}\n      </g>\n    );\n  } else {\n    return <></>;\n  }\n}\n\nexport default MusePage;\n","import React, { useEffect, useState } from \"react\";\nimport MuseConfig from \"./MuseConfig\";\nimport Dimens from \"./Dimens\";\nimport MusePage, { Page } from \"./MusePage\";\nimport { border } from \"./Border\";\nimport Selector from \"./Selector\";\nimport Codec from \"./Codec\";\n\nexport class Notation implements Codec {\n  config: MuseConfig;\n  pages: Page[] = [];\n  title: string = \"\";\n  subtitle: string = \"\";\n  author: string[] = [];\n  speed: string = \"\";\n  rhythmic: string = \"\";\n  C: string = \"\";\n  dimens: Dimens = new Dimens();\n  constructor(json: string, config: MuseConfig) {\n    this.config = config;\n    let o: any = JSON.parse(json);\n    this.decode(o);\n  }\n  decode(o: any): void {\n    if (o.pages !== undefined) {\n      o.pages.forEach((it: any) => {\n        this.pages.push(new Page(it, this.config));\n      });\n    }\n    if (o.dimens !== undefined) {\n      this.dimens = o.dimens;\n    }\n    if (o.title !== undefined) {\n      this.title = o.title;\n    }\n    if (o.subtitle !== undefined) {\n      this.subtitle = o.subtitle;\n    }\n    if (o.author !== undefined) {\n      this.author = o.author.toString().split(\"|\");\n    }\n    if (o.speed !== undefined) {\n      this.speed = o.speed;\n    }\n    if (o.rhythmic) {\n      this.rhythmic = o.rhythmic;\n    }\n    if (o.C) {\n      this.C = \"1=\" + o.C;\n    }\n  }\n  code() {\n    let o: any = {};\n    o.pages = [];\n    this.pages.forEach((it) => o.pages.push(it.code()));\n    return o;\n  }\n}\n\nfunction notationInfo(notation: Notation, clazz: string) {\n  let config = notation.config;\n  let y = 0;\n  y += config.pageMarginVertical;\n  let title = (\n    <text\n      className={clazz + \"__info-title\"}\n      fontFamily={config.textFontFamily}\n      width={notation.dimens.width}\n      textAnchor={\"middle\"}\n      fontSize={config.infoTitleFontSize}\n      transform={\n        \"translate(\" +\n        (notation.dimens.marginLeft + notation.dimens.width / 2) +\n        \",\" +\n        y +\n        \")\"\n      }\n    >\n      {notation.title}\n    </text>\n  );\n  y += config.infoTitleFontSize + config.infoGap;\n  let subtitle = (\n    <text\n      className={clazz + \"__info-subtitle\"}\n      fontFamily={config.textFontFamily}\n      width={notation.dimens.width}\n      textAnchor={\"middle\"}\n      fontSize={config.infoSubtitleFontSize}\n      transform={\n        \"translate(\" +\n        (notation.dimens.marginLeft + notation.dimens.width / 2) +\n        \",\" +\n        y +\n        \")\"\n      }\n    >\n      {notation.subtitle}\n    </text>\n  );\n  let y1 = y;\n  let x = notation.author.length;\n  let author = (\n    <g className={clazz + \"__info-author\"}>\n      {notation.author.map((it, idx) => {\n        y1 += config.infoFontSize + config.infoGap;\n        if (idx < x - 2) {\n          y += config.infoFontSize + config.infoGap;\n        }\n        return (\n          <text\n            key={idx}\n            fontFamily={config.textFontFamily}\n            width={notation.dimens.width}\n            fontSize={config.infoFontSize}\n            textAnchor={\"end\"}\n            x={0}\n            transform={\n              \"translate(\" +\n              (notation.dimens.width - config.pageMarginHorizontal) +\n              \",\" +\n              y1 +\n              \")\"\n            }\n          >\n            {it}\n          </text>\n        );\n      })}\n    </g>\n  );\n  let y2 = y + (config.infoGap + config.infoSubtitleFontSize);\n  let y3 = y2 + (config.infoGap + config.infoFontSize);\n  let rythimic = (\n    <g className={clazz + \"__info-rythmic\"} width={notation.dimens.width}>\n      <text\n        fontFamily={config.textFontFamily}\n        width={notation.dimens.width}\n        fontSize={config.infoFontSize}\n        transform={\"translate(\" + config.pageMarginHorizontal + \",\" + y2 + \")\"}\n      >\n        {notation.speed}\n      </text>\n      <text\n        fontFamily={config.textFontFamily}\n        width={notation.dimens.width}\n        fontSize={config.infoFontSize}\n        transform={\"translate(\" + config.pageMarginHorizontal + \",\" + y3 + \")\"}\n      >\n        {notation.C + \" \" + notation.rhythmic}\n      </text>\n    </g>\n  );\n  return (\n    <g className={clazz + \"__info\"} width={notation.dimens.width}>\n      {title}\n      {subtitle}\n      {author}\n      {rythimic}\n    </g>\n  );\n}\n\nfunction MuseNotation(props: {  selector: Selector }) {\n  let [notation, setNotation] = useState<Notation | null>(null);\n  useEffect(() => {\n    function handleState(state: { notation: Notation }) {\n      setNotation(state.notation);\n    }\n    props.selector.fetchNotation(handleState);\n    return () => props.selector.unFetchNotation();\n  });\n  if (notation) {\n    let margin = 10;\n    let d = notation.dimens;\n    let clazz = \"muse-notation\";\n    return (\n      <svg\n        className=\"muse\"\n        width={notation.dimens.width + margin * 2}\n        height={notation.dimens.height + margin * 2}\n      >\n        <g\n          className={clazz}\n          transform={\"translate(\" + margin + \",\" + margin + \")\"}\n          width={notation.dimens.width}\n          height={notation.dimens.height}\n        >\n          {border(d, clazz)}\n          {notationInfo(notation, clazz)}\n          {notation.pages.map((it, idx) => (\n            <MusePage key={idx} cursor={[idx]} selector={props.selector} />\n          ))}\n        </g>\n      </svg>\n    );\n  } else {\n    return <></>;\n  }\n}\n\nexport default MuseNotation;\n","import { Note } from \"./MuseNote\";\nimport { Notation } from \"./MuseNotation\";\nimport { Page } from \"./MusePage\";\nimport { Line } from \"./MuseLine\";\nimport { Track } from \"./MuseTrack\";\nimport { Bar } from \"./MuseBar\";\n\ninterface HandlerTree {\n  handler: ((state: { notation: Notation }) => void) | null;\n  pages: {\n    handler: ((state: { page: Page }) => void) | null;\n    lines: {\n      handler: ((state: { line: Line }) => void) | null;\n      tracks: {\n        handler: ((state: { track: Track }) => void) | null;\n        bars: {\n          handler: ((state: { bar: Bar }) => void) | null;\n          notes: {\n            handler: ((state: { note: Note }) => void) | null;\n          }[];\n        }[];\n      }[];\n    }[];\n  }[];\n}\n\nclass Selector {\n  data: Notation;\n  tree: HandlerTree;\n  constructor(data: Notation) {\n    this.data = data;\n    this.tree = { handler: null, pages: [] };\n    this.data.pages.forEach((page, pageIdx) => {\n      this.tree.pages.push({ handler: null, lines: [] });\n      page.lines.forEach((line, lineIdx) => {\n        this.tree.pages[pageIdx].lines.push({ handler: null, tracks: [] });\n        line.tracks.forEach((track, trackIdx) => {\n          this.tree.pages[pageIdx].lines[lineIdx].tracks.push({\n            handler: null,\n            bars: [],\n          });\n          track.bars.forEach((bar, barIdx) => {\n            this.tree.pages[pageIdx].lines[lineIdx].tracks[trackIdx].bars.push({\n              handler: null,\n              notes: [],\n            });\n            bar.notes.forEach((note) => {\n              this.tree.pages[pageIdx].lines[lineIdx].tracks[trackIdx].bars[\n                barIdx\n              ].notes.push({\n                handler: null,\n              });\n            });\n          });\n        });\n      });\n    });\n    // document.addEventListener(\"keydown\", (ev) => {\n    //   if (ev.key >= \"0\" && ev.key <= \"9\" && this.l.length === 1) {\n    //     console.log(this.l[0].note);\n    //     console.log(ev);\n    //     let o = new Note(this.l[0].note, this.l[0].note.config);\n    //     o.n = ev.key;\n    //     o.settle();\n    //     console.log(o);\n    //     this.l[0].setNote(o);\n    //   }\n    // });\n  }\n  fetchNotation(handler: (state: { notation: Notation }) => void) {\n    let notation = this.data;\n    this.tree.handler = handler;\n    handler({ notation });\n  }\n  unFetchNotation() {}\n  fetchPage(cursor: number[], handler: (state: { page: Page }) => void) {\n    if (cursor.length === 1) {\n      let page = this.data.pages[cursor[0]];\n      this.tree.pages[cursor[0]].handler = handler;\n      handler({ page });\n    } else {\n      throw new Error(\"cursor size error\");\n    }\n  }\n  unFetchPage(cursor: number[]) {\n    if (cursor.length === 1) {\n    } else {\n      throw new Error(\"cursor size error\");\n    }\n  }\n  fetchLine(cursor: number[], handler: (state: { line: Line }) => void) {\n    if (cursor.length === 2) {\n      let line = this.data.pages[cursor[0]].lines[cursor[1]];\n      this.tree.pages[cursor[0]].lines[cursor[1]].handler = handler;\n      handler({ line });\n    } else {\n      throw new Error(\"cursor size error\");\n    }\n  }\n  unFetchLine(cursor: number[]) {\n    if (cursor.length === 2) {\n    } else {\n      throw new Error(\"cursor size error\");\n    }\n  }\n  fetchTrack(cursor: number[], handler: (state: { track: Track }) => void) {\n    if (cursor.length === 3) {\n      let track = this.data.pages[cursor[0]].lines[cursor[1]].tracks[cursor[2]];\n      this.tree.pages[cursor[0]].lines[cursor[1]].tracks[\n        cursor[2]\n      ].handler = handler;\n      handler({ track });\n    } else {\n      throw new Error(\"cursor size error\");\n    }\n  }\n  unFetchTrack(cursor: number[]) {\n    if (cursor.length === 3) {\n    } else {\n      throw new Error(\"cursor size error\");\n    }\n  }\n  fetchBar(cursor: number[], handler: (state: { bar: Bar }) => void) {\n    if (cursor.length === 4) {\n      let bar = this.data.pages[cursor[0]].lines[cursor[1]].tracks[cursor[2]]\n        .bars[cursor[3]];\n      this.tree.pages[cursor[0]].lines[cursor[1]].tracks[cursor[2]].bars[\n        cursor[3]\n      ].handler = handler;\n      handler({ bar });\n    } else {\n      throw new Error(\"cursor size error\");\n    }\n  }\n  unFetchBar(cursor: number[]) {\n    if (cursor.length === 4) {\n    } else {\n      throw new Error(\"cursor size error\");\n    }\n  }\n  fetchNote(cursor: number[], handler: (state: { note: Note }) => void) {\n    if (cursor.length === 5) {\n      let note = this.data.pages[cursor[0]].lines[cursor[1]].tracks[cursor[2]]\n        .bars[cursor[3]].notes[cursor[4]];\n      this.tree.pages[cursor[0]].lines[cursor[1]].tracks[cursor[2]].bars[\n        cursor[3]\n      ].notes[cursor[4]].handler = handler;\n      handler({ note });\n    } else {\n      throw new Error(\"cursor size error\");\n    }\n  }\n  unFetchNote(cursor: number[]) {\n    if (cursor.length === 5) {\n    } else {\n      throw new Error(\"cursor size error\");\n    }\n  }\n}\n\nexport default Selector;\n","import React from \"react\";\nimport MuseConfig from \"./MuseConfig\";\nimport MuseNotation, { Notation } from \"./MuseNotation\";\nimport Selector from \"./Selector\";\n\nfunction init(data: string, config: MuseConfig): Notation {\n  let hm = config.pageMarginHorizontal;\n  let vm = config.pageMarginVertical;\n  let w = config.notationWidth - hm * 2;\n  let h = config.notationWidth * config.pageE - vm * 2;\n  let notation = new Notation(data, config);\n  let notationH = 0;\n  notation.pages.forEach((page, pageIdx) => {\n    page.dimens.x = hm;\n    page.dimens.y = vm * (pageIdx + 1) + (vm + h) * pageIdx;\n    page.dimens.width = w;\n    page.dimens.marginLeft = hm;\n    page.dimens.marginRight = hm;\n    page.dimens.height = h;\n    page.dimens.marginTop = vm;\n    page.dimens.marginBottom = vm;\n    if (pageIdx === 0) {\n      let x = 0;\n      x += config.infoTitleFontSize + config.infoGap;\n      x += config.infoSubtitleFontSize + config.infoGap;\n      x += notation.author.length * (config.infoFontSize + config.infoGap);\n      page.dimens.marginTop += x;\n      page.dimens.height -= x;\n      page.dimens.y += x;\n    }\n    page.index = pageIdx + 1;\n    notationH +=\n      page.dimens.marginTop + page.dimens.marginBottom + page.dimens.height;\n    let linesHeight: number[] = [];\n    let lineYSpace = page.dimens.height;\n    page.lines.forEach((line) => {\n      line.dimens.width = page.dimens.width;\n      line.dimens.x = page.dimens.marginLeft;\n      let lineHeight = 0;\n      let trackY = 0;\n      let barsW: number[] = [];\n      line.tracks.forEach((track) => {\n        track.bars.forEach((bar, barIdx) => {\n          if (barsW[barIdx] !== undefined) {\n            barsW[barIdx] =\n              barsW[barIdx] > bar.unitNum ? barsW[barIdx] : bar.unitNum;\n          } else {\n            barsW.push(bar.unitNum);\n          }\n        });\n      });\n      let barUnitSum = barsW.reduce((s, it) => s + it);\n      line.tracks.forEach((track) => {\n        let trackHeight = 0;\n        track.dimens.y = trackY;\n        track.dimens.width = line.dimens.width;\n        let maxNoteHeight = 0; //最大note.y\n        let maxNoteMarginBottom = 0;\n        let barX = 0;\n        track.bars.forEach((bar, barIdx) => {\n          bar.unitNum = barsW[barIdx];\n          bar.dimens.width = (barsW[barIdx] / barUnitSum) * track.dimens.width;\n          bar.dimens.x = barX;\n          barX += bar.dimens.width;\n          let notesWidth: number[] = [];\n          bar.notes.forEach((note) => {\n            note.settle();\n            let noteWidth = note.dimens.width;\n            let noteHeight = note.dimens.height;\n            let noteMarginBootom = note.dimens.marginBottom;\n            maxNoteHeight =\n              maxNoteHeight > noteHeight ? maxNoteHeight : noteHeight;\n            maxNoteMarginBottom =\n              maxNoteMarginBottom > noteMarginBootom\n                ? maxNoteMarginBottom\n                : noteMarginBootom;\n            notesWidth.push(noteWidth);\n          });\n          let x = 0;\n          bar.notes.forEach((note, idx) => {\n            x += (bar.notesX[idx] / (bar.unitNum + 1)) * bar.dimens.width;\n            note.dimens.x = x - config.noteWidth / 2 - note.dx;\n          });\n        });\n        track.dimens.height = maxNoteHeight + maxNoteMarginBottom;\n        track.bars.forEach((bar) => {\n          bar.dimens.height = track.dimens.height;\n          bar.notes.forEach((note) => {\n            note.dimens.height = maxNoteHeight;\n            note.dimens.marginBottom = maxNoteMarginBottom;\n          });\n        });\n        trackHeight = maxNoteHeight + maxNoteMarginBottom;\n        lineHeight += trackHeight + config.trackGap;\n        trackY += trackHeight + config.trackGap;\n      });\n      lineHeight -= config.trackGap;\n      line.dimens.height = lineHeight;\n      lineYSpace -= lineHeight;\n      linesHeight.push(lineHeight);\n    });\n    let lineYUnit = lineYSpace / (page.lines.length - 1);\n    page.lines.forEach((line, idx) => {\n      let py = page.dimens.marginTop;\n      for (let i = 0; i < idx; ++i) {\n        py += lineYUnit + linesHeight[i];\n      }\n      line.dimens.y = py;\n    });\n  });\n  notation.dimens.width = w + 2 * hm;\n  notation.dimens.height = notationH;\n  return notation;\n}\n\nfunction Muse(props: { data: string; config?: MuseConfig }) {\n  let notation = init(\n    props.data,\n    props.config ? props.config : new MuseConfig()\n  );\n  return <MuseNotation selector={new Selector(notation)} />;\n}\n\nexport default Muse;\n","import React from \"react\";\nimport \"./App.css\";\nimport Muse from \"./muse/Muse\";\n\nclass App extends React.Component<\n  {},\n  {\n    error: any | null;\n    isLoaded: boolean;\n    data: string;\n  }\n> {\n  constructor(props: {}) {\n    super(props);\n    this.state = {\n      error: null,\n      isLoaded: false,\n      data: \"\",\n    };\n  }\n\n  componentDidMount() {\n    let url = \"https://cdn.jsdelivr.net/gh/shizuku/muse-react/test/data/\";\n    // let url = \"http://localhost:8888/\";\n    fetch(url + \"b.json\")\n      .then((res) => res.text())\n      .then(\n        (result) => {\n          this.setState({\n            isLoaded: true,\n            data: result,\n          });\n        },\n        (error) => {\n          this.setState({\n            isLoaded: true,\n            error: error,\n          });\n        }\n      );\n  }\n\n  render() {\n    return (\n      <div className=\"app\">\n        <h1>Example</h1>\n        {this.state.isLoaded ? (\n          this.state.error ? (\n            \"error\"\n          ) : (\n            <Muse data={this.state.data} />\n          )\n        ) : (\n          \"loading...\"\n        )}\n      </div>\n    );\n  }\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}