{"version":3,"sources":["muse/MuseConfig.ts","muse/Dimens.ts","muse/Border.tsx","muse/MuseNote.tsx","muse/MuseBar.tsx","muse/MuseTrack.tsx","muse/MuseLine.tsx","muse/MusePage.tsx","muse/repo/muse-repo.ts","muse/MuseNotation.tsx","muse/Muse.tsx","App.tsx","serviceWorker.ts","index.tsx"],"names":["MuseConfig","noteHeight","noteWidth","noteFontSize","noteFontFamily","sigFontSize","trackGap","lineGap","pointGap","tailPointGap","pointRound","pageE","notationWidth","pageMarginHorizontal","pageMarginVertical","infoTitleFontSize","infoSubtitleFontSize","infoGap","infoFontSize","pageIndexFontSize","textFontFamily","Dimens","x","y","width","height","marginTop","marginBottom","marginLeft","marginRight","this","marginHorizontal","marginVertical","d","border","clazz","show","color","ifShow","className","transform","stroke","strokeWidth","fill","outerBorder","Note","o","config","l","p","dx","notesY","pointsY","tailPointsX","decode","ny","mb","py","noteGroup","forEach","it","idx","t","i","push","h","dimens","undefined","n","pos","search","ns","ts","substr","split","length","charCodeAt","charAt","tg","parseInt","time","toString","observable","MuseNote","observer","note","props","onClick","isSelect","console","log","map","key","fontFamily","fontSize","S","F","DS","DF","N","r","pointGroup","tailPoint","React","Component","Bar","unitNum","notesX","baselineGroup","s","e","notes","generateBaseline","Math","pow","q","code","MuseBar","bar","useObserver","x1","y1","x2","y2","barLine","baseLine","Track","bars","MuseTrack","track","Line","tracks","MuseLine","line","lineHead","Page","lines","MusePage","page","textAnchor","pageIndex","index","MuseRepo","notation","Notation","json","JSON","parse","pages","title","subtitle","author","speed","rhythmic","C","reduce","c","MuseNotation","repo","useContext","MobXProviderContext","museRepo","margin","y3","rythimic","notationInfo","Muse","data","hm","vm","w","notationH","pageIdx","linesHeight","lineYSpace","lineHeight","trackY","barsW","barIdx","barUnitSum","trackHeight","maxNoteHeight","maxNoteMarginBottom","barX","notesWidth","settle","noteMarginBootom","lineYUnit","init","App","state","error","isLoaded","fetch","then","res","text","result","setState","Boolean","window","location","hostname","match","ReactDOM","render","StrictMode","document","getElementById","navigator","serviceWorker","ready","registration","unregister","catch","message"],"mappings":"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","file":"static/js/main.fc39df62.chunk.js","sourcesContent":["export default class MuseConfig {\n  noteHeight = 22;\n  noteWidth = 11;\n  noteFontSize = 22;\n  noteFontFamily = \"serif\";\n  sigFontSize = 14;\n\n  trackGap = 10;\n\n  lineGap = 20;\n\n  pointGap = 5;\n  tailPointGap = 8;\n  pointRound = 1.5;\n\n  pageE = 1.414;\n  notationWidth = 1000;\n  pageMarginHorizontal = 100;\n  pageMarginVertical = 110;\n\n  infoTitleFontSize = 34;\n  infoSubtitleFontSize = 22;\n  infoGap = 7;\n  infoFontSize = 20;\n\n  pageIndexFontSize = 20;\n\n  textFontFamily = \"serif\";\n}\n","export default class Dimens {\n  x: number;\n  y: number;\n  width: number;\n  height: number;\n  marginTop: number;\n  marginBottom: number;\n  marginLeft: number;\n  marginRight: number;\n  constructor() {\n    this.x = 0;\n    this.y = 0;\n    this.width = 0;\n    this.height = 0;\n    this.marginBottom = 0;\n    this.marginTop = 0;\n    this.marginLeft = 0;\n    this.marginRight = 0;\n  }\n  init(\n    x: number,\n    y: number,\n    width: number,\n    height: number,\n    marginHorizontal: number,\n    marginVertical: number\n  ) {\n    this.x = x;\n    this.y = y;\n    this.width = width;\n    this.height = height;\n    this.marginBottom = marginVertical;\n    this.marginTop = marginVertical;\n    this.marginLeft = marginHorizontal;\n    this.marginRight = marginHorizontal;\n  }\n  copyFrom(d: Dimens) {\n    this.x = d.x;\n    this.y = d.y;\n    this.width = d.width;\n    this.height = d.height;\n    this.marginBottom = d.marginBottom;\n    this.marginTop = d.marginTop;\n    this.marginLeft = d.marginLeft;\n    this.marginRight = d.marginRight;\n  }\n}\n","import React from \"react\";\nimport Dimens from \"./Dimens\";\n\nexport function border(\n  d: Dimens,\n  clazz: string,\n  show: boolean = false,\n  color: string = \"blue\"\n) {\n  let ifShow = false;\n  if (show || ifShow) {\n    return (\n      <rect\n        className={clazz + \"__border\"}\n        transform={\"translate(\" + d.marginLeft + \",\" + d.marginTop + \")\"}\n        width={d.width}\n        height={d.height}\n        stroke={color}\n        strokeWidth=\"0.4\"\n        fill=\"none\"\n      />\n    );\n  } else {\n    return <></>;\n  }\n}\n\nexport function outerBorder(\n  d: Dimens,\n  clazz: string,\n  show: boolean = false,\n  color: string = \"gray\"\n) {\n  if (show) {\n    return (\n      <rect\n        className={clazz + \"__outer-border\"}\n        transform={\"translate(0,0)\"}\n        width={d.width + d.marginLeft + d.marginRight}\n        height={d.height + d.marginTop + d.marginBottom}\n        stroke={color}\n        strokeWidth=\"0.4\"\n        fill=\"none\"\n      />\n    );\n  } else {\n    return <></>;\n  }\n}\n","import React from \"react\";\nimport Dimens from \"./Dimens\";\nimport { outerBorder } from \"./Border\";\nimport MuseConfig from \"./MuseConfig\";\nimport Codec from \"./Codec\";\nimport Fraction from \"./Fraction\";\nimport { INote } from \"./repo/schema\";\nimport { observable } from \"mobx\";\nimport { observer, useObserver } from \"mobx-react\";\n\nexport class Note implements Codec {\n  readonly config: MuseConfig;\n  @observable noteGroup: {\n    x: string;\n    n: string;\n    t: number;\n  }[] = [];\n  l: number = 0;\n  p: number = 0;\n  d: number = 0;\n  dx: number = 0;\n  @observable time: Fraction | null = null;\n  notesY: number[] = [];\n  pointsY: number[] = [];\n  tailPointsX: number[] = [];\n  @observable dimens: Dimens = new Dimens();\n  @observable isSelect: boolean = false;\n  constructor(o: any, config: MuseConfig) {\n    this.config = config;\n    this.decode(o);\n  }\n  settle() {\n    let width =\n      this.dx + this.config.noteWidth + this.p * this.config.tailPointGap;\n    let ny = 0;\n    let mb = 0;\n    mb += this.l * this.config.pointGap;\n    let py = 0;\n    this.noteGroup.forEach((it, idx) => {\n      if (it.t < 0) {\n        if (idx === 0) {\n          let i = -it.t;\n          for (; i > 0; --i) {\n            let x = this.config.pointGap;\n            mb += x / 2;\n            this.pointsY.push(-mb);\n            mb += x / 2;\n          }\n        }\n        if (idx !== 0) {\n          let i = -it.t;\n          for (; i > 0; --i) {\n            let x = this.config.pointGap;\n            py += x / 2;\n            this.pointsY.push(py);\n            py += x / 2;\n            ny += x;\n          }\n        }\n      }\n      this.notesY.push(ny);\n      let h = this.config.noteHeight;\n      ny += h;\n      py += h;\n      if (it.t > 0) {\n        let i = it.t;\n        for (; i > 0; --i) {\n          let x = this.config.pointGap;\n          py += x / 2;\n          this.pointsY.push(py);\n          py += x / 2;\n          ny += x;\n        }\n      }\n    });\n    for (let i = 0; i < this.p; ++i) {\n      this.tailPointsX.push(\n        this.dx + this.config.noteWidth + (i + 1 / 2) * this.config.tailPointGap\n      );\n    }\n    this.dimens.width = width;\n    this.dimens.height = ny;\n    this.dimens.marginBottom = mb;\n  }\n  decode(o: any): void {\n    if (o.n !== undefined) {\n      let n: string = o.n;\n      let pos = n.search(\"@\");\n      let ns = \"\";\n      let ts = \"\";\n      if (pos === -1) {\n        ns = n;\n        ts = \"0|0\";\n      } else {\n        ns = n.substr(0, pos);\n        ts = n.substr(pos + 1);\n      }\n      let ng = ns.split(\"|\");\n      ng.forEach((it) => {\n        for (let i = 0; i < it.length; ++i) {\n          if (\n            (it.charCodeAt(i) <= 57 && it.charCodeAt(i) >= 48) ||\n            it.charCodeAt(i) === 45\n          ) {\n            let x = it.substr(0, i);\n            let n = it.charAt(i);\n            let t = it.substr(i + 1).length;\n            if (t !== 0 && it.charAt(i + 1) === \"-\") {\n              t = -t;\n            }\n            this.noteGroup.push({ x, n, t });\n            if (x !== \"\") {\n              this.dx = this.config.sigFontSize / 2;\n            }\n            break;\n          }\n        }\n      });\n      let tg = ts.split(\"|\");\n      if (tg.length === 3) {\n        this.l = parseInt(tg[0]);\n        this.p = parseInt(tg[1]);\n        this.d = parseInt(tg[2]);\n      } else if (tg.length === 2) {\n        this.l = parseInt(tg[0]);\n        this.p = parseInt(tg[1]);\n        this.d = 1;\n      } else if (tg.length === 1) {\n        this.l = parseInt(tg[0]);\n        this.p = 0;\n        this.d = 1;\n      } else {\n        this.l = 0;\n        this.p = 0;\n        this.d = 1;\n      }\n    }\n    if (o.dimens !== undefined) {\n      this.dimens = o.dimens;\n    }\n  }\n  code(): INote {\n    let n = \"@\" + this.time?.toString();\n    return { n };\n  }\n}\n\nfunction castX(x: string) {\n  let m: Record<string, string> = {\n    S: \"#\",\n    F: \"b\",\n    DS: \"x\",\n    DF: \"d\",\n    N: \"n\",\n  };\n  return m[x] || \"\";\n}\n\nfunction noteGroup(note: Note, clazz: string) {\n  return (\n    <g className={clazz + \"__group-note\"}>\n      {note.noteGroup.map((it, idx) => {\n        return (\n          <g\n            className={clazz + \"__note-one\"}\n            key={idx}\n            width={note.dimens.width}\n            height={note.notesY[idx]}\n            transform={\n              \"translate(\" +\n              0 +\n              \",\" +\n              (note.dimens.height - note.notesY[idx]) +\n              \")\"\n            }\n          >\n            <text\n              fontFamily={note.config.noteFontFamily}\n              fontSize={note.config.noteFontSize}\n              transform={\"translate(\" + note.dx + \",\" + 0 + \")\"}\n            >\n              {it.n}\n            </text>\n            <text\n              fontFamily={note.config.noteFontFamily}\n              fontSize={note.config.sigFontSize}\n              transform={\n                \"translate(\" +\n                0 +\n                \",\" +\n                (note.config.sigFontSize - note.config.noteHeight) +\n                \")\"\n              }\n            >\n              {castX(it.x)}\n            </text>\n          </g>\n        );\n      })}\n    </g>\n  );\n}\n\nfunction pointGroup(note: Note, clazz: string) {\n  return (\n    <g className={clazz + \"__group-point\"}>\n      {note.pointsY.map((it, idx) => (\n        <circle\n          key={idx}\n          r={note.config.pointRound}\n          fill=\"black\"\n          transform={\n            \"translate(\" +\n            (note.dx + note.config.noteWidth / 2) +\n            \",\" +\n            (note.dimens.height - it + note.config.pointGap / 2) +\n            \")\"\n          }\n        />\n      ))}\n    </g>\n  );\n}\n\nfunction tailPoint(note: Note, clazz: string) {\n  return (\n    <g className={clazz + \"__tail-point\"}>\n      {note.tailPointsX.map((it, idx) => (\n        <circle\n          key={idx}\n          r={note.config.pointRound}\n          fill=\"black\"\n          transform={\n            \"translate(\" +\n            it +\n            \",\" +\n            (note.dimens.height - note.config.noteHeight / 3) +\n            \")\"\n          }\n        />\n      ))}\n    </g>\n  );\n}\n\n@observer\nclass MuseNote extends React.Component<{ note: Note }, {}> {\n  render() {\n    let note = this.props.note;\n    let d = note.dimens;\n    let clazz = \"muse-note\";\n    return (\n      <g\n        className={clazz}\n        transform={\n          \"translate(\" + (d.x - d.marginLeft) + \",\" + (d.y - d.marginTop) + \")\"\n        }\n        width={d.width + d.marginLeft + d.marginRight}\n        height={d.height + d.marginTop + d.marginBottom}\n        onClick={() => {\n          this.props.note.isSelect = !this.props.note.isSelect;\n          console.log(\"xxx\");\n        }}\n      >\n        {outerBorder(d, clazz, note.isSelect, \"blue\")}\n        {noteGroup(note, clazz)}\n        {pointGroup(note, clazz)}\n        {tailPoint(note, clazz)}\n      </g>\n    );\n  }\n}\n\n// const MuseNote: React.FC<{ note: Note }> = ({ note }) => {\n//   let n = useObserver(() => {\n//     return note;\n//   });\n//   let d = n.dimens;\n//   let clazz = \"muse-note\";\n//   return (\n//     <g\n//       className={clazz}\n//       transform={\n//         \"translate(\" + (d.x - d.marginLeft) + \",\" + (d.y - d.marginTop) + \")\"\n//       }\n//       width={d.width + d.marginLeft + d.marginRight}\n//       height={d.height + d.marginTop + d.marginBottom}\n//       onClick={() => {\n//         note.isSelect = !note.isSelect;\n//         console.log(\"xxx\");\n//       }}\n//     >\n//       {outerBorder(d, clazz, n.isSelect, \"blue\")}\n//       {noteGroup(n, clazz)}\n//       {pointGroup(n, clazz)}\n//       {tailPoint(n, clazz)}\n//     </g>\n//   );\n// };\n\nexport default MuseNote;\n","import React from \"react\";\nimport MuseConfig from \"./MuseConfig\";\nimport Dimens from \"./Dimens\";\nimport MuseNote, { Note } from \"./MuseNote\";\nimport { border } from \"./Border\";\nimport Codec from \"./Codec\";\nimport { IBar, INote } from \"./repo/schema\";\nimport { observable } from \"mobx\";\nimport { useObserver } from \"mobx-react\";\n\nexport class Bar implements Codec {\n  readonly config: MuseConfig;\n  @observable notes: Note[] = [];\n  @observable dimens: Dimens = new Dimens();\n  unitNum: number = 0;\n  notesX: number[] = [];\n  baselineGroup: {\n    y: number;\n    s: number;\n    e: number;\n  }[] = [];\n  constructor(o: any, config: MuseConfig) {\n    this.config = config;\n    this.decode(o);\n  }\n  generateBaseline() {\n    for (let i = 0; ; ++i) {\n      let x = 0;\n      let s = 0;\n      let e = -1;\n      this.notes.forEach((it, idx) => {\n        if (it.l > i) {\n          e = idx;\n          x++;\n        } else {\n          if (s <= e) this.baselineGroup.push({ y: i, s: s, e: e });\n          s = idx + 1;\n          e = idx;\n        }\n      });\n      if (s <= e) this.baselineGroup.push({ y: i, s: s, e: e });\n      if (x === 0) {\n        break;\n      }\n    }\n  }\n  decode(o: any): void {\n    if (o.notes !== undefined) {\n      o.notes.forEach((it: any) => {\n        this.notes.push(new Note(it, this.config));\n      });\n      this.generateBaseline();\n      this.notesX.push(1);\n      this.notes.forEach((note, idx) => {\n        let x = 0;\n        if (this.notes[idx + 1] === undefined) {\n          x += 1;\n        } else if (\n          this.notes[idx + 1] !== undefined &&\n          this.notes[idx + 1].l < note.l\n        ) {\n          x += Math.pow(2, -this.notes[idx + 1].l);\n        } else {\n          x += Math.pow(2, -note.l);\n        }\n        let q = 1;\n        for (let i = 1; i <= note.p; ++i) {\n          q += Math.pow(2, -i);\n        }\n        x *= q;\n        this.notesX.push(x);\n        this.unitNum += x;\n      });\n    }\n    if (o.dimens !== undefined) {\n      this.dimens = o.dimens;\n    }\n  }\n  code(): IBar {\n    let notes: INote[] = this.notes.map((it) => it.code());\n    return { notes };\n  }\n}\n\nfunction barLine(d: Dimens, clazz: string) {\n  return (\n    <line\n      className={clazz + \"__bar-line\"}\n      x1={d.marginLeft + d.width + d.marginRight}\n      y1={0}\n      x2={d.marginLeft + d.width + d.marginRight}\n      y2={d.height}\n      strokeWidth={1}\n      stroke=\"black\"\n    />\n  );\n}\n\nfunction baseLine(bar: Bar, clazz: string) {\n  return (\n    <g className={clazz + \"__base-line\"}>\n      {bar.baselineGroup.map((it, idx) => (\n        <line\n          key={idx}\n          x1={bar.notes[it.s].dimens.x}\n          y1={bar.notes[it.s].dimens.height + (it.y + 1) * bar.config.pointGap}\n          x2={bar.notes[it.e].dimens.x + bar.notes[it.e].dimens.width}\n          y2={bar.notes[it.s].dimens.height + (it.y + 1) * bar.config.pointGap}\n          stroke={\"black\"}\n          strokeWidth={1}\n        />\n      ))}\n    </g>\n  );\n}\n\nfunction MuseBar(props: { bar: Bar }) {\n  let bar = useObserver(() => {\n    return props.bar;\n  });\n  let d = bar.dimens;\n  let clazz = \"muse-bar\";\n  return (\n    <g\n      className={clazz}\n      transform={\n        \"translate(\" + (d.x - d.marginLeft) + \",\" + (d.y - d.marginTop) + \")\"\n      }\n      width={d.width + d.marginLeft + d.marginRight}\n      height={d.height + d.marginTop + d.marginBottom}\n    >\n      {border(d, clazz)}\n      {barLine(d, clazz)}\n      {baseLine(bar, clazz)}\n      {bar.notes.map((it, idx) => (\n        <MuseNote\n          key={idx}\n          note={it}\n        />\n      ))}\n    </g>\n  );\n}\n\nexport default MuseBar;\n","import React from \"react\";\nimport Dimens from \"./Dimens\";\nimport MuseConfig from \"./MuseConfig\";\nimport MuseBar, { Bar } from \"./MuseBar\";\nimport { border } from \"./Border\";\nimport Codec from \"./Codec\";\nimport { IBar, ITrack } from \"./repo/schema\";\nimport { observable } from \"mobx\";\nimport { useObserver } from \"mobx-react\";\n\nexport class Track implements Codec {\n  readonly config: MuseConfig;\n  @observable bars: Bar[] = [];\n  @observable dimens: Dimens = new Dimens();\n  constructor(o: any, config: MuseConfig) {\n    this.config = config;\n    this.decode(o);\n  }\n  decode(o: any): void {\n    if (o.bars !== undefined) {\n      o.bars.forEach((it: any) => {\n        this.bars.push(new Bar(it, this.config));\n      });\n    }\n    if (o.dimens !== undefined) {\n      this.dimens = o.dimens;\n    }\n  }\n  code(): ITrack {\n    let bars: IBar[] = this.bars.map((it) => it.code());\n    return { bars };\n  }\n}\n\nfunction MuseTrack(props: { track: Track }) {\n  let track = useObserver(() => {\n    return props.track;\n  });\n\n  let d = track.dimens;\n  let clazz = \"muse-track\";\n  return (\n    <g\n      className={clazz}\n      transform={\n        \"translate(\" + (d.x - d.marginLeft) + \",\" + (d.y - d.marginTop) + \")\"\n      }\n      width={d.width + d.marginLeft + d.marginRight}\n      height={d.height + d.marginTop + d.marginBottom}\n    >\n      {border(d, clazz)}\n      {track.bars.map((it, idx) => (\n        <MuseBar key={idx} bar={it} />\n      ))}\n    </g>\n  );\n}\n\nexport default MuseTrack;\n","import React from \"react\";\nimport Dimens from \"./Dimens\";\nimport MuseConfig from \"./MuseConfig\";\nimport MuseTrack, { Track } from \"./MuseTrack\";\nimport { border } from \"./Border\";\nimport Codec from \"./Codec\";\nimport { ILine, ITrack } from \"./repo/schema\";\nimport { observable } from \"mobx\";\nimport { useObserver } from \"mobx-react\";\n\nexport class Line implements Codec {\n  readonly config: MuseConfig;\n  @observable tracks: Track[] = [];\n  @observable dimens: Dimens = new Dimens();\n  constructor(o: any, config: MuseConfig) {\n    this.config = config;\n    this.decode(o);\n  }\n  decode(o: any): void {\n    if (o.tracks !== undefined) {\n      o.tracks.forEach((it: any) => {\n        this.tracks.push(new Track(it, this.config));\n      });\n    }\n    if (o.dimens !== undefined) {\n      this.dimens = o.dimens;\n    }\n  }\n  code(): ILine {\n    let tracks: ITrack[] = this.tracks.map((it) => it.code());\n    return { tracks };\n  }\n}\n\nfunction lineHead(d: Dimens, clazz: string) {\n  return (\n    <g className={clazz + \"__line-head\"}>\n      <line x1={0} y1={0} x2={0} y2={d.height} strokeWidth={1} stroke=\"black\" />\n    </g>\n  );\n}\n\nfunction MuseLine(props: { line: Line }) {\n  let line = useObserver(() => {\n    return props.line;\n  });\n\n  let d = line.dimens;\n  let clazz = \"muse-line\";\n  return (\n    <g\n      className={clazz}\n      transform={\n        \"translate(\" + (d.x - d.marginLeft) + \",\" + (d.y - d.marginTop) + \")\"\n      }\n      width={d.width + d.marginLeft + d.marginRight}\n      height={d.height + d.marginTop + d.marginBottom}\n    >\n      {border(d, clazz)}\n      {lineHead(d, clazz)}\n      {line.tracks.map((it, idx) => (\n        <MuseTrack key={idx} track={it} />\n      ))}\n    </g>\n  );\n}\n\nexport default MuseLine;\n","import React from \"react\";\nimport MuseConfig from \"./MuseConfig\";\nimport Dimens from \"./Dimens\";\nimport MuseLine, { Line } from \"./MuseLine\";\nimport { border, outerBorder } from \"./Border\";\nimport Codec from \"./Codec\";\nimport { ILine, IPage } from \"./repo/schema\";\nimport { observable } from \"mobx\";\nimport { useObserver } from \"mobx-react\";\n\nexport class Page implements Codec {\n  readonly config: MuseConfig;\n  @observable lines: Line[] = [];\n  @observable dimens: Dimens = new Dimens();\n  @observable index: number = 0;\n  constructor(o: any, config: MuseConfig) {\n    this.config = config;\n    this.decode(o);\n  }\n  decode(o: any): void {\n    if (o.lines !== undefined) {\n      o.lines.forEach((it: any) => {\n        this.lines.push(new Line(it, this.config));\n      });\n    }\n    if (o.dimens !== undefined) {\n      this.dimens = o.dimens;\n    }\n  }\n  code(): IPage {\n    let lines: ILine[] = this.lines.map((it) => it.code());\n    return { lines };\n  }\n}\n\nfunction pageIndex(idx: number, d: Dimens, clazz: string, config: MuseConfig) {\n  return (\n    <g\n      className={clazz + \"__page-index\"}\n      transform={\n        \"translate(\" +\n        (d.marginLeft + d.width / 2) +\n        \",\" +\n        (d.marginTop + d.height + d.marginBottom / 2) +\n        \")\"\n      }\n    >\n      <text\n        textAnchor={\"middle\"}\n        fontFamily={config.textFontFamily}\n        fontSize={config.pageIndexFontSize}\n      >\n        {idx.toString()}\n      </text>\n    </g>\n  );\n}\n\nfunction MusePage(props: { page: Page }) {\n  let page = useObserver(() => {\n    return props.page;\n  });\n\n  let d = page.dimens;\n  let clazz = \"muse-page\";\n  return (\n    <g\n      className={clazz}\n      transform={\n        \"translate(\" + (d.x - d.marginLeft) + \",\" + (d.y - d.marginTop) + \")\"\n      }\n      width={d.width + d.marginLeft + d.marginRight}\n      height={d.height + d.marginTop + d.marginBottom}\n    >\n      {border(d, clazz)}\n      {outerBorder(d, clazz, true)}\n      {pageIndex(page.index, d, clazz, page.config)}\n      {page.lines.map((it, idx) => (\n        <MuseLine\n          key={idx}\n          line={it}\n        />\n      ))}\n    </g>\n  );\n}\n\nexport default MusePage;\n","import { observable } from \"mobx\";\nimport { MobXProviderContext } from \"mobx-react\";\nimport React from \"react\";\nimport { Notation } from \"../MuseNotation\";\n\nexport class MuseRepo {\n  @observable\n  notation: Notation;\n\n  constructor(notation: Notation) {\n    this.notation = notation;\n  }\n}\n\nexport function useMuseRepo(): MuseRepo {\n  return React.useContext(MobXProviderContext).museRepo;\n}\n","import React from \"react\";\nimport MuseConfig from \"./MuseConfig\";\nimport Dimens from \"./Dimens\";\nimport MusePage, { Page } from \"./MusePage\";\nimport { border } from \"./Border\";\nimport Codec from \"./Codec\";\nimport { INotation, IPage } from \"./repo/schema\";\nimport { observable } from \"mobx\";\nimport { useMuseRepo } from \"./repo/muse-repo\";\nimport { useObserver } from \"mobx-react\";\n\nexport class Notation implements Codec {\n  readonly config: MuseConfig;\n  @observable pages: Page[] = [];\n  @observable title: string = \"\";\n  @observable subtitle: string = \"\";\n  @observable author: string[] = [];\n  @observable speed: string = \"\";\n  @observable rhythmic: string = \"\";\n  @observable C: string = \"\";\n  @observable dimens: Dimens = new Dimens();\n  constructor(json: string, config: MuseConfig) {\n    this.config = config;\n    let o: any = JSON.parse(json);\n    this.decode(o);\n  }\n  decode(o: any): void {\n    if (o.pages !== undefined) {\n      o.pages.forEach((it: any) => {\n        this.pages.push(new Page(it, this.config));\n      });\n    }\n    if (o.dimens !== undefined) {\n      this.dimens = o.dimens;\n    }\n    if (o.title !== undefined) {\n      this.title = o.title;\n    }\n    if (o.subtitle !== undefined) {\n      this.subtitle = o.subtitle;\n    }\n    if (o.author !== undefined) {\n      this.author = o.author.toString().split(\"|\");\n    }\n    if (o.speed !== undefined) {\n      this.speed = o.speed;\n    }\n    if (o.rhythmic) {\n      this.rhythmic = o.rhythmic;\n    }\n    if (o.C) {\n      this.C = \"1=\" + o.C;\n    }\n  }\n  code(): INotation {\n    let pages: IPage[] = this.pages.map((it) => it.code());\n    let author = this.author.reduce((p, c, idx) => {\n      if (idx === this.author.length - 1) {\n        return p + c;\n      } else {\n        return p + c + \"|\";\n      }\n    });\n    return {\n      title: this.title,\n      subtitle: this.subtitle,\n      author: author,\n      rhythmic: this.rhythmic,\n      speed: this.speed,\n      C: this.C,\n      pages,\n    };\n  }\n}\n\nfunction notationInfo(notation: Notation, clazz: string) {\n  let config = notation.config;\n  let y = 0;\n  y += config.pageMarginVertical;\n  let title = (\n    <text\n      className={clazz + \"__info-title\"}\n      fontFamily={config.textFontFamily}\n      width={notation.dimens.width}\n      textAnchor={\"middle\"}\n      fontSize={config.infoTitleFontSize}\n      transform={\n        \"translate(\" +\n        (notation.dimens.marginLeft + notation.dimens.width / 2) +\n        \",\" +\n        y +\n        \")\"\n      }\n    >\n      {notation.title}\n    </text>\n  );\n  y += config.infoTitleFontSize + config.infoGap;\n  let subtitle = (\n    <text\n      className={clazz + \"__info-subtitle\"}\n      fontFamily={config.textFontFamily}\n      width={notation.dimens.width}\n      textAnchor={\"middle\"}\n      fontSize={config.infoSubtitleFontSize}\n      transform={\n        \"translate(\" +\n        (notation.dimens.marginLeft + notation.dimens.width / 2) +\n        \",\" +\n        y +\n        \")\"\n      }\n    >\n      {notation.subtitle}\n    </text>\n  );\n  let y1 = y;\n  let x = notation.author.length;\n  let author = (\n    <g className={clazz + \"__info-author\"}>\n      {notation.author.map((it, idx) => {\n        y1 += config.infoFontSize + config.infoGap;\n        if (idx < x - 2) {\n          y += config.infoFontSize + config.infoGap;\n        }\n        return (\n          <text\n            key={idx}\n            fontFamily={config.textFontFamily}\n            width={notation.dimens.width}\n            fontSize={config.infoFontSize}\n            textAnchor={\"end\"}\n            x={0}\n            transform={\n              \"translate(\" +\n              (notation.dimens.width - config.pageMarginHorizontal) +\n              \",\" +\n              y1 +\n              \")\"\n            }\n          >\n            {it}\n          </text>\n        );\n      })}\n    </g>\n  );\n  let y2 = y + (config.infoGap + config.infoSubtitleFontSize);\n  let y3 = y2 + (config.infoGap + config.infoFontSize);\n  let rythimic = (\n    <g className={clazz + \"__info-rythmic\"} width={notation.dimens.width}>\n      <text\n        fontFamily={config.textFontFamily}\n        width={notation.dimens.width}\n        fontSize={config.infoFontSize}\n        transform={\"translate(\" + config.pageMarginHorizontal + \",\" + y2 + \")\"}\n      >\n        {notation.speed}\n      </text>\n      <text\n        fontFamily={config.textFontFamily}\n        width={notation.dimens.width}\n        fontSize={config.infoFontSize}\n        transform={\"translate(\" + config.pageMarginHorizontal + \",\" + y3 + \")\"}\n      >\n        {notation.C + \" \" + notation.rhythmic}\n      </text>\n    </g>\n  );\n  return (\n    <g className={clazz + \"__info\"} width={notation.dimens.width}>\n      {title}\n      {subtitle}\n      {author}\n      {rythimic}\n    </g>\n  );\n}\n\nconst MuseNotation: React.FC = () => {\n  const repo = useMuseRepo();\n  let notation = useObserver(() => {\n    return repo.notation;\n  });\n  let margin = 10;\n  let d = notation.dimens;\n  let clazz = \"muse-notation\";\n  return (\n    <svg\n      className=\"muse\"\n      width={notation.dimens.width + margin * 2}\n      height={notation.dimens.height + margin * 2}\n    >\n      <g\n        className={clazz}\n        transform={\"translate(\" + margin + \",\" + margin + \")\"}\n        width={notation.dimens.width}\n        height={notation.dimens.height}\n      >\n        {border(d, clazz)}\n        {notationInfo(notation, clazz)}\n        {notation.pages.map((it, idx) => (\n          <MusePage key={idx} page={it} />\n        ))}\n      </g>\n    </svg>\n  );\n};\n\nexport default MuseNotation;\n","import React from \"react\";\nimport MuseConfig from \"./MuseConfig\";\nimport MuseNotation, { Notation } from \"./MuseNotation\";\nimport { MuseRepo } from \"./repo/muse-repo\";\nimport { Provider } from \"mobx-react\";\n\nfunction init(data: string, config: MuseConfig): Notation {\n  let hm = config.pageMarginHorizontal;\n  let vm = config.pageMarginVertical;\n  let w = config.notationWidth - hm * 2;\n  let h = config.notationWidth * config.pageE - vm * 2;\n  let notation = new Notation(data, config);\n  let notationH = 0;\n  notation.pages.forEach((page, pageIdx) => {\n    page.dimens.x = hm;\n    page.dimens.y = vm * (pageIdx + 1) + (vm + h) * pageIdx;\n    page.dimens.width = w;\n    page.dimens.marginLeft = hm;\n    page.dimens.marginRight = hm;\n    page.dimens.height = h;\n    page.dimens.marginTop = vm;\n    page.dimens.marginBottom = vm;\n    if (pageIdx === 0) {\n      let x = 0;\n      x += config.infoTitleFontSize + config.infoGap;\n      x += config.infoSubtitleFontSize + config.infoGap;\n      x += notation.author.length * (config.infoFontSize + config.infoGap);\n      page.dimens.marginTop += x;\n      page.dimens.height -= x;\n      page.dimens.y += x;\n    }\n    page.index = pageIdx + 1;\n    notationH +=\n      page.dimens.marginTop + page.dimens.marginBottom + page.dimens.height;\n    let linesHeight: number[] = [];\n    let lineYSpace = page.dimens.height;\n    page.lines.forEach((line) => {\n      line.dimens.width = page.dimens.width;\n      line.dimens.x = page.dimens.marginLeft;\n      let lineHeight = 0;\n      let trackY = 0;\n      let barsW: number[] = [];\n      line.tracks.forEach((track) => {\n        track.bars.forEach((bar, barIdx) => {\n          if (barsW[barIdx] !== undefined) {\n            barsW[barIdx] =\n              barsW[barIdx] > bar.unitNum ? barsW[barIdx] : bar.unitNum;\n          } else {\n            barsW.push(bar.unitNum);\n          }\n        });\n      });\n      let barUnitSum = barsW.reduce((s, it) => s + it);\n      line.tracks.forEach((track) => {\n        let trackHeight = 0;\n        track.dimens.y = trackY;\n        track.dimens.width = line.dimens.width;\n        let maxNoteHeight = 0; //最大note.y\n        let maxNoteMarginBottom = 0;\n        let barX = 0;\n        track.bars.forEach((bar, barIdx) => {\n          bar.unitNum = barsW[barIdx];\n          bar.dimens.width = (barsW[barIdx] / barUnitSum) * track.dimens.width;\n          bar.dimens.x = barX;\n          barX += bar.dimens.width;\n          let notesWidth: number[] = [];\n          bar.notes.forEach((note) => {\n            note.settle();\n            let noteWidth = note.dimens.width;\n            let noteHeight = note.dimens.height;\n            let noteMarginBootom = note.dimens.marginBottom;\n            maxNoteHeight =\n              maxNoteHeight > noteHeight ? maxNoteHeight : noteHeight;\n            maxNoteMarginBottom =\n              maxNoteMarginBottom > noteMarginBootom\n                ? maxNoteMarginBottom\n                : noteMarginBootom;\n            notesWidth.push(noteWidth);\n          });\n          let x = 0;\n          bar.notes.forEach((note, idx) => {\n            x += (bar.notesX[idx] / (bar.unitNum + 1)) * bar.dimens.width;\n            note.dimens.x = x - config.noteWidth / 2 - note.dx;\n          });\n        });\n        track.dimens.height = maxNoteHeight + maxNoteMarginBottom;\n        track.bars.forEach((bar) => {\n          bar.dimens.height = track.dimens.height;\n          bar.notes.forEach((note) => {\n            note.dimens.height = maxNoteHeight;\n            note.dimens.marginBottom = maxNoteMarginBottom;\n          });\n        });\n        trackHeight = maxNoteHeight + maxNoteMarginBottom;\n        lineHeight += trackHeight + config.trackGap;\n        trackY += trackHeight + config.trackGap;\n      });\n      lineHeight -= config.trackGap;\n      line.dimens.height = lineHeight;\n      lineYSpace -= lineHeight;\n      linesHeight.push(lineHeight);\n    });\n    let lineYUnit = lineYSpace / (page.lines.length - 1);\n    page.lines.forEach((line, idx) => {\n      let py = page.dimens.marginTop;\n      for (let i = 0; i < idx; ++i) {\n        py += lineYUnit + linesHeight[i];\n      }\n      line.dimens.y = py;\n    });\n  });\n  notation.dimens.width = w + 2 * hm;\n  notation.dimens.height = notationH;\n  return notation;\n}\n\nfunction Muse(props: { data: string; config?: MuseConfig }) {\n  let notation = init(\n    props.data,\n    props.config ? props.config : new MuseConfig()\n  );\n  let repo = new MuseRepo(notation);\n  return (\n    <Provider museRepo={repo}>\n      <MuseNotation />\n    </Provider>\n  );\n}\n\nexport default Muse;\n","import React from \"react\";\nimport \"./App.css\";\nimport Muse from \"./muse/Muse\";\n\nclass App extends React.Component<\n  {},\n  {\n    error: any | null;\n    isLoaded: boolean;\n    data: string;\n  }\n> {\n  constructor(props: {}) {\n    super(props);\n    this.state = {\n      error: null,\n      isLoaded: false,\n      data: \"\",\n    };\n  }\n\n  componentDidMount() {\n    let url = \"https://cdn.jsdelivr.net/gh/shizuku/muse-react/test/data/b.json\";\n    // let url = \"http://localhost:8888/b.json\";\n    fetch(url)\n      .then((res) => res.text())\n      .then(\n        (result) => {\n          this.setState({\n            isLoaded: true,\n            data: result,\n          });\n        },\n        (error) => {\n          this.setState({\n            isLoaded: true,\n            error: error,\n          });\n        }\n      );\n  }\n\n  render() {\n    return (\n      <div className=\"app\">\n        <h1>Example</h1>\n        {this.state.isLoaded ? (\n          this.state.error ? (\n            \"error\"\n          ) : (\n            <Muse data={this.state.data} />\n          )\n        ) : (\n          \"loading...\"\n        )}\n      </div>\n    );\n  }\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}