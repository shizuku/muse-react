(this["webpackJsonpmuse-react"]=this["webpackJsonpmuse-react"]||[]).push([[0],{21:function(t,e,i){t.exports=i(29)},26:function(t,e,i){},27:function(t,e,i){},29:function(t,e,i){"use strict";i.r(e);var n=i(0),o=i.n(n),r=i(18),a=i.n(r),s=(i(26),i(5)),c=i(4),p=i(7),h=i(6),u=(i(27),function t(){Object(s.a)(this,t),this.noteHeight=22,this.noteWidth=11,this.noteFontSize=22,this.noteFontFamily="serif",this.sigFontSize=14,this.trackGap=10,this.lineGap=40,this.pointGap=5,this.tailPointGap=8,this.pointRound=1.5,this.pageE=1.414,this.pageWidth=1e3,this.pageMarginHorizontal=100,this.pageMarginVertical=110,this.infoTitleFontSize=34,this.infoSubtitleFontSize=22,this.infoGap=7,this.infoFontSize=20,this.pageIndexFontSize=20,this.textFontFamily="serif",this.showBorder=!1}),l=i(3),f=i(2),g=(i(9),i(10)),b=i(15),y=function(t){var e=t.w,i=t.h,n=t.x,r=t.y,a=t.clazz,s=t.show,c=void 0!==s&&s,p=t.color,h=void 0===p?"blue":p;return c?o.a.createElement("rect",{className:a+"__border",transform:"translate("+n+","+r+")",width:e,height:i,stroke:h,strokeWidth:"0.4",fill:"none"}):o.a.createElement(o.a.Fragment,null)},d=function(t){var e=t.w,i=t.h,n=t.clazz,r=t.show,a=void 0!==r&&r,s=t.color,c=void 0===s?"gray":s;return a?o.a.createElement("rect",{className:n+"__outer-border",transform:"translate(0,0)",width:e,height:i,stroke:c,strokeWidth:"0.4",fill:"none"}):o.a.createElement(o.a.Fragment,null)},m=function(){function t(){Object(s.a)(this,t),this.u=0,this.d=1}return Object(c.a)(t,[{key:"parse",value:function(t){var e=t.search("/");return-1!==e?(this.u=parseInt(t.substr(0,e)),this.d=parseInt(t.substr(e+1))):this.u=parseInt(t),this}},{key:"init",value:function(t,e){return this.u=t,this.d=e,this}},{key:"gcd",value:function(t,e){for(;0!==e;){var i=e;e=t%e,t=i}return t}},{key:"simplify",value:function(){for(var t;(t=this.gcd(this.u,this.d))>1||t<-1;)this.u/=t,this.d/=t;return this}},{key:"plus",value:function(e){var i=new t;return i.u=this.u*e.d+this.d*e.u,i.d=this.d*e.d,i.simplify()}},{key:"minus",value:function(e){var i=new t;return i.u=this.u*e.d-this.d*e.u,i.d=this.d*e.d,i.simplify()}},{key:"multiply",value:function(e){var i=new t;return i.u=this.u*e.u,i.d=this.d*e.d,i.simplify()}},{key:"divide",value:function(e){var i=new t;return i.u=this.u*e.d,i.d=this.d*e.u,i.simplify()}},{key:"toNumber",value:function(){return this.u/this.d}},{key:"toString",value:function(){return 1===this.d?"".concat(this.u):"".concat(this.u,"/").concat(this.d)}}]),t}(),O=i(1),j=i(8),k=function(){function t(){var e=this;Object(s.a)(this,t),this.subnote=null,this.note=null,this.bar=null,this.track=null,this.line=null,this.page=null,document.addEventListener("keydown",(function(t){var i;if(null!==e.subnote)if("Enter"===t.key)e.subnote.setSelect(!1),e.subnote=null,null===(i=e.note)||void 0===i||i.setSelect(!0);else if("Backspace"===t.key){var n,o;null===(n=e.note)||void 0===n||n.removeSubNote(e.subnote.getThis().index),null===(o=e.note)||void 0===o||o.setSelect(!0),e.subnote.setSelect(!1),e.subnote=null}else if("ArrowUp"===t.key){if(e.note)e.note.getThis().subNotes.length>e.subnote.getThis().index+1&&(e.subnote.setSelect(!1),e.subnote=e.note.getThis().subNotes[e.subnote.getThis().index+1],e.subnote.setSelect(!0));t.returnValue=!1}else"ArrowDown"===t.key?(e.note&&e.subnote.getThis().index>0&&(e.subnote.setSelect(!1),e.subnote=e.note.getThis().subNotes[e.subnote.getThis().index-1],e.subnote.setSelect(!0)),t.returnValue=!1):t.key>="0"&&t.key<="9"||"-"===t.key?e.subnote.setNum(t.key):"r"===t.key?e.subnote.reducePoint(1):"f"===t.key?e.subnote.reducePoint(-1):"q"===t.key?e.subnote.reduceLine(-1):"a"===t.key?e.subnote.reduceLine(1):"s"===t.key?e.subnote.reduceTailPoint(-1):"d"===t.key&&e.subnote.reduceTailPoint(1);else if(null!==e.note){var r;if("Enter"===t.key)e.note.setSelect(!1),e.note=null,null===(r=e.bar)||void 0===r||r.setSelect(!0);else if(" "===t.key)e.note.addSubNote("0"),t.returnValue=!1;else if("Backspace"===t.key);else if("ArrowUp"===t.key)e.subnote=e.note.getThis().subNotes[0],e.subnote.setSelect(!0),e.note.setSelect(!1),t.returnValue=!1;else if("ArrowDown"===t.key){var a=e.note.getThis().subNotes.length;e.subnote=e.note.getThis().subNotes[a-1],e.subnote.setSelect(!0),e.note.setSelect(!1),t.returnValue=!1}else"q"===t.key?e.note.reduceLine(-1):"a"===t.key?e.note.reduceLine(1):"s"===t.key?e.note.reduceTailPoint(-1):"d"===t.key&&e.note.reduceTailPoint(1)}else if(null!==e.bar){var s;if("Enter"===t.key)e.bar.setSelect(!1),e.bar=null,null===(s=e.track)||void 0===s||s.setSelect(!0);else(" "===t.key||"Backspace"===t.key)&&(t.returnValue=!1)}else if(null!==e.track){var c;if("Enter"===t.key)e.track.setSelect(!1),e.track=null,null===(c=e.line)||void 0===c||c.setSelect(!0);else(" "===t.key||"Backspace"===t.key)&&(t.returnValue=!1)}else if(null!==e.line){var p;if("Enter"===t.key)e.line.setSelect(!1),e.line=null,null===(p=e.page)||void 0===p||p.setSelect(!0);else(" "===t.key||"Backspace"===t.key)&&(t.returnValue=!1)}else null!==e.page&&" "===t.key&&(t.returnValue=!1)}))}return Object(c.a)(t,[{key:"selectSubNote",value:function(t){var e;null===(e=this.subnote)||void 0===e||e.setSelect(!1),this.subnote=t,this.subnote.setSelect(!0),this.selectNote(t.getThis().note)}},{key:"selectNote",value:function(t){var e;null===(e=this.note)||void 0===e||e.setSelect(!1),this.note=t,null===this.subnote&&this.note.setSelect(!0),this.selectBar(t.getThis().bar)}},{key:"selectBar",value:function(t){var e;null===(e=this.bar)||void 0===e||e.setSelect(!1),this.bar=t,null===this.note&&this.bar.setSelect(!0),this.selectTrack(t.getThis().track)}},{key:"selectTrack",value:function(t){var e;null===(e=this.track)||void 0===e||e.setSelect(!1),this.track=t,null===this.bar&&this.track.setSelect(!0),this.selectLine(t.getThis().line)}},{key:"selectLine",value:function(t){var e;null===(e=this.line)||void 0===e||e.setSelect(!1),this.line=t,null===this.track&&this.line.setSelect(!0),this.selectPage(t.getThis().page)}},{key:"selectPage",value:function(t){var e;null===(e=this.page)||void 0===e||e.setSelect(!1),this.page=t,null===this.line&&this.page.setSelect(!0)}}]),t}();k.instance=new k;var v,w,x,S,z,E,N,P,M,T,D,F,W,B,H,G=k,_=(v=function(){function t(e,i,n,o,r,a){Object(s.a)(this,t),Object(l.a)(this,"isSelect",w,this),this.note=void 0,this.index=void 0,this.config=void 0,Object(l.a)(this,"x",x,this),Object(l.a)(this,"n",S,this),Object(l.a)(this,"t",z,this),this.x=e,this.n=i,this.t=n,this.note=o,this.index=r,this.config=a}return Object(c.a)(t,[{key:"setSelect",value:function(t){this.isSelect=t}},{key:"setNum",value:function(t){this.n=t}},{key:"reducePoint",value:function(t){this.t+=t}},{key:"reduceLine",value:function(t){this.note.l+=t,this.note.l<0&&(this.note.l=0)}},{key:"reduceTailPoint",value:function(t){this.note.p+=t,this.note.p<0&&(this.note.p=0)}},{key:"getThis",value:function(){return this}}]),t}(),w=Object(f.a)(v.prototype,"isSelect",[O.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),x=Object(f.a)(v.prototype,"x",[O.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),S=Object(f.a)(v.prototype,"n",[O.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),z=Object(f.a)(v.prototype,"t",[O.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),v),C=(E=function(){function t(e,i,n){Object(s.a)(this,t),this.config=void 0,Object(l.a)(this,"index",N,this),Object(l.a)(this,"bar",P,this),Object(l.a)(this,"subNotes",M,this),Object(l.a)(this,"l",T,this),Object(l.a)(this,"p",D,this),Object(l.a)(this,"d",F,this),Object(l.a)(this,"isSelect",W,this),this.config=i.config,this.bar=i,this.index=n,this.decode(e)}return Object(c.a)(t,[{key:"dx",get:function(){var t=!1;return this.subNotes.forEach((function(e){""!==e.x&&(t=!0)})),t?this.config.sigFontSize/2:0}},{key:"time",get:function(){var t=new m;return t.u=1,t.d*=Math.pow(2,this.l),t.d*=this.d,t.d*=Math.pow(2,this.p),t.u*=Math.pow(2,this.p+1)-1,t.simplify()}},{key:"notesY",get:function(){var t=this,e=[],i=0;return this.subNotes.forEach((function(n,o){if(n.t<0&&0!==o)for(var r=-n.t;r>0;--r){var a=t.config.pointGap;i+=a}e.push(i);var s=t.config.noteHeight;if(i+=s,n.t>0)for(var c=n.t;c>0;--c){var p=t.config.pointGap;i+=p}})),e}},{key:"pointsY",get:function(){var t=this,e=[],i=0,n=0,o=0;return o+=this.l*this.config.pointGap,this.subNotes.forEach((function(r,a){if(r.t<0){if(0===a)for(var s=-r.t;s>0;--s){var c=t.config.pointGap;o+=c/2,e.push(-o),o+=c/2}if(0!==a)for(var p=-r.t;p>0;--p){var h=t.config.pointGap;i+=h/2,e.push(i),i+=h/2,n+=h}}t.notesY.push(n);var u=t.config.noteHeight;if(n+=u,i+=u,r.t>0)for(var l=r.t;l>0;--l){var f=t.config.pointGap;i+=f/2,e.push(i),i+=f/2,n+=f}})),e}},{key:"tailPointsX",get:function(){for(var t=[],e=0;e<this.p;++e)t.push(this.dx+this.config.noteWidth+(e+.5)*this.config.tailPointGap);return t}},{key:"width",get:function(){return this.dx+this.config.noteWidth+this.p*this.config.tailPointGap}},{key:"preHeight",get:function(){var t=this,e=0;return this.subNotes.forEach((function(i,n){if(i.t<0&&0!==n)for(var o=-i.t;o>0;--o){var r=t.config.pointGap;e+=r}if(e+=t.config.noteHeight,i.t>0)for(var a=i.t;a>0;--a){var s=t.config.pointGap;e+=s}})),e}},{key:"height",get:function(){return this.bar.notesMaxHeight}},{key:"x",get:function(){return this.bar.notesX[this.index]}},{key:"preMarginBottom",get:function(){var t=this,e=0;return e+=this.l*this.config.pointGap,this.subNotes.forEach((function(i,n){if(i.t<0&&0===n)for(var o=-i.t;o>0;--o){var r=t.config.pointGap;e+=r}})),e}},{key:"marginBottom",get:function(){return this.bar.notesMaxMarginBottom}}]),Object(c.a)(t,[{key:"setSelect",value:function(t){this.isSelect=t}},{key:"reduceLine",value:function(t){this.l+=t,this.l<0&&(this.l=0)}},{key:"reduceTailPoint",value:function(t){this.p+=t,this.p<0&&(this.p=0)}},{key:"addSubNote",value:function(t){this.subNotes.push(new _("",t,0,this,this.subNotes.length,this.config)),G.instance.selectSubNote(this.subNotes[this.subNotes.length-1])}},{key:"removeSubNote",value:function(t){this.subNotes=this.subNotes.filter((function(e){return e.index!==t}))}},{key:"getThis",value:function(){return this}},{key:"decode",value:function(t){var e=this;if(void 0!==t.n){var i=t.n,n=i.search("@"),o="",r="";-1===n?(o=i,r="0|0"):(o=i.substr(0,n),r=i.substr(n+1)),o.split("|").forEach((function(t,i){for(var n=0;n<t.length;++n)if(t.charCodeAt(n)<=57&&t.charCodeAt(n)>=48||45===t.charCodeAt(n)){var o=t.substr(0,n),r=t.charAt(n),a=t.substr(n+1).length;0!==a&&"-"===t.charAt(n+1)&&(a=-a),e.subNotes.push(new _(o,r,a,e,i,e.config));break}}));var a=r.split("|");3===a.length?(this.l=parseInt(a[0]),this.p=parseInt(a[1]),this.d=parseInt(a[2])):2===a.length?(this.l=parseInt(a[0]),this.p=parseInt(a[1]),this.d=1):1===a.length?(this.l=parseInt(a[0]),this.p=0,this.d=1):(this.l=0,this.p=0,this.d=1)}}},{key:"code",value:function(){var t=this,e="";return this.subNotes.forEach((function(i,n){var o="";if(i.t>0)for(var r=0;r<i.t;++r)o+="+";else for(var a=0;a<-i.t;++a)o+="-";n+1>=t.subNotes.length?e+="".concat(i.x).concat(i.n).concat(o):e+="".concat(i.x).concat(i.n).concat(o,"|")})),{n:"".concat(e,"@").concat(this.l,"|").concat(this.p)}}}]),t}(),N=Object(f.a)(E.prototype,"index",[O.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),P=Object(f.a)(E.prototype,"bar",[O.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),M=Object(f.a)(E.prototype,"subNotes",[O.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),T=Object(f.a)(E.prototype,"l",[O.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),D=Object(f.a)(E.prototype,"p",[O.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),F=Object(f.a)(E.prototype,"d",[O.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Object(f.a)(E.prototype,"dx",[O.f],Object.getOwnPropertyDescriptor(E.prototype,"dx"),E.prototype),Object(f.a)(E.prototype,"time",[O.f],Object.getOwnPropertyDescriptor(E.prototype,"time"),E.prototype),Object(f.a)(E.prototype,"notesY",[O.f],Object.getOwnPropertyDescriptor(E.prototype,"notesY"),E.prototype),Object(f.a)(E.prototype,"pointsY",[O.f],Object.getOwnPropertyDescriptor(E.prototype,"pointsY"),E.prototype),Object(f.a)(E.prototype,"tailPointsX",[O.f],Object.getOwnPropertyDescriptor(E.prototype,"tailPointsX"),E.prototype),Object(f.a)(E.prototype,"width",[O.f],Object.getOwnPropertyDescriptor(E.prototype,"width"),E.prototype),Object(f.a)(E.prototype,"preHeight",[O.f],Object.getOwnPropertyDescriptor(E.prototype,"preHeight"),E.prototype),Object(f.a)(E.prototype,"height",[O.f],Object.getOwnPropertyDescriptor(E.prototype,"height"),E.prototype),Object(f.a)(E.prototype,"x",[O.f],Object.getOwnPropertyDescriptor(E.prototype,"x"),E.prototype),Object(f.a)(E.prototype,"preMarginBottom",[O.f],Object.getOwnPropertyDescriptor(E.prototype,"preMarginBottom"),E.prototype),Object(f.a)(E.prototype,"marginBottom",[O.f],Object.getOwnPropertyDescriptor(E.prototype,"marginBottom"),E.prototype),W=Object(f.a)(E.prototype,"isSelect",[O.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),E);var L,Y,V,A,I,X,R,J,q,U,$,K,Q,Z,tt,et,it,nt,ot,rt,at,st,ct,pt,ht,ut,lt,ft,gt=Object(j.a)(B=function(t){Object(p.a)(i,t);var e=Object(h.a)(i);function i(){return Object(s.a)(this,i),e.apply(this,arguments)}return Object(c.a)(i,[{key:"render",value:function(){var t=this;return o.a.createElement("g",{className:"muse-note__subnote",transform:"translate(0,"+this.props.y+")",width:this.props.w,height:this.props.h,onClick:function(){G.instance.selectSubNote(t.props.subNote)}},o.a.createElement("text",{fontFamily:this.props.subNote.config.noteFontFamily,fontSize:this.props.subNote.config.noteFontSize,transform:"translate("+this.props.dx+",0)"},this.props.subNote.n),o.a.createElement("text",{fontFamily:this.props.subNote.config.noteFontFamily,fontSize:this.props.subNote.config.sigFontSize,transform:"translate(0,"+(this.props.subNote.config.sigFontSize-this.props.subNote.config.noteHeight)+")"},{S:"#",F:"b",DS:"x",DF:"d",N:"n"}[this.props.subNote.x]||""),o.a.createElement(y,{x:0,y:-this.props.h,w:this.props.w,h:this.props.subNote.config.noteFontSize,clazz:"muse-note__subnote",show:this.props.subNote.isSelect}))}}]),i}(o.a.Component))||B,bt=Object(j.a)(H=function(t){Object(p.a)(i,t);var e=Object(h.a)(i);function i(){return Object(s.a)(this,i),e.apply(this,arguments)}return Object(c.a)(i,[{key:"render",value:function(){var t=this,e="muse-note";return o.a.createElement("g",{className:e,transform:"translate("+this.props.note.x+",0)",width:this.props.note.width,height:this.props.note.height,onClick:function(){G.instance.selectNote(t.props.note)}},o.a.createElement(d,{w:this.props.note.width,h:this.props.note.height+this.props.note.marginBottom,clazz:e,show:this.props.note.isSelect,color:"blue"}),this.props.note.subNotes.map((function(e,i){return o.a.createElement(gt,{key:i,dx:t.props.note.dx,y:t.props.note.height-t.props.note.notesY[i],w:t.props.note.width,h:22,subNote:e})})),function(t,e){return o.a.createElement("g",{className:e+"__group-point"},t.pointsY.map((function(e,i){return o.a.createElement("circle",{key:i,r:t.config.pointRound,fill:"black",transform:"translate("+(t.dx+t.config.noteWidth/2)+","+(t.height-e+t.config.pointGap/2)+")"})})))}(this.props.note,e),function(t,e){return o.a.createElement("g",{className:e+"__tail-point"},t.tailPointsX.map((function(e,i){return o.a.createElement("circle",{key:i,r:t.config.pointRound,fill:"black",transform:"translate("+e+","+(t.height-t.config.noteHeight/3)+")"})})))}(this.props.note,e))}}]),i}(o.a.Component))||H,yt=i(14),dt=(L=function(){function t(e,i,n,o){Object(s.a)(this,t),this.config=void 0,this.index=void 0,Object(l.a)(this,"track",Y,this),Object(l.a)(this,"notes",V,this),Object(l.a)(this,"isSelect",A,this),this.index=i,this.track=n,this.config=o,this.decode(e)}return Object(c.a)(t,[{key:"width",get:function(){return this.track.barsWidth[this.index]}},{key:"height",get:function(){var t=0;return this.notes.forEach((function(e){var i=e.height+e.marginBottom;t=i>t?i:t})),t}},{key:"x",get:function(){return this.track.barsX[this.index]}},{key:"y",get:function(){return 0}},{key:"notesTime",get:function(){return this.notes.map((function(t){return t.time}))}},{key:"notesTimeSum",get:function(){return this.notesTime.reduce((function(t,e){return t.plus(e)}),new m).plus((new m).init(1,1))}},{key:"notesWidth",get:function(){return this.notes.map((function(t){return t.width}))}},{key:"notesX",get:function(){var t=this,e=this.width-this.notesWidthSum,i=(new m).init(e,1).divide(this.notesTimeSum),n=i.toNumber();return this.notesWidth.map((function(e,o){var r=n;return n+=e+t.notesTime[o].multiply(i).toNumber(),r}))}},{key:"preNotesMaxHeight",get:function(){return Math.max.apply(Math,Object(g.a)(this.notes.map((function(t){return t.preHeight}))))}},{key:"notesMaxHeight",get:function(){return this.track.notesMaxHeight}},{key:"preNotesMaxMarginBottom",get:function(){return Math.max.apply(Math,Object(g.a)(this.notes.map((function(t){return t.preMarginBottom}))))}},{key:"notesMaxMarginBottom",get:function(){return this.track.notesMaxMarginBottom}},{key:"baselineGroup",get:function(){for(var t=this,e=[],i=function(i){var n=0,o=0,r=-1;if(t.notes.forEach((function(t,a){t.l>i?(r=a,n++):(o<=r&&e.push({y:i,s:o,e:r}),o=a+1,r=a)})),o<=r&&e.push({y:i,s:o,e:r}),0===n)return"break"},n=0;;++n){if("break"===i(n))break}return e}},{key:"notesWidthSum",get:function(){var t=0;return this.notes.forEach((function(e){return t+=e.width})),t}}]),Object(c.a)(t,[{key:"setSelect",value:function(t){this.isSelect=t}},{key:"getThis",value:function(){return this}},{key:"decode",value:function(t){var e=this;void 0!==t.notes&&t.notes.forEach((function(t,i){e.notes.push(new C(t,e,i))}))}},{key:"code",value:function(){return{notes:this.notes.map((function(t){return t.code()}))}}}]),t}(),Y=Object(f.a)(L.prototype,"track",[O.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),V=Object(f.a)(L.prototype,"notes",[O.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),A=Object(f.a)(L.prototype,"isSelect",[O.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Object(f.a)(L.prototype,"width",[O.f],Object.getOwnPropertyDescriptor(L.prototype,"width"),L.prototype),Object(f.a)(L.prototype,"height",[O.f],Object.getOwnPropertyDescriptor(L.prototype,"height"),L.prototype),Object(f.a)(L.prototype,"x",[O.f],Object.getOwnPropertyDescriptor(L.prototype,"x"),L.prototype),Object(f.a)(L.prototype,"y",[O.f],Object.getOwnPropertyDescriptor(L.prototype,"y"),L.prototype),Object(f.a)(L.prototype,"notesTime",[O.f],Object.getOwnPropertyDescriptor(L.prototype,"notesTime"),L.prototype),Object(f.a)(L.prototype,"notesTimeSum",[O.f],Object.getOwnPropertyDescriptor(L.prototype,"notesTimeSum"),L.prototype),Object(f.a)(L.prototype,"notesWidth",[O.f],Object.getOwnPropertyDescriptor(L.prototype,"notesWidth"),L.prototype),Object(f.a)(L.prototype,"notesX",[O.f],Object.getOwnPropertyDescriptor(L.prototype,"notesX"),L.prototype),Object(f.a)(L.prototype,"preNotesMaxHeight",[O.f],Object.getOwnPropertyDescriptor(L.prototype,"preNotesMaxHeight"),L.prototype),Object(f.a)(L.prototype,"notesMaxHeight",[O.f],Object.getOwnPropertyDescriptor(L.prototype,"notesMaxHeight"),L.prototype),Object(f.a)(L.prototype,"preNotesMaxMarginBottom",[O.f],Object.getOwnPropertyDescriptor(L.prototype,"preNotesMaxMarginBottom"),L.prototype),Object(f.a)(L.prototype,"notesMaxMarginBottom",[O.f],Object.getOwnPropertyDescriptor(L.prototype,"notesMaxMarginBottom"),L.prototype),Object(f.a)(L.prototype,"baselineGroup",[O.f],Object.getOwnPropertyDescriptor(L.prototype,"baselineGroup"),L.prototype),Object(f.a)(L.prototype,"notesWidthSum",[O.f],Object.getOwnPropertyDescriptor(L.prototype,"notesWidthSum"),L.prototype),L),mt=function(t){var e=Object(yt.a)((function(){return[t.w,t.h]})),i=Object(b.a)(e,2),n=i[0],r=i[1];return o.a.createElement("line",{className:t.clazz+"__bar-line",x1:n,y1:0,x2:n,y2:r,strokeWidth:1,stroke:"black"})},Ot=function(t){var e=t.bar,i=t.clazz,n=Object(yt.a)((function(){return[e.baselineGroup,e.notes]})),r=Object(b.a)(n,2),a=r[0],s=r[1];return o.a.createElement("g",{className:i+"__base-line"},a.map((function(t,i){return o.a.createElement("line",{key:i,x1:s[t.s].x,y1:s[t.s].height+(t.y+1)*e.config.pointGap,x2:s[t.e].x+e.notes[t.e].width,y2:s[t.s].height+(t.y+1)*e.config.pointGap,stroke:"black",strokeWidth:1})})))},jt=Object(j.a)(I=function(t){Object(p.a)(i,t);var e=Object(h.a)(i);function i(){return Object(s.a)(this,i),e.apply(this,arguments)}return Object(c.a)(i,[{key:"render",value:function(){var t=this.props.bar.notes,e="muse-bar";return o.a.createElement("g",{className:e,transform:"translate("+this.props.bar.x+","+this.props.bar.y+")",width:this.props.bar.width,height:this.props.bar.height},o.a.createElement(y,{w:this.props.bar.width,h:this.props.bar.height,x:0,y:0,clazz:e,show:this.props.bar.isSelect}),o.a.createElement(mt,{w:this.props.bar.width,h:this.props.bar.height,clazz:e}),t.map((function(t,e){return o.a.createElement(bt,{key:e,note:t})})),o.a.createElement(Ot,{bar:this.props.bar,clazz:e}))}}]),i}(o.a.Component))||I,kt=(X=function(){function t(e,i,n,o){Object(s.a)(this,t),this.config=void 0,this.index=void 0,this.line=void 0,Object(l.a)(this,"bars",R,this),Object(l.a)(this,"isSelect",J,this),this.index=i,this.line=n,this.config=o,this.decode(e)}return Object(c.a)(t,[{key:"width",get:function(){return this.line.width}},{key:"height",get:function(){var t=0;return this.bars.forEach((function(e){t=e.height>t?e.height:t})),t}},{key:"x",get:function(){return 0}},{key:"y",get:function(){return this.line.tracksY[this.index]}},{key:"barsTime",get:function(){return this.bars.map((function(t){return t.notesTimeSum}))}},{key:"barsWidth",get:function(){var t=this,e=this.barsTime.reduce((function(t,e){return t.plus(e)}),new m),i=this.width-this.notesWidthSum,n=(new m).init(i,1).divide(e);return this.barsNotesWidth.map((function(e,i){return e+t.barsTime[i].multiply(n).toNumber()}))}},{key:"barsX",get:function(){var t=0;return this.barsWidth.map((function(e){var i=t;return t+=e,i}))}},{key:"notesMaxHeight",get:function(){return Math.max.apply(Math,Object(g.a)(this.bars.map((function(t){return t.preNotesMaxHeight}))))}},{key:"notesMaxMarginBottom",get:function(){return Math.max.apply(Math,Object(g.a)(this.bars.map((function(t){return t.preNotesMaxMarginBottom}))))}},{key:"notesWidthSum",get:function(){return this.barsNotesWidth.reduce((function(t,e){return t+e}),0)}},{key:"barsNotesWidth",get:function(){return this.bars.map((function(t){return t.notesWidthSum}))}}]),Object(c.a)(t,[{key:"setSelect",value:function(t){this.isSelect=t}},{key:"getThis",value:function(){return this}},{key:"decode",value:function(t){var e=this;void 0!==t.bars&&t.bars.forEach((function(t,i){e.bars.push(new dt(t,i,e,e.config))}))}},{key:"code",value:function(){return{bars:this.bars.map((function(t){return t.code()}))}}}]),t}(),R=Object(f.a)(X.prototype,"bars",[O.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),J=Object(f.a)(X.prototype,"isSelect",[O.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Object(f.a)(X.prototype,"width",[O.f],Object.getOwnPropertyDescriptor(X.prototype,"width"),X.prototype),Object(f.a)(X.prototype,"height",[O.f],Object.getOwnPropertyDescriptor(X.prototype,"height"),X.prototype),Object(f.a)(X.prototype,"x",[O.f],Object.getOwnPropertyDescriptor(X.prototype,"x"),X.prototype),Object(f.a)(X.prototype,"y",[O.f],Object.getOwnPropertyDescriptor(X.prototype,"y"),X.prototype),Object(f.a)(X.prototype,"barsTime",[O.f],Object.getOwnPropertyDescriptor(X.prototype,"barsTime"),X.prototype),Object(f.a)(X.prototype,"barsWidth",[O.f],Object.getOwnPropertyDescriptor(X.prototype,"barsWidth"),X.prototype),Object(f.a)(X.prototype,"barsX",[O.f],Object.getOwnPropertyDescriptor(X.prototype,"barsX"),X.prototype),Object(f.a)(X.prototype,"notesMaxHeight",[O.f],Object.getOwnPropertyDescriptor(X.prototype,"notesMaxHeight"),X.prototype),Object(f.a)(X.prototype,"notesMaxMarginBottom",[O.f],Object.getOwnPropertyDescriptor(X.prototype,"notesMaxMarginBottom"),X.prototype),Object(f.a)(X.prototype,"notesWidthSum",[O.f],Object.getOwnPropertyDescriptor(X.prototype,"notesWidthSum"),X.prototype),Object(f.a)(X.prototype,"barsNotesWidth",[O.f],Object.getOwnPropertyDescriptor(X.prototype,"barsNotesWidth"),X.prototype),X),vt=Object(j.a)(q=function(t){Object(p.a)(i,t);var e=Object(h.a)(i);function i(){return Object(s.a)(this,i),e.apply(this,arguments)}return Object(c.a)(i,[{key:"render",value:function(){return o.a.createElement("g",{className:"muse-track",transform:"translate("+this.props.track.x+","+this.props.track.y+")",width:this.props.track.width,height:this.props.track.height},o.a.createElement(y,{w:this.props.track.width,h:this.props.track.height,x:0,y:0,clazz:"muse-track",show:this.props.track.isSelect}),this.props.track.bars.map((function(t,e){return o.a.createElement(jt,{key:e,bar:t})})))}}]),i}(o.a.Component))||q,wt=(U=function(){function t(e,i,n,o){Object(s.a)(this,t),this.page=void 0,this.index=void 0,this.config=void 0,Object(l.a)(this,"tracks",$,this),Object(l.a)(this,"isSelect",K,this),this.page=n,this.index=i,this.config=o,this.decode(e)}return Object(c.a)(t,[{key:"width",get:function(){return this.page.width}},{key:"height",get:function(){var t=this,e=0;return this.tracks.forEach((function(i){e+=i.height+t.config.trackGap})),e-=this.config.trackGap}},{key:"x",get:function(){return this.page.x}},{key:"y",get:function(){return this.page.linesY[this.index]}},{key:"tracksY",get:function(){var t=this,e=0;return this.tracks.map((function(i){var n=e;return e+=i.height+t.config.trackGap,n}))}}]),Object(c.a)(t,[{key:"setSelect",value:function(t){this.isSelect=t}},{key:"getThis",value:function(){return this}},{key:"decode",value:function(t){var e=this;void 0!==t.tracks&&t.tracks.forEach((function(t,i){e.tracks.push(new kt(t,i,e,e.config))}))}},{key:"code",value:function(){return{tracks:this.tracks.map((function(t){return t.code()}))}}}]),t}(),$=Object(f.a)(U.prototype,"tracks",[O.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),K=Object(f.a)(U.prototype,"isSelect",[O.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Object(f.a)(U.prototype,"width",[O.f],Object.getOwnPropertyDescriptor(U.prototype,"width"),U.prototype),Object(f.a)(U.prototype,"height",[O.f],Object.getOwnPropertyDescriptor(U.prototype,"height"),U.prototype),Object(f.a)(U.prototype,"x",[O.f],Object.getOwnPropertyDescriptor(U.prototype,"x"),U.prototype),Object(f.a)(U.prototype,"y",[O.f],Object.getOwnPropertyDescriptor(U.prototype,"y"),U.prototype),Object(f.a)(U.prototype,"tracksY",[O.f],Object.getOwnPropertyDescriptor(U.prototype,"tracksY"),U.prototype),U),xt=function(t){var e=t.height,i=t.clazz;return o.a.createElement("g",{className:i+"__line-head"},o.a.createElement("line",{x1:0,y1:0,x2:0,y2:e,strokeWidth:1,stroke:"black"}))},St=Object(j.a)(Q=function(t){Object(p.a)(i,t);var e=Object(h.a)(i);function i(){return Object(s.a)(this,i),e.apply(this,arguments)}return Object(c.a)(i,[{key:"render",value:function(){return o.a.createElement("g",{className:"muse-line",transform:"translate("+this.props.line.x+","+this.props.line.y+")",width:this.props.line.width,height:this.props.line.height},o.a.createElement(y,{w:this.props.line.width,h:this.props.line.height,x:0,y:0,clazz:"muse-line",show:this.props.line.isSelect}),o.a.createElement(xt,{height:this.props.line.height,clazz:"muse-line"}),this.props.line.tracks.map((function(t,e){return o.a.createElement(vt,{key:e,track:t})})))}}]),i}(o.a.Component))||Q,zt=(Z=function(){function t(e,i,n,o){Object(s.a)(this,t),this.notation=void 0,this.config=void 0,this.index=void 0,Object(l.a)(this,"lines",tt,this),Object(l.a)(this,"isSelect",et,this),this.index=i,this.notation=n,this.config=o,this.decode(e)}return Object(c.a)(t,[{key:"width",get:function(){return this.config.pageWidth-2*this.config.pageMarginHorizontal}},{key:"height",get:function(){return this.config.pageWidth*this.config.pageE-2*this.config.pageMarginVertical}},{key:"x",get:function(){return this.config.pageMarginHorizontal}},{key:"y",get:function(){return this.marginTop+this.index*this.height}},{key:"marginTop",get:function(){var t=0;if(0===this.index){t+=this.config.pageMarginVertical;var e=this.config.infoGap;t+=this.config.infoTitleFontSize+e,t+=this.config.infoSubtitleFontSize+e,this.notation.info.author.length>2?t+=this.notation.info.author.length*(this.config.infoFontSize+e):t+=2*(this.config.infoFontSize+e)}else t=this.config.pageMarginVertical;return t}},{key:"marginBottom",get:function(){return this.config.pageMarginVertical}},{key:"marginLeft",get:function(){return this.config.pageMarginHorizontal}},{key:"marginRight",get:function(){return this.config.pageMarginHorizontal}},{key:"linesHeight",get:function(){return this.lines.map((function(t){return t.height}))}},{key:"linesY",get:function(){var t=this.marginTop,e=this.linesHeight.reduce((function(t,e){return t+e}),0),i=(this.height-e)/(this.lines.length-1);return this.linesHeight.map((function(e){var n=t;return t+=e+i,n}))}}]),Object(c.a)(t,[{key:"setSelect",value:function(t){this.isSelect=t}},{key:"getThis",value:function(){return this}},{key:"decode",value:function(t){var e=this;void 0!==t.lines&&t.lines.forEach((function(t,i){e.lines.push(new wt(t,i,e,e.config))}))}},{key:"code",value:function(){return{lines:this.lines.map((function(t){return t.code()}))}}}]),t}(),tt=Object(f.a)(Z.prototype,"lines",[O.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),et=Object(f.a)(Z.prototype,"isSelect",[O.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Object(f.a)(Z.prototype,"width",[O.f],Object.getOwnPropertyDescriptor(Z.prototype,"width"),Z.prototype),Object(f.a)(Z.prototype,"height",[O.f],Object.getOwnPropertyDescriptor(Z.prototype,"height"),Z.prototype),Object(f.a)(Z.prototype,"x",[O.f],Object.getOwnPropertyDescriptor(Z.prototype,"x"),Z.prototype),Object(f.a)(Z.prototype,"y",[O.f],Object.getOwnPropertyDescriptor(Z.prototype,"y"),Z.prototype),Object(f.a)(Z.prototype,"marginTop",[O.f],Object.getOwnPropertyDescriptor(Z.prototype,"marginTop"),Z.prototype),Object(f.a)(Z.prototype,"marginBottom",[O.f],Object.getOwnPropertyDescriptor(Z.prototype,"marginBottom"),Z.prototype),Object(f.a)(Z.prototype,"marginLeft",[O.f],Object.getOwnPropertyDescriptor(Z.prototype,"marginLeft"),Z.prototype),Object(f.a)(Z.prototype,"marginRight",[O.f],Object.getOwnPropertyDescriptor(Z.prototype,"marginRight"),Z.prototype),Object(f.a)(Z.prototype,"linesHeight",[O.f],Object.getOwnPropertyDescriptor(Z.prototype,"linesHeight"),Z.prototype),Object(f.a)(Z.prototype,"linesY",[O.f],Object.getOwnPropertyDescriptor(Z.prototype,"linesY"),Z.prototype),Z),Et=function(t){var e=t.index,i=t.x,n=t.y,r=t.clazz,a=t.config;return o.a.createElement("g",{className:r+"__page-index",transform:"translate("+i+","+n+")"},o.a.createElement("text",{textAnchor:"middle",fontFamily:a.textFontFamily,fontSize:a.pageIndexFontSize},(e+1).toString()))},Nt=Object(j.a)(it=function(t){Object(p.a)(i,t);var e=Object(h.a)(i);function i(){return Object(s.a)(this,i),e.apply(this,arguments)}return Object(c.a)(i,[{key:"render",value:function(){var t="muse-page";return o.a.createElement("g",{className:t,transform:"translate("+(this.props.page.x-this.props.page.marginLeft)+","+(this.props.page.y-this.props.page.marginTop)+")",width:this.props.page.width+this.props.page.marginLeft+this.props.page.marginRight,height:this.props.page.height+this.props.page.marginTop+this.props.page.marginBottom},o.a.createElement(y,{w:this.props.page.width,h:this.props.page.height,x:this.props.page.x,y:this.props.page.y,clazz:t,show:this.props.page.isSelect}),o.a.createElement(d,{w:this.props.page.width+this.props.page.marginLeft+this.props.page.marginLeft,h:this.props.page.height+this.props.page.marginTop+this.props.page.marginBottom,clazz:t,show:!0}),o.a.createElement(Et,{index:this.props.page.index,x:this.props.page.marginLeft+this.props.page.width/2,y:this.props.page.marginTop+this.props.page.height+this.props.page.marginBottom/2,clazz:t,config:this.props.page.config}),this.props.page.lines.map((function(t,e){return o.a.createElement(St,{key:e,line:t})})))}}]),i}(o.a.Component))||it,Pt=(nt=function t(){Object(s.a)(this,t),Object(l.a)(this,"title",ot,this),Object(l.a)(this,"subtitle",rt,this),Object(l.a)(this,"author",at,this),Object(l.a)(this,"speed",st,this),Object(l.a)(this,"rhythmic",ct,this),Object(l.a)(this,"C",pt,this)},ot=Object(f.a)(nt.prototype,"title",[O.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),rt=Object(f.a)(nt.prototype,"subtitle",[O.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),at=Object(f.a)(nt.prototype,"author",[O.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),st=Object(f.a)(nt.prototype,"speed",[O.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),ct=Object(f.a)(nt.prototype,"rhythmic",[O.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),pt=Object(f.a)(nt.prototype,"C",[O.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),nt),Mt=(ht=function(){function t(e,i){Object(s.a)(this,t),this.config=void 0,Object(l.a)(this,"pages",ut,this),Object(l.a)(this,"info",lt,this),this.config=i,this.decode(e)}return Object(c.a)(t,[{key:"height",get:function(){var t=0;return this.pages.forEach((function(e){return t+=e.height+e.marginTop+e.marginBottom})),t}},{key:"width",get:function(){return this.config.pageWidth}}]),Object(c.a)(t,[{key:"decode",value:function(t){var e=this;void 0!==t.pages&&t.pages.forEach((function(t,i){e.pages.push(new zt(t,i,e,e.config))})),void 0!==t.title&&(this.info.title=t.title),void 0!==t.subtitle&&(this.info.subtitle=t.subtitle),void 0!==t.author&&(this.info.author=t.author.toString().split("|")),void 0!==t.speed&&(this.info.speed=t.speed),t.rhythmic&&(this.info.rhythmic=t.rhythmic),t.C&&(this.info.C=t.C)}},{key:"code",value:function(){var t=this,e=this.pages.map((function(t){return t.code()})),i="";return this.info.author.forEach((function(e,n){n===t.info.author.length-1?i+=e:i+=e+"|"})),{title:this.info.title,subtitle:this.info.subtitle,author:i,rhythmic:this.info.rhythmic,speed:this.info.speed,C:this.info.C,pages:e}}}]),t}(),ut=Object(f.a)(ht.prototype,"pages",[O.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),lt=Object(f.a)(ht.prototype,"info",[O.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Pt}}),Object(f.a)(ht.prototype,"height",[O.f],Object.getOwnPropertyDescriptor(ht.prototype,"height"),ht.prototype),Object(f.a)(ht.prototype,"width",[O.f],Object.getOwnPropertyDescriptor(ht.prototype,"width"),ht.prototype),ht),Tt=function(t){var e=t.info,i=t.config,n=t.clazz,r=0;r+=i.pageMarginVertical;var a=o.a.createElement("text",{className:n+"__info-title",fontFamily:i.textFontFamily,width:i.pageWidth,textAnchor:"middle",fontSize:i.infoTitleFontSize,transform:"translate("+i.pageWidth/2+","+r+")"},e.title);r+=i.infoTitleFontSize+i.infoGap;var s=o.a.createElement("text",{className:n+"__info-subtitle",fontFamily:i.textFontFamily,width:i.pageWidth,textAnchor:"middle",fontSize:i.infoSubtitleFontSize,transform:"translate("+i.pageWidth/2+","+r+")"},e.subtitle),c=r,p=e.author.length,h=o.a.createElement("g",{className:n+"__info-author"},e.author.map((function(t,e){return c+=i.infoFontSize+i.infoGap,e<p-2&&(r+=i.infoFontSize+i.infoGap),o.a.createElement("text",{key:e,fontFamily:i.textFontFamily,width:i.pageWidth,fontSize:i.infoFontSize,textAnchor:"end",x:0,transform:"translate("+(i.pageWidth-i.pageMarginHorizontal)+","+c+")"},t)}))),u=r+(i.infoGap+i.infoSubtitleFontSize),l=u+(i.infoGap+i.infoFontSize),f=o.a.createElement("g",{className:n+"__info-rythmic",width:i.pageWidth},o.a.createElement("text",{fontFamily:i.textFontFamily,width:i.pageWidth,fontSize:i.infoFontSize,transform:"translate("+i.pageMarginHorizontal+","+u+")"},e.speed),o.a.createElement("text",{fontFamily:i.textFontFamily,width:i.pageWidth,fontSize:i.infoFontSize,transform:"translate("+i.pageMarginHorizontal+","+l+")"},"1=".concat(e.C," ").concat(e.rhythmic)));return o.a.createElement("g",{className:n+"__info",width:i.pageWidth},a,s,h,f)},Dt=Object(j.a)(ft=function(t){Object(p.a)(i,t);var e=Object(h.a)(i);function i(){return Object(s.a)(this,i),e.apply(this,arguments)}return Object(c.a)(i,[{key:"render",value:function(){var t="muse-notation";return o.a.createElement("svg",{className:"muse",width:this.props.notation.width+20,height:this.props.notation.height+20},o.a.createElement("g",{className:t,transform:"translate(10,10)",width:this.props.notation.width,height:this.props.notation.height},o.a.createElement(Tt,{info:this.props.notation.info,config:this.props.notation.config,clazz:t}),o.a.createElement(y,{w:this.props.notation.width,h:this.props.notation.height,x:0,y:0,clazz:t}),this.props.notation.pages.map((function(t,e){return o.a.createElement(Nt,{key:e,page:t})}))))}}]),i}(o.a.Component))||ft;var Ft=function(t){var e=JSON.parse(t.data),i=new Mt(e,t.config?t.config:new u);return o.a.createElement("div",null,o.a.createElement(Dt,{notation:i}),o.a.createElement("button",{onClick:function(){console.log(i.code())}},"log"))},Wt=function(t){Object(p.a)(i,t);var e=Object(h.a)(i);function i(t){var n;return Object(s.a)(this,i),(n=e.call(this,t)).state={error:null,isLoaded:!1,data:""},n}return Object(c.a)(i,[{key:"componentDidMount",value:function(){var t=this;fetch("https://cdn.jsdelivr.net/gh/shizuku/muse-react/test/data/b.json").then((function(t){return t.text()})).then((function(e){t.setState({isLoaded:!0,data:e})}),(function(e){t.setState({isLoaded:!0,error:e})}))}},{key:"render",value:function(){return o.a.createElement("div",{className:"app"},o.a.createElement("h1",null,"Example"),this.state.isLoaded?this.state.error?"error":o.a.createElement(Ft,{data:this.state.data}):"loading...")}}]),i}(o.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(Wt,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()})).catch((function(t){console.error(t.message)}))}},[[21,1,2]]]);
//# sourceMappingURL=main.7d66b080.chunk.js.map